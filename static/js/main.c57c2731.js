/*! For license information please see main.c57c2731.js.LICENSE.txt */
(()=>{"use strict";var e={730:(e,t,n)=>{var r=n(43),i=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,r,i,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function _(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),I=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),k=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var M,F=Object.assign;function U(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var V=!1;function q(e,t){if(!e||V)return"";V=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&"string"===typeof u.stack){for(var i=u.stack.split("\n"),s=r.stack.split("\n"),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||i[o]!==s[a]){var l="\n"+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{V=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?U(e):""}function z(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=q(e.type,!1);case 11:return e=q(e.type.render,!1);case 1:return e=q(e.type,!0);default:return""}}function j(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case E:return"Fragment";case I:return"Portal";case T:return"Profiler";case S:return"StrictMode";case N:return"Suspense";case P:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case k:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case x:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:j(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return j(e(t))}catch(n){}}return null}function B(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return j(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function $(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function H(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=W(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function G(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(ql){return e.body}}function Q(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=$(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&_(e,"checked",t,!1)}function X(e,t){J(e,t);var n=$(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,$(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&G(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+$(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:$(n)}}function se(e,t){var n=$(t.value),r=$(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ue,ce,he=(ce=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ue=ue||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ce(e,t)}))}:ce);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ye=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function _e(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function be(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ie=null,Ee=null,Se=null;function Te(e){if(e=_i(e)){if("function"!==typeof Ie)throw Error(s(280));var t=e.stateNode;t&&(t=bi(t),Ie(e.stateNode,e.type,t))}}function Ce(e){Ee?Se?Se.push(e):Se=[e]:Ee=e}function ke(){if(Ee){var e=Ee,t=Se;if(Se=Ee=null,Te(e),t)for(e=0;e<t.length;e++)Te(t[e])}}function xe(e,t){return e(t)}function Ne(){}var Pe=!1;function Ae(e,t,n){if(Pe)return e(t,n);Pe=!0;try{return xe(e,t,n)}finally{Pe=!1,(null!==Ee||null!==Se)&&(Ne(),ke())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var r=bi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var De=!1;if(c)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){De=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(ce){De=!1}function Le(e,t,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(c){this.onError(c)}}var Me=!1,Fe=null,Ue=!1,Ve=null,qe={onError:function(e){Me=!0,Fe=e}};function ze(e,t,n,r,i,s,o,a,l){Me=!1,Fe=null,Le.apply(qe,arguments)}function je(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Be(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function $e(e){if(je(e)!==e)throw Error(s(188))}function We(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=je(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return $e(i),e;if(o===r)return $e(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=o;break}if(l===r){a=!0,r=i,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,r=i;break}if(l===r){a=!0,r=o,n=i;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e),null!==e?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var He=i.unstable_scheduleCallback,Ge=i.unstable_cancelCallback,Qe=i.unstable_shouldYield,Ye=i.unstable_requestPaint,Je=i.unstable_now,Xe=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ut=64,ct=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~i;0!==a?r=ht(a):0!==(s&=o)&&(r=ht(s))}else 0!==(o=n&~i)?r=ht(o):0!==s&&(r=ht(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-ot(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ut;return 0===(4194240&(ut<<=1))&&(ut=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var _t=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var bt,It,Et,St,Tt,Ct=!1,kt=[],xt=null,Nt=null,Pt=null,At=new Map,Rt=new Map,Dt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":xt=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Mt(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=_i(t))&&It(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ft(e){var t=vi(e.target);if(null!==t){var n=je(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Be(n)))return e.blockedOn=t,void Tt(e.priority,(function(){Et(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=_i(n))&&It(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function Vt(e,t,n){Ut(e)&&n.delete(t)}function qt(){Ct=!1,null!==xt&&Ut(xt)&&(xt=null),null!==Nt&&Ut(Nt)&&(Nt=null),null!==Pt&&Ut(Pt)&&(Pt=null),At.forEach(Vt),Rt.forEach(Vt)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,qt)))}function jt(e){function t(t){return zt(t,e)}if(0<kt.length){zt(kt[0],e);for(var n=1;n<kt.length;n++){var r=kt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==xt&&zt(xt,e),null!==Nt&&zt(Nt,e),null!==Pt&&zt(Pt,e),At.forEach(t),Rt.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Dt.shift()}var Bt=w.ReactCurrentBatchConfig,$t=!0;function Wt(e,t,n,r){var i=_t,s=Bt.transition;Bt.transition=null;try{_t=1,Ht(e,t,n,r)}finally{_t=i,Bt.transition=s}}function Kt(e,t,n,r){var i=_t,s=Bt.transition;Bt.transition=null;try{_t=4,Ht(e,t,n,r)}finally{_t=i,Bt.transition=s}}function Ht(e,t,n,r){if($t){var i=Qt(e,t,n,r);if(null===i)$r(e,t,r,Gt,n),Lt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return xt=Mt(xt,e,t,n,r,i),!0;case"dragenter":return Nt=Mt(Nt,e,t,n,r,i),!0;case"mouseover":return Pt=Mt(Pt,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return At.set(s,Mt(At.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Rt.set(s,Mt(Rt.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Lt(e,r),4&t&&-1<Ot.indexOf(e)){for(;null!==i;){var s=_i(i);if(null!==s&&bt(s),null===(s=Qt(e,t,n,r))&&$r(e,t,r,Gt,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else $r(e,t,r,null,n)}}var Gt=null;function Qt(e,t,n,r){if(Gt=null,null!==(e=vi(e=be(r))))if(null===(t=je(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Be(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,r=n.length,i="value"in Jt?Jt.value:Jt.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[s-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,i,s){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,an,ln,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=sn(un),hn=F({},un,{view:0,detail:0}),dn=sn(hn),fn=F({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:an}}),pn=sn(fn),mn=sn(F({},fn,{dataTransfer:0})),gn=sn(F({},hn,{relatedTarget:0})),yn=sn(F({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=F({},un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),_n=sn(vn),wn=sn(F({},un,{data:0})),bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},In={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},En={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=En[e])&&!!t[e]}function Tn(){return Sn}var Cn=F({},hn,{key:function(e){if(e.key){var t=bn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?In[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),kn=sn(Cn),xn=sn(F({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=sn(F({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tn})),Pn=sn(F({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=F({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=sn(An),Dn=[9,13,27,32],On=c&&"CompositionEvent"in window,Ln=null;c&&"documentMode"in document&&(Ln=document.documentMode);var Mn=c&&"TextEvent"in window&&!Ln,Fn=c&&(!On||Ln&&8<Ln&&11>=Ln),Un=String.fromCharCode(32),Vn=!1;function qn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var jn=!1;var Bn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $n(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Bn[e.type]:"textarea"===t}function Wn(e,t,n,r){Ce(r),0<(t=Kr(t,"onChange")).length&&(n=new cn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Kn=null,Hn=null;function Gn(e){Ur(e,0)}function Qn(e){if(H(wi(e)))return e}function Yn(e,t){if("change"===e)return t}var Jn=!1;if(c){var Xn;if(c){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Xn=Zn}else Xn=!1;Jn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){Kn&&(Kn.detachEvent("onpropertychange",nr),Hn=Kn=null)}function nr(e){if("value"===e.propertyName&&Qn(Hn)){var t=[];Wn(t,Hn,e,be(e)),Ae(Gn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Hn=n,(Kn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Hn)}function sr(e,t){if("click"===e)return Qn(t)}function or(e,t){if("input"===e||"change"===e)return Qn(t)}var ar="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(ar(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(t,i)||!ar(e[i],t[i]))return!1}return!0}function ur(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cr(e,t){var n,r=ur(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ur(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=G((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=cr(n,s);var o=cr(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=c&&"documentMode"in document&&11>=document.documentMode,gr=null,yr=null,vr=null,_r=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;_r||null==gr||gr!==G(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&lr(vr,r)||(vr=r,0<(r=Kr(yr,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function br(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ir={animationend:br("Animation","AnimationEnd"),animationiteration:br("Animation","AnimationIteration"),animationstart:br("Animation","AnimationStart"),transitionend:br("Transition","TransitionEnd")},Er={},Sr={};function Tr(e){if(Er[e])return Er[e];if(!Ir[e])return e;var t,n=Ir[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return Er[e]=n[t];return e}c&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete Ir.animationend.animation,delete Ir.animationiteration.animation,delete Ir.animationstart.animation),"TransitionEvent"in window||delete Ir.transitionend.transition);var Cr=Tr("animationend"),kr=Tr("animationiteration"),xr=Tr("animationstart"),Nr=Tr("transitionend"),Pr=new Map,Ar="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rr(e,t){Pr.set(e,t),l(t,[e])}for(var Dr=0;Dr<Ar.length;Dr++){var Or=Ar[Dr];Rr(Or.toLowerCase(),"on"+(Or[0].toUpperCase()+Or.slice(1)))}Rr(Cr,"onAnimationEnd"),Rr(kr,"onAnimationIteration"),Rr(xr,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(Nr,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function Fr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,a,l,u){if(ze.apply(this,arguments),Me){if(!Me)throw Error(s(198));var c=Fe;Me=!1,Fe=null,Ue||(Ue=!0,Ve=c)}}(r,t,void 0,e),e.currentTarget=null}function Ur(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Fr(i,a,u),s=l}else for(o=0;o<r.length;o++){if(l=(a=r[o]).instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Fr(i,a,u),s=l}}}if(Ue)throw e=Ve,Ue=!1,Ve=null,e}function Vr(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||(Br(t,e,2,!1),n.add(r))}function qr(e,t,n){var r=0;t&&(r|=4),Br(n,e,r,t)}var zr="_reactListening"+Math.random().toString(36).slice(2);function jr(e){if(!e[zr]){e[zr]=!0,o.forEach((function(t){"selectionchange"!==t&&(Mr.has(t)||qr(t,!1,e),qr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zr]||(t[zr]=!0,qr("selectionchange",!1,t))}}function Br(e,t,n,r){switch(Yt(t)){case 1:var i=Wt;break;case 4:i=Kt;break;default:i=Ht}n=i.bind(null,t,n,e),i=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function $r(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==a;){if(null===(o=vi(a)))return;if(5===(l=o.tag)||6===l){r=s=o;continue e}a=a.parentNode}}r=r.return}Ae((function(){var r=s,i=be(n),o=[];e:{var a=Pr.get(e);if(void 0!==a){var l=cn,u=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=kn;break;case"focusin":u="focus",l=gn;break;case"focusout":u="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Nn;break;case Cr:case kr:case xr:l=yn;break;case Nr:l=Pn;break;case"scroll":l=dn;break;case"wheel":l=Rn;break;case"copy":case"cut":case"paste":l=_n;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=xn}var c=0!==(4&t),h=!c&&"scroll"===e,d=c?null!==a?a+"Capture":null:a;c=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==d&&(null!=(m=Re(p,d))&&c.push(Wr(p,m,f)))),h)break;p=p.return}0<c.length&&(a=new l(a,u,null,n,i),o.push({event:a,listeners:c}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===we||!(u=n.relatedTarget||n.fromElement)||!vi(u)&&!u[pi])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(u=(u=n.relatedTarget||n.toElement)?vi(u):null)&&(u!==(h=je(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=r),l!==u)){if(c=pn,m="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(c=xn,m="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?a:wi(l),f=null==u?a:wi(u),(a=new c(m,p+"leave",l,n,i)).target=h,a.relatedTarget=f,m=null,vi(i)===r&&((c=new c(d,p+"enter",u,n,i)).target=f,c.relatedTarget=h,m=c),h=m,l&&u)e:{for(d=u,p=0,f=c=l;f;f=Hr(f))p++;for(f=0,m=d;m;m=Hr(m))f++;for(;0<p-f;)c=Hr(c),p--;for(;0<f-p;)d=Hr(d),f--;for(;p--;){if(c===d||null!==d&&c===d.alternate)break e;c=Hr(c),d=Hr(d)}c=null}else c=null;null!==l&&Gr(o,a,l,c,!1),null!==u&&null!==h&&Gr(o,h,u,c,!0)}if("select"===(l=(a=r?wi(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=Yn;else if($n(a))if(Jn)g=or;else{g=ir;var y=rr}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=sr);switch(g&&(g=g(e,r))?Wn(o,g,n,i):(y&&y(e,a,r),"focusout"===e&&(y=a._wrapperState)&&y.controlled&&"number"===a.type&&ee(a,"number",a.value)),y=r?wi(r):window,e){case"focusin":($n(y)||"true"===y.contentEditable)&&(gr=y,yr=r,vr=null);break;case"focusout":vr=yr=gr=null;break;case"mousedown":_r=!0;break;case"contextmenu":case"mouseup":case"dragend":_r=!1,wr(o,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":wr(o,n,i)}var v;if(On)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else jn?qn(e,n)&&(_="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(_="onCompositionStart");_&&(Fn&&"ko"!==n.locale&&(jn||"onCompositionStart"!==_?"onCompositionEnd"===_&&jn&&(v=en()):(Xt="value"in(Jt=i)?Jt.value:Jt.textContent,jn=!0)),0<(y=Kr(r,_)).length&&(_=new wn(_,e,null,n,i),o.push({event:_,listeners:y}),v?_.data=v:null!==(v=zn(n))&&(_.data=v))),(v=Mn?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(Vn=!0,Un);case"textInput":return(e=t.data)===Un&&Vn?null:e;default:return null}}(e,n):function(e,t){if(jn)return"compositionend"===e||!On&&qn(e,t)?(e=en(),Zt=Xt=Jt=null,jn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Kr(r,"onBeforeInput")).length&&(i=new wn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=v))}Ur(o,t)}))}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Kr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5===i.tag&&null!==s&&(i=s,null!=(s=Re(e,n))&&r.unshift(Wr(e,s,i)),null!=(s=Re(e,t))&&r.push(Wr(e,s,i))),e=e.return}return r}function Hr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gr(e,t,n,r,i){for(var s=t._reactName,o=[];null!==n&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(null!==l&&l===r)break;5===a.tag&&null!==u&&(a=u,i?null!=(l=Re(n,s))&&o.unshift(Wr(n,l,a)):i||null!=(l=Re(n,s))&&o.push(Wr(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Qr=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace(Qr,"\n").replace(Yr,"")}function Xr(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(s(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,si="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof si?function(e){return si.resolve(null).then(e).catch(ai)}:ri;function ai(e){setTimeout((function(){throw e}))}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void jt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);jt(t)}function ui(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ci(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),di="__reactFiber$"+hi,fi="__reactProps$"+hi,pi="__reactContainer$"+hi,mi="__reactEvents$"+hi,gi="__reactListeners$"+hi,yi="__reactHandles$"+hi;function vi(e){var t=e[di];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[di]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ci(e);null!==e;){if(n=e[di])return n;e=ci(e)}return t}n=(e=n).parentNode}return null}function _i(e){return!(e=e[di]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function bi(e){return e[fi]||null}var Ii=[],Ei=-1;function Si(e){return{current:e}}function Ti(e){0>Ei||(e.current=Ii[Ei],Ii[Ei]=null,Ei--)}function Ci(e,t){Ei++,Ii[Ei]=e.current,e.current=t}var ki={},xi=Si(ki),Ni=Si(!1),Pi=ki;function Ai(e,t){var n=e.type.contextTypes;if(!n)return ki;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ri(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Di(){Ti(Ni),Ti(xi)}function Oi(e,t,n){if(xi.current!==ki)throw Error(s(168));Ci(xi,t),Ci(Ni,n)}function Li(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,B(e)||"Unknown",i));return F({},n,r)}function Mi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ki,Pi=xi.current,Ci(xi,e),Ci(Ni,Ni.current),!0}function Fi(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Li(e,t,Pi),r.__reactInternalMemoizedMergedChildContext=e,Ti(Ni),Ti(xi),Ci(xi,e)):Ti(Ni),Ci(Ni,n)}var Ui=null,Vi=!1,qi=!1;function zi(e){null===Ui?Ui=[e]:Ui.push(e)}function ji(){if(!qi&&null!==Ui){qi=!0;var e=0,t=_t;try{var n=Ui;for(_t=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ui=null,Vi=!1}catch(i){throw null!==Ui&&(Ui=Ui.slice(e+1)),He(Ze,ji),i}finally{_t=t,qi=!1}}return null}var Bi=[],$i=0,Wi=null,Ki=0,Hi=[],Gi=0,Qi=null,Yi=1,Ji="";function Xi(e,t){Bi[$i++]=Ki,Bi[$i++]=Wi,Wi=e,Ki=t}function Zi(e,t,n){Hi[Gi++]=Yi,Hi[Gi++]=Ji,Hi[Gi++]=Qi,Qi=e;var r=Yi;e=Ji;var i=32-ot(r)-1;r&=~(1<<i),n+=1;var s=32-ot(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Yi=1<<32-ot(t)+i|n<<i|r,Ji=s+e}else Yi=1<<s|n<<i|r,Ji=e}function es(e){null!==e.return&&(Xi(e,1),Zi(e,1,0))}function ts(e){for(;e===Wi;)Wi=Bi[--$i],Bi[$i]=null,Ki=Bi[--$i],Bi[$i]=null;for(;e===Qi;)Qi=Hi[--Gi],Hi[Gi]=null,Ji=Hi[--Gi],Hi[Gi]=null,Yi=Hi[--Gi],Hi[Gi]=null}var ns=null,rs=null,is=!1,ss=null;function os(e,t){var n=Ru(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function as(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,rs=ui(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,rs=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qi?{id:Yi,overflow:Ji}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ru(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,rs=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function us(e){if(is){var t=rs;if(t){var n=t;if(!as(e,t)){if(ls(e))throw Error(s(418));t=ui(n.nextSibling);var r=ns;t&&as(e,t)?os(r,n):(e.flags=-4097&e.flags|2,is=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,is=!1,ns=e}}}function cs(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function hs(e){if(e!==ns)return!1;if(!is)return cs(e),is=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=rs)){if(ls(e))throw ds(),Error(s(418));for(;t;)os(e,t),t=ui(t.nextSibling)}if(cs(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){rs=ui(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}rs=null}}else rs=ns?ui(e.stateNode.nextSibling):null;return!0}function ds(){for(var e=rs;e;)e=ui(e.nextSibling)}function fs(){rs=ns=null,is=!1}function ps(e){null===ss?ss=[e]:ss.push(e)}var ms=w.ReactCurrentBatchConfig;function gs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function ys(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vs(e){return(0,e._init)(e._payload)}function _s(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Ou(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Uu(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function u(e,t,n,r){var s=n.type;return s===E?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===R&&vs(s)===t.type)?((r=i(t,n.props)).ref=gs(e,t,n),r.return=e,r):((r=Lu(n.type,n.key,n.props,null,e.mode,r)).ref=gs(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=qu(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,s){return null===t||7!==t.tag?((t=Mu(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Uu(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case b:return(n=Lu(t.type,t.key,t.props,null,e.mode,n)).ref=gs(e,null,t),n.return=e,n;case I:return(t=qu(t,e.mode,n)).return=e,t;case R:return d(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=Mu(t,e.mode,n,null)).return=e,t;ys(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===i?u(e,t,n,r):null;case I:return n.key===i?c(e,t,n,r):null;case R:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||L(n))return null!==i?null:h(e,t,n,r,null);ys(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case b:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case I:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case R:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||L(r))return h(t,e=e.get(n)||null,r,i,null);ys(t,r)}return null}function m(i,s,a,l){for(var u=null,c=null,h=s,m=s=0,g=null;null!==h&&m<a.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var y=f(i,h,a[m],l);if(null===y){null===h&&(h=g);break}e&&h&&null===y.alternate&&t(i,h),s=o(y,s,m),null===c?u=y:c.sibling=y,c=y,h=g}if(m===a.length)return n(i,h),is&&Xi(i,m),u;if(null===h){for(;m<a.length;m++)null!==(h=d(i,a[m],l))&&(s=o(h,s,m),null===c?u=h:c.sibling=h,c=h);return is&&Xi(i,m),u}for(h=r(i,h);m<a.length;m++)null!==(g=p(h,i,m,a[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),s=o(g,s,m),null===c?u=g:c.sibling=g,c=g);return e&&h.forEach((function(e){return t(i,e)})),is&&Xi(i,m),u}function g(i,a,l,u){var c=L(l);if("function"!==typeof c)throw Error(s(150));if(null==(l=c.call(l)))throw Error(s(151));for(var h=c=null,m=a,g=a=0,y=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var _=f(i,m,v.value,u);if(null===_){null===m&&(m=y);break}e&&m&&null===_.alternate&&t(i,m),a=o(_,a,g),null===h?c=_:h.sibling=_,h=_,m=y}if(v.done)return n(i,m),is&&Xi(i,g),c;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=d(i,v.value,u))&&(a=o(v,a,g),null===h?c=v:h.sibling=v,h=v);return is&&Xi(i,g),c}for(m=r(i,m);!v.done;g++,v=l.next())null!==(v=p(m,i,g,v.value,u))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),a=o(v,a,g),null===h?c=v:h.sibling=v,h=v);return e&&m.forEach((function(e){return t(i,e)})),is&&Xi(i,g),c}return function e(r,s,o,l){if("object"===typeof o&&null!==o&&o.type===E&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case b:e:{for(var u=o.key,c=s;null!==c;){if(c.key===u){if((u=o.type)===E){if(7===c.tag){n(r,c.sibling),(s=i(c,o.props.children)).return=r,r=s;break e}}else if(c.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===R&&vs(u)===c.type){n(r,c.sibling),(s=i(c,o.props)).ref=gs(r,c,o),s.return=r,r=s;break e}n(r,c);break}t(r,c),c=c.sibling}o.type===E?((s=Mu(o.props.children,r.mode,l,o.key)).return=r,r=s):((l=Lu(o.type,o.key,o.props,null,r.mode,l)).ref=gs(r,s,o),l.return=r,r=l)}return a(r);case I:e:{for(c=o.key;null!==s;){if(s.key===c){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(r,s.sibling),(s=i(s,o.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=qu(o,r.mode,l)).return=r,r=s}return a(r);case R:return e(r,s,(c=o._init)(o._payload),l)}if(te(o))return m(r,s,o,l);if(L(o))return g(r,s,o,l);ys(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,o)).return=r,r=s):(n(r,s),(s=Uu(o,r.mode,l)).return=r,r=s),a(r)):n(r,s)}}var ws=_s(!0),bs=_s(!1),Is=Si(null),Es=null,Ss=null,Ts=null;function Cs(){Ts=Ss=Es=null}function ks(e){var t=Is.current;Ti(Is),e._currentValue=t}function xs(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ns(e,t){Es=e,Ts=Ss=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(_a=!0),e.firstContext=null)}function Ps(e){var t=e._currentValue;if(Ts!==e)if(e={context:e,memoizedValue:t,next:null},null===Ss){if(null===Es)throw Error(s(308));Ss=e,Es.dependencies={lanes:0,firstContext:e}}else Ss=Ss.next=e;return t}var As=null;function Rs(e){null===As?As=[e]:As.push(e)}function Ds(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Rs(t)):(n.next=i.next,i.next=n),t.interleaved=n,Os(e,r)}function Os(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ls=!1;function Ms(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Us(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Vs(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&xl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Os(e,n)}return null===(i=r.interleaved)?(t.next=t,Rs(r)):(t.next=i.next,i.next=t),r.interleaved=t,Os(e,n)}function qs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function zs(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function js(e,t,n,r){var i=e.updateQueue;Ls=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,u=l.next;l.next=null,null===o?s=u:o.next=u,o=l;var c=e.alternate;null!==c&&((a=(c=c.updateQueue).lastBaseUpdate)!==o&&(null===a?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(null!==s){var h=i.baseState;for(o=0,c=u=l=null,a=s;;){var d=a.lane,f=a.eventTime;if((r&d)===d){null!==c&&(c=c.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,m=a;switch(d=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=m.payload)?p.call(f,h,d):p)||void 0===d)break e;h=F({},h,d);break e;case 2:Ls=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(d=i.effects)?i.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===c?(u=c=f,l=h):c=c.next=f,o|=d;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(d=a).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===c&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);Ml|=o,e.lanes=o,e.memoizedState=h}}function Bs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var $s={},Ws=Si($s),Ks=Si($s),Hs=Si($s);function Gs(e){if(e===$s)throw Error(s(174));return e}function Qs(e,t){switch(Ci(Hs,t),Ci(Ks,e),Ci(Ws,$s),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ti(Ws),Ci(Ws,t)}function Ys(){Ti(Ws),Ti(Ks),Ti(Hs)}function Js(e){Gs(Hs.current);var t=Gs(Ws.current),n=le(t,e.type);t!==n&&(Ci(Ks,e),Ci(Ws,n))}function Xs(e){Ks.current===e&&(Ti(Ws),Ti(Ks))}var Zs=Si(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function no(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var ro=w.ReactCurrentDispatcher,io=w.ReactCurrentBatchConfig,so=0,oo=null,ao=null,lo=null,uo=!1,co=!1,ho=0,fo=0;function po(){throw Error(s(321))}function mo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ar(e[n],t[n]))return!1;return!0}function go(e,t,n,r,i,o){if(so=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ro.current=null===e||null===e.memoizedState?Zo:ea,e=n(r,i),co){o=0;do{if(co=!1,ho=0,25<=o)throw Error(s(301));o+=1,lo=ao=null,t.updateQueue=null,ro.current=ta,e=n(r,i)}while(co)}if(ro.current=Xo,t=null!==ao&&null!==ao.next,so=0,lo=ao=oo=null,uo=!1,t)throw Error(s(300));return e}function yo(){var e=0!==ho;return ho=0,e}function vo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=e:lo=lo.next=e,lo}function _o(){if(null===ao){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=ao.next;var t=null===lo?oo.memoizedState:lo.next;if(null!==t)lo=t,ao=e;else{if(null===e)throw Error(s(310));e={memoizedState:(ao=e).memoizedState,baseState:ao.baseState,baseQueue:ao.baseQueue,queue:ao.queue,next:null},null===lo?oo.memoizedState=lo=e:lo=lo.next=e}return lo}function wo(e,t){return"function"===typeof t?t(e):t}function bo(e){var t=_o(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=ao,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var l=a=null,u=null,c=o;do{var h=c.lane;if((so&h)===h)null!==u&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var d={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===u?(l=u=d,a=r):u=u.next=d,oo.lanes|=h,Ml|=h}c=c.next}while(null!==c&&c!==o);null===u?a=r:u.next=l,ar(r,t.memoizedState)||(_a=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=u,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,oo.lanes|=o,Ml|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Io(e){var t=_o(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);ar(o,t.memoizedState)||(_a=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Eo(){}function So(e,t){var n=oo,r=_o(),i=t(),o=!ar(r.memoizedState,i);if(o&&(r.memoizedState=i,_a=!0),r=r.queue,Mo(ko.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==lo&&1&lo.memoizedState.tag){if(n.flags|=2048,Ao(9,Co.bind(null,n,r,i,t),void 0,null),null===Nl)throw Error(s(349));0!==(30&so)||To(n,t,i)}return i}function To(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Co(e,t,n,r){t.value=n,t.getSnapshot=r,xo(t)&&No(e)}function ko(e,t,n){return n((function(){xo(t)&&No(e)}))}function xo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ar(e,n)}catch(r){return!0}}function No(e){var t=Os(e,1);null!==t&&ru(t,e,1,-1)}function Po(e){var t=vo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wo,lastRenderedState:e},t.queue=e,e=e.dispatch=Go.bind(null,oo,e),[t.memoizedState,e]}function Ao(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ro(){return _o().memoizedState}function Do(e,t,n,r){var i=vo();oo.flags|=e,i.memoizedState=Ao(1|t,n,void 0,void 0===r?null:r)}function Oo(e,t,n,r){var i=_o();r=void 0===r?null:r;var s=void 0;if(null!==ao){var o=ao.memoizedState;if(s=o.destroy,null!==r&&mo(r,o.deps))return void(i.memoizedState=Ao(t,n,s,r))}oo.flags|=e,i.memoizedState=Ao(1|t,n,s,r)}function Lo(e,t){return Do(8390656,8,e,t)}function Mo(e,t){return Oo(2048,8,e,t)}function Fo(e,t){return Oo(4,2,e,t)}function Uo(e,t){return Oo(4,4,e,t)}function Vo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function qo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Oo(4,4,Vo.bind(null,t,e),n)}function zo(){}function jo(e,t){var n=_o();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&mo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Bo(e,t){var n=_o();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&mo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function $o(e,t,n){return 0===(21&so)?(e.baseState&&(e.baseState=!1,_a=!0),e.memoizedState=n):(ar(n,t)||(n=mt(),oo.lanes|=n,Ml|=n,e.baseState=!0),t)}function Wo(e,t){var n=_t;_t=0!==n&&4>n?n:4,e(!0);var r=io.transition;io.transition={};try{e(!1),t()}finally{_t=n,io.transition=r}}function Ko(){return _o().memoizedState}function Ho(e,t,n){var r=nu(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qo(e))Yo(t,n);else if(null!==(n=Ds(e,t,n,r))){ru(n,e,r,tu()),Jo(n,t,r)}}function Go(e,t,n){var r=nu(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qo(e))Yo(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,ar(a,o)){var l=t.interleaved;return null===l?(i.next=i,Rs(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(u){}null!==(n=Ds(e,t,i,r))&&(ru(n,e,r,i=tu()),Jo(n,t,r))}}function Qo(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function Yo(e,t){co=uo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Jo(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Xo={readContext:Ps,useCallback:po,useContext:po,useEffect:po,useImperativeHandle:po,useInsertionEffect:po,useLayoutEffect:po,useMemo:po,useReducer:po,useRef:po,useState:po,useDebugValue:po,useDeferredValue:po,useTransition:po,useMutableSource:po,useSyncExternalStore:po,useId:po,unstable_isNewReconciler:!1},Zo={readContext:Ps,useCallback:function(e,t){return vo().memoizedState=[e,void 0===t?null:t],e},useContext:Ps,useEffect:Lo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Do(4194308,4,Vo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Do(4194308,4,e,t)},useInsertionEffect:function(e,t){return Do(4,2,e,t)},useMemo:function(e,t){var n=vo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=vo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ho.bind(null,oo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},vo().memoizedState=e},useState:Po,useDebugValue:zo,useDeferredValue:function(e){return vo().memoizedState=e},useTransition:function(){var e=Po(!1),t=e[0];return e=Wo.bind(null,e[1]),vo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=oo,i=vo();if(is){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Nl)throw Error(s(349));0!==(30&so)||To(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Lo(ko.bind(null,r,o,e),[e]),r.flags|=2048,Ao(9,Co.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=vo(),t=Nl.identifierPrefix;if(is){var n=Ji;t=":"+t+"R"+(n=(Yi&~(1<<32-ot(Yi)-1)).toString(32)+n),0<(n=ho++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=fo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ea={readContext:Ps,useCallback:jo,useContext:Ps,useEffect:Mo,useImperativeHandle:qo,useInsertionEffect:Fo,useLayoutEffect:Uo,useMemo:Bo,useReducer:bo,useRef:Ro,useState:function(){return bo(wo)},useDebugValue:zo,useDeferredValue:function(e){return $o(_o(),ao.memoizedState,e)},useTransition:function(){return[bo(wo)[0],_o().memoizedState]},useMutableSource:Eo,useSyncExternalStore:So,useId:Ko,unstable_isNewReconciler:!1},ta={readContext:Ps,useCallback:jo,useContext:Ps,useEffect:Mo,useImperativeHandle:qo,useInsertionEffect:Fo,useLayoutEffect:Uo,useMemo:Bo,useReducer:Io,useRef:Ro,useState:function(){return Io(wo)},useDebugValue:zo,useDeferredValue:function(e){var t=_o();return null===ao?t.memoizedState=e:$o(t,ao.memoizedState,e)},useTransition:function(){return[Io(wo)[0],_o().memoizedState]},useMutableSource:Eo,useSyncExternalStore:So,useId:Ko,unstable_isNewReconciler:!1};function na(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ra(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ia={isMounted:function(e){return!!(e=e._reactInternals)&&je(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tu(),i=nu(e),s=Us(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Vs(e,s,i))&&(ru(t,e,i,r),qs(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tu(),i=nu(e),s=Us(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Vs(e,s,i))&&(ru(t,e,i,r),qs(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tu(),r=nu(e),i=Us(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Vs(e,i,r))&&(ru(t,e,r,n),qs(t,e,r))}};function sa(e,t,n,r,i,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,s))}function oa(e,t,n){var r=!1,i=ki,s=t.contextType;return"object"===typeof s&&null!==s?s=Ps(s):(i=Ri(t)?Pi:xi.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ai(e,i):ki),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ia,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function aa(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ia.enqueueReplaceState(t,t.state,null)}function la(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Ms(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=Ps(s):(s=Ri(t)?Pi:xi.current,i.context=Ai(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ra(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&ia.enqueueReplaceState(i,i.state,null),js(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function ua(e,t){try{var n="",r=t;do{n+=z(r),r=r.return}while(r);var i=n}catch(s){i="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:i,digest:null}}function ca(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ha(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var da="function"===typeof WeakMap?WeakMap:Map;function fa(e,t,n){(n=Us(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wl||(Wl=!0,Kl=r),ha(0,t)},n}function pa(e,t,n){(n=Us(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ha(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){ha(0,t),"function"!==typeof r&&(null===Hl?Hl=new Set([this]):Hl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ma(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new da;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Cu.bind(null,e,t,n),t.then(e,e))}function ga(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ya(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Us(-1,1)).tag=2,Vs(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var va=w.ReactCurrentOwner,_a=!1;function wa(e,t,n,r){t.child=null===e?bs(t,null,n,r):ws(t,e.child,n,r)}function ba(e,t,n,r,i){n=n.render;var s=t.ref;return Ns(t,i),r=go(e,t,n,r,s,i),n=yo(),null===e||_a?(is&&n&&es(t),t.flags|=1,wa(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,$a(e,t,i))}function Ia(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Du(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Lu(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ea(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(o,r)&&e.ref===t.ref)return $a(e,t,i)}return t.flags|=1,(e=Ou(s,r)).ref=t.ref,e.return=t,t.child=e}function Ea(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(lr(s,r)&&e.ref===t.ref){if(_a=!1,t.pendingProps=r=s,0===(e.lanes&i))return t.lanes=e.lanes,$a(e,t,i);0!==(131072&e.flags)&&(_a=!0)}}return Ca(e,t,n,r,i)}function Sa(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ci(Dl,Rl),Rl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ci(Dl,Rl),Rl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,Ci(Dl,Rl),Rl|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,Ci(Dl,Rl),Rl|=r;return wa(e,t,i,n),t.child}function Ta(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ca(e,t,n,r,i){var s=Ri(n)?Pi:xi.current;return s=Ai(t,s),Ns(t,i),n=go(e,t,n,r,s,i),r=yo(),null===e||_a?(is&&r&&es(t),t.flags|=1,wa(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,$a(e,t,i))}function ka(e,t,n,r,i){if(Ri(n)){var s=!0;Mi(t)}else s=!1;if(Ns(t,i),null===t.stateNode)Ba(e,t),oa(t,n,r),la(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,u=n.contextType;"object"===typeof u&&null!==u?u=Ps(u):u=Ai(t,u=Ri(n)?Pi:xi.current);var c=n.getDerivedStateFromProps,h="function"===typeof c||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==r||l!==u)&&aa(t,o,r,u),Ls=!1;var d=t.memoizedState;o.state=d,js(t,r,o,i),l=t.memoizedState,a!==r||d!==l||Ni.current||Ls?("function"===typeof c&&(ra(t,n,c,r),l=t.memoizedState),(a=Ls||sa(t,n,a,r,d,l,u))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Fs(e,t),a=t.memoizedProps,u=t.type===t.elementType?a:na(t.type,a),o.props=u,h=t.pendingProps,d=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ps(l):l=Ai(t,l=Ri(n)?Pi:xi.current);var f=n.getDerivedStateFromProps;(c="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==h||d!==l)&&aa(t,o,r,l),Ls=!1,d=t.memoizedState,o.state=d,js(t,r,o,i);var p=t.memoizedState;a!==h||d!==p||Ni.current||Ls?("function"===typeof f&&(ra(t,n,f,r),p=t.memoizedState),(u=Ls||sa(t,n,u,r,d,p,l)||!1)?(c||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=l,r=u):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return xa(e,t,n,r,s,i)}function xa(e,t,n,r,i,s){Ta(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Fi(t,n,!1),$a(e,t,s);r=t.stateNode,va.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=ws(t,e.child,null,s),t.child=ws(t,null,a,s)):wa(e,t,a,s),t.memoizedState=r.state,i&&Fi(t,n,!0),t.child}function Na(e){var t=e.stateNode;t.pendingContext?Oi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Oi(0,t.context,!1),Qs(e,t.containerInfo)}function Pa(e,t,n,r,i){return fs(),ps(i),t.flags|=256,wa(e,t,n,r),t.child}var Aa,Ra,Da,Oa,La={dehydrated:null,treeContext:null,retryLane:0};function Ma(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fa(e,t,n){var r,i=t.pendingProps,o=Zs.current,a=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ci(Zs,1&o),null===e)return us(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,a?(i=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Fu(l,i,0,null),e=Mu(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Ma(n),t.memoizedState=La,e):Ua(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,a){if(n)return 256&t.flags?(t.flags&=-257,Va(e,t,a,r=ca(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=Fu({mode:"visible",children:r.children},i,0,null),(o=Mu(o,i,a,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&ws(t,e.child,null,a),t.child.memoizedState=Ma(a),t.memoizedState=La,o);if(0===(1&t.mode))return Va(e,t,a,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Va(e,t,a,r=ca(o=Error(s(419)),r,void 0))}if(l=0!==(a&e.childLanes),_a||l){if(null!==(r=Nl)){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|a))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Os(e,i),ru(r,e,i,-1))}return gu(),Va(e,t,a,r=ca(Error(s(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=xu.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,rs=ui(i.nextSibling),ns=t,is=!0,ss=null,null!==e&&(Hi[Gi++]=Yi,Hi[Gi++]=Ji,Hi[Gi++]=Qi,Yi=e.id,Ji=e.overflow,Qi=t),t=Ua(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,o,n);if(a){a=i.fallback,l=t.mode,r=(o=e.child).sibling;var u={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=u,t.deletions=null):(i=Ou(o,u)).subtreeFlags=14680064&o.subtreeFlags,null!==r?a=Ou(r,a):(a=Mu(a,l,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,l=null===(l=e.child.memoizedState)?Ma(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=La,i}return e=(a=e.child).sibling,i=Ou(a,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Ua(e,t){return(t=Fu({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Va(e,t,n,r){return null!==r&&ps(r),ws(t,e.child,null,n),(e=Ua(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function qa(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),xs(e.return,t,n)}function za(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function ja(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(wa(e,t,r.children,n),0!==(2&(r=Zs.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&qa(e,n,t);else if(19===e.tag)qa(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ci(Zs,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===eo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),za(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===eo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}za(t,!0,n,null,s);break;case"together":za(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ba(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function $a(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Ou(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ou(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Wa(e,t){if(!is)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ka(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ha(e,t,n){var r=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ka(t),null;case 1:case 17:return Ri(t.type)&&Di(),Ka(t),null;case 3:return r=t.stateNode,Ys(),Ti(Ni),Ti(xi),no(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(au(ss),ss=null))),Ra(e,t),Ka(t),null;case 5:Xs(t);var i=Gs(Hs.current);if(n=t.type,null!==e&&null!=t.stateNode)Da(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Ka(t),null}if(e=Gs(Ws.current),hs(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[di]=t,r[fi]=o,e=0!==(1&t.mode),n){case"dialog":Vr("cancel",r),Vr("close",r);break;case"iframe":case"object":case"embed":Vr("load",r);break;case"video":case"audio":for(i=0;i<Lr.length;i++)Vr(Lr[i],r);break;case"source":Vr("error",r);break;case"img":case"image":case"link":Vr("error",r),Vr("load",r);break;case"details":Vr("toggle",r);break;case"input":Y(r,o),Vr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Vr("invalid",r);break;case"textarea":ie(r,o),Vr("invalid",r)}for(var l in ve(n,o),i=null,o)if(o.hasOwnProperty(l)){var u=o[l];"children"===l?"string"===typeof u?r.textContent!==u&&(!0!==o.suppressHydrationWarning&&Xr(r.textContent,u,e),i=["children",u]):"number"===typeof u&&r.textContent!==""+u&&(!0!==o.suppressHydrationWarning&&Xr(r.textContent,u,e),i=["children",""+u]):a.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&Vr("scroll",r)}switch(n){case"input":K(r),Z(r,o,!0);break;case"textarea":K(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[di]=t,e[fi]=r,Aa(e,t,!1,!1),t.stateNode=e;e:{switch(l=_e(n,r),n){case"dialog":Vr("cancel",e),Vr("close",e),i=r;break;case"iframe":case"object":case"embed":Vr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Lr.length;i++)Vr(Lr[i],e);i=r;break;case"source":Vr("error",e),i=r;break;case"img":case"image":case"link":Vr("error",e),Vr("load",e),i=r;break;case"details":Vr("toggle",e),i=r;break;case"input":Y(e,r),i=Q(e,r),Vr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=F({},r,{value:void 0}),Vr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Vr("invalid",e)}for(o in ve(n,i),u=i)if(u.hasOwnProperty(o)){var c=u[o];"style"===o?ge(e,c):"dangerouslySetInnerHTML"===o?null!=(c=c?c.__html:void 0)&&he(e,c):"children"===o?"string"===typeof c?("textarea"!==n||""!==c)&&de(e,c):"number"===typeof c&&de(e,""+c):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=c&&"onScroll"===o&&Vr("scroll",e):null!=c&&_(e,o,c,l))}switch(n){case"input":K(e),Z(e,r,!1);break;case"textarea":K(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+$(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ka(t),null;case 6:if(e&&null!=t.stateNode)Oa(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=Gs(Hs.current),Gs(Ws.current),hs(t)){if(r=t.stateNode,n=t.memoizedProps,r[di]=t,(o=r.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[di]=t,t.stateNode=r}return Ka(t),null;case 13:if(Ti(Zs),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(is&&null!==rs&&0!==(1&t.mode)&&0===(128&t.flags))ds(),fs(),t.flags|=98560,o=!1;else if(o=hs(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[di]=t}else fs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ka(t),o=!1}else null!==ss&&(au(ss),ss=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zs.current)?0===Ol&&(Ol=3):gu())),null!==t.updateQueue&&(t.flags|=4),Ka(t),null);case 4:return Ys(),Ra(e,t),null===e&&jr(t.stateNode.containerInfo),Ka(t),null;case 10:return ks(t.type._context),Ka(t),null;case 19:if(Ti(Zs),null===(o=t.memoizedState))return Ka(t),null;if(r=0!==(128&t.flags),null===(l=o.rendering))if(r)Wa(o,!1);else{if(0!==Ol||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=eo(e))){for(t.flags|=128,Wa(o,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ci(Zs,1&Zs.current|2),t.child}e=e.sibling}null!==o.tail&&Je()>Bl&&(t.flags|=128,r=!0,Wa(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=eo(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Wa(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!is)return Ka(t),null}else 2*Je()-o.renderingStartTime>Bl&&1073741824!==n&&(t.flags|=128,r=!0,Wa(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Je(),t.sibling=null,n=Zs.current,Ci(Zs,r?1&n|2:1&n),t):(Ka(t),null);case 22:case 23:return du(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Rl)&&(Ka(t),6&t.subtreeFlags&&(t.flags|=8192)):Ka(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Ga(e,t){switch(ts(t),t.tag){case 1:return Ri(t.type)&&Di(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ys(),Ti(Ni),Ti(xi),no(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xs(t),null;case 13:if(Ti(Zs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ti(Zs),null;case 4:return Ys(),null;case 10:return ks(t.type._context),null;case 22:case 23:return du(),null;default:return null}}Aa=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ra=function(){},Da=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Gs(Ws.current);var s,o=null;switch(n){case"input":i=Q(e,i),r=Q(e,r),o=[];break;case"select":i=F({},i,{value:void 0}),r=F({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(c in ve(n,r),n=null,i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var l=i[c];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(a.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var u=r[c];if(l=null!=i?i[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(null!=u||null!=l))if("style"===c)if(l){for(s in l)!l.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in u)u.hasOwnProperty(s)&&l[s]!==u[s]&&(n||(n={}),n[s]=u[s])}else n||(o||(o=[]),o.push(c,n)),n=u;else"dangerouslySetInnerHTML"===c?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(o=o||[]).push(c,u)):"children"===c?"string"!==typeof u&&"number"!==typeof u||(o=o||[]).push(c,""+u):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(a.hasOwnProperty(c)?(null!=u&&"onScroll"===c&&Vr("scroll",e),o||l===u||(o=[])):(o=o||[]).push(c,u))}n&&(o=o||[]).push("style",n);var c=o;(t.updateQueue=c)&&(t.flags|=4)}},Oa=function(e,t,n,r){n!==r&&(t.flags|=4)};var Qa=!1,Ya=!1,Ja="function"===typeof WeakSet?WeakSet:Set,Xa=null;function Za(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Tu(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){Tu(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&el(t,n,s)}i=i.next}while(i!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function il(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[di],delete t[fi],delete t[mi],delete t[gi],delete t[yi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function al(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function ul(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var cl=null,hl=!1;function dl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(it,n)}catch(a){}switch(n.tag){case 5:Ya||Za(n,t);case 6:var r=cl,i=hl;cl=null,dl(e,t,n),hl=i,null!==(cl=r)&&(hl?(e=cl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):cl.removeChild(n.stateNode));break;case 18:null!==cl&&(hl?(e=cl,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),jt(e)):li(cl,n.stateNode));break;case 4:r=cl,i=hl,cl=n.stateNode.containerInfo,hl=!0,dl(e,t,n),cl=r,hl=i;break;case 0:case 11:case 14:case 15:if(!Ya&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&el(n,t,o),i=i.next}while(i!==r)}dl(e,t,n);break;case 1:if(!Ya&&(Za(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Tu(n,t,a)}dl(e,t,n);break;case 21:dl(e,t,n);break;case 22:1&n.mode?(Ya=(r=Ya)||null!==n.memoizedState,dl(e,t,n),Ya=r):dl(e,t,n);break;default:dl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ja),t.forEach((function(t){var r=Nu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:cl=l.stateNode,hl=!1;break e;case 3:case 4:cl=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===cl)throw Error(s(160));fl(o,a,i),cl=null,hl=!1;var u=i.alternate;null!==u&&(u.return=null),i.return=null}catch(c){Tu(i,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),yl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){Tu(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Tu(e,e.return,g)}}break;case 1:ml(t,e),yl(e),512&r&&null!==n&&Za(n,n.return);break;case 5:if(ml(t,e),yl(e),512&r&&null!==n&&Za(n,n.return),32&e.flags){var i=e.stateNode;try{de(i,"")}catch(g){Tu(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===l&&"radio"===o.type&&null!=o.name&&J(i,o),_e(l,a);var c=_e(l,o);for(a=0;a<u.length;a+=2){var h=u[a],d=u[a+1];"style"===h?ge(i,d):"dangerouslySetInnerHTML"===h?he(i,d):"children"===h?de(i,d):_(i,h,d,c)}switch(l){case"input":X(i,o);break;case"textarea":se(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(i,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[fi]=o}catch(g){Tu(e,e.return,g)}}break;case 6:if(ml(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(s(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){Tu(e,e.return,g)}}break;case 3:if(ml(t,e),yl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{jt(t.containerInfo)}catch(g){Tu(e,e.return,g)}break;case 4:default:ml(t,e),yl(e);break;case 13:ml(t,e),yl(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(jl=Je())),4&r&&pl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Ya=(c=Ya)||h,ml(t,e),Ya=c):ml(t,e),yl(e),8192&r){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!h&&0!==(1&e.mode))for(Xa=e,h=e.child;null!==h;){for(d=Xa=h;null!==Xa;){switch(p=(f=Xa).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:Za(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){r=f,n=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Tu(r,n,g)}}break;case 5:Za(f,f.return);break;case 22:if(null!==f.memoizedState){bl(d);continue}}null!==p?(p.return=f,Xa=p):bl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,c?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=d.stateNode,a=void 0!==(u=d.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,l.style.display=me("display",a))}catch(g){Tu(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){Tu(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ml(t,e),yl(e),4&r&&pl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(de(i,""),r.flags&=-33),ul(e,al(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;ll(e,al(e),o);break;default:throw Error(s(161))}}catch(sc){Tu(e,e.return,sc)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){Xa=e,_l(e,t,n)}function _l(e,t,n){for(var r=0!==(1&e.mode);null!==Xa;){var i=Xa,s=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Qa;if(!o){var a=i.alternate,l=null!==a&&null!==a.memoizedState||Ya;a=Qa;var u=Ya;if(Qa=o,(Ya=l)&&!u)for(Xa=i;null!==Xa;)l=(o=Xa).child,22===o.tag&&null!==o.memoizedState?Il(i):null!==l?(l.return=o,Xa=l):Il(i);for(;null!==s;)Xa=s,_l(s,t,n),s=s.sibling;Xa=i,Qa=a,Ya=u}wl(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,Xa=s):wl(e)}}function wl(e){for(;null!==Xa;){var t=Xa;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ya||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ya)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:na(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Bs(t,o,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Bs(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var h=c.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&jt(d)}}}break;default:throw Error(s(163))}Ya||512&t.flags&&il(t)}catch(f){Tu(t,t.return,f)}}if(t===e){Xa=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xa=n;break}Xa=t.return}}function bl(e){for(;null!==Xa;){var t=Xa;if(t===e){Xa=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xa=n;break}Xa=t.return}}function Il(e){for(;null!==Xa;){var t=Xa;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(sc){Tu(t,n,sc)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(sc){Tu(t,i,sc)}}var s=t.return;try{il(t)}catch(sc){Tu(t,s,sc)}break;case 5:var o=t.return;try{il(t)}catch(sc){Tu(t,o,sc)}}}catch(sc){Tu(t,t.return,sc)}if(t===e){Xa=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Xa=a;break}Xa=t.return}}var El,Sl=Math.ceil,Tl=w.ReactCurrentDispatcher,Cl=w.ReactCurrentOwner,kl=w.ReactCurrentBatchConfig,xl=0,Nl=null,Pl=null,Al=0,Rl=0,Dl=Si(0),Ol=0,Ll=null,Ml=0,Fl=0,Ul=0,Vl=null,zl=null,jl=0,Bl=1/0,$l=null,Wl=!1,Kl=null,Hl=null,Gl=!1,Ql=null,Yl=0,Jl=0,Xl=null,Zl=-1,eu=0;function tu(){return 0!==(6&xl)?Je():-1!==Zl?Zl:Zl=Je()}function nu(e){return 0===(1&e.mode)?1:0!==(2&xl)&&0!==Al?Al&-Al:null!==ms.transition?(0===eu&&(eu=mt()),eu):0!==(e=_t)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function ru(e,t,n,r){if(50<Jl)throw Jl=0,Xl=null,Error(s(185));yt(e,n,r),0!==(2&xl)&&e===Nl||(e===Nl&&(0===(2&xl)&&(Fl|=n),4===Ol&&lu(e,Al)),iu(e,r),1===n&&0===xl&&0===(1&t.mode)&&(Bl=Je()+500,Vi&&ji()))}function iu(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),a=1<<o,l=i[o];-1===l?0!==(a&n)&&0===(a&r)||(i[o]=ft(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var r=dt(e,e===Nl?Al:0);if(0===r)null!==n&&Ge(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ge(n),1===t)0===e.tag?function(e){Vi=!0,zi(e)}(uu.bind(null,e)):zi(uu.bind(null,e)),oi((function(){0===(6&xl)&&ji()})),n=null;else{switch(wt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Pu(n,su.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function su(e,t){if(Zl=-1,eu=0,0!==(6&xl))throw Error(s(327));var n=e.callbackNode;if(Eu()&&e.callbackNode!==n)return null;var r=dt(e,e===Nl?Al:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=yu(e,r);else{t=r;var i=xl;xl|=2;var o=mu();for(Nl===e&&Al===t||($l=null,Bl=Je()+500,fu(e,t));;)try{_u();break}catch(l){pu(e,l)}Cs(),Tl.current=o,xl=i,null!==Pl?t=0:(Nl=null,Al=0,t=Ol)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=ou(e,i))),1===t)throw n=Ll,fu(e,0),lu(e,r),iu(e,Je()),n;if(6===t)lu(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ar(s(),i))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=yu(e,r))&&(0!==(o=pt(e))&&(r=o,t=ou(e,o))),1===t))throw n=Ll,fu(e,0),lu(e,r),iu(e,Je()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:Iu(e,zl,$l);break;case 3:if(lu(e,r),(130023424&r)===r&&10<(t=jl+500-Je())){if(0!==dt(e,0))break;if(((i=e.suspendedLanes)&r)!==r){tu(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(Iu.bind(null,e,zl,$l),t);break}Iu(e,zl,$l);break;case 4:if(lu(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-ot(r);o=1<<a,(a=t[a])>i&&(i=a),r&=~o}if(r=i,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Sl(r/1960))-r)){e.timeoutHandle=ri(Iu.bind(null,e,zl,$l),r);break}Iu(e,zl,$l);break;default:throw Error(s(329))}}}return iu(e,Je()),e.callbackNode===n?su.bind(null,e):null}function ou(e,t){var n=Vl;return e.current.memoizedState.isDehydrated&&(fu(e,t).flags|=256),2!==(e=yu(e,t))&&(t=zl,zl=n,null!==t&&au(t)),e}function au(e){null===zl?zl=e:zl.push.apply(zl,e)}function lu(e,t){for(t&=~Ul,t&=~Fl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function uu(e){if(0!==(6&xl))throw Error(s(327));Eu();var t=dt(e,0);if(0===(1&t))return iu(e,Je()),null;var n=yu(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=ou(e,r))}if(1===n)throw n=Ll,fu(e,0),lu(e,t),iu(e,Je()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Iu(e,zl,$l),iu(e,Je()),null}function cu(e,t){var n=xl;xl|=1;try{return e(t)}finally{0===(xl=n)&&(Bl=Je()+500,Vi&&ji())}}function hu(e){null!==Ql&&0===Ql.tag&&0===(6&xl)&&Eu();var t=xl;xl|=1;var n=kl.transition,r=_t;try{if(kl.transition=null,_t=1,e)return e()}finally{_t=r,kl.transition=n,0===(6&(xl=t))&&ji()}}function du(){Rl=Dl.current,Ti(Dl)}function fu(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Pl)for(n=Pl.return;null!==n;){var r=n;switch(ts(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Di();break;case 3:Ys(),Ti(Ni),Ti(xi),no();break;case 5:Xs(r);break;case 4:Ys();break;case 13:case 19:Ti(Zs);break;case 10:ks(r.type._context);break;case 22:case 23:du()}n=n.return}if(Nl=e,Pl=e=Ou(e.current,null),Al=Rl=t,Ol=0,Ll=null,Ul=Fl=Ml=0,zl=Vl=null,null!==As){for(t=0;t<As.length;t++)if(null!==(r=(n=As[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var o=s.next;s.next=i,r.next=o}n.pending=r}As=null}return e}function pu(e,t){for(;;){var n=Pl;try{if(Cs(),ro.current=Xo,uo){for(var r=oo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}uo=!1}if(so=0,lo=ao=oo=null,co=!1,ho=0,Cl.current=null,null===n||null===n.return){Ol=1,Ll=t,Pl=null;break}e:{var o=e,a=n.return,l=n,u=t;if(t=Al,l.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var c=u,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=ga(a);if(null!==p){p.flags&=-257,ya(p,a,l,0,t),1&p.mode&&ma(o,c,t),u=c;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(u),t.updateQueue=g}else m.add(u);break e}if(0===(1&t)){ma(o,c,t),gu();break e}u=Error(s(426))}else if(is&&1&l.mode){var y=ga(a);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),ya(y,a,l,0,t),ps(ua(u,l));break e}}o=u=ua(u,l),4!==Ol&&(Ol=2),null===Vl?Vl=[o]:Vl.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,zs(o,fa(0,u,t));break e;case 1:l=u;var v=o.type,_=o.stateNode;if(0===(128&o.flags)&&("function"===typeof v.getDerivedStateFromError||null!==_&&"function"===typeof _.componentDidCatch&&(null===Hl||!Hl.has(_)))){o.flags|=65536,t&=-t,o.lanes|=t,zs(o,pa(o,l,t));break e}}o=o.return}while(null!==o)}bu(n)}catch(w){t=w,Pl===n&&null!==n&&(Pl=n=n.return);continue}break}}function mu(){var e=Tl.current;return Tl.current=Xo,null===e?Xo:e}function gu(){0!==Ol&&3!==Ol&&2!==Ol||(Ol=4),null===Nl||0===(268435455&Ml)&&0===(268435455&Fl)||lu(Nl,Al)}function yu(e,t){var n=xl;xl|=2;var r=mu();for(Nl===e&&Al===t||($l=null,fu(e,t));;)try{vu();break}catch(i){pu(e,i)}if(Cs(),xl=n,Tl.current=r,null!==Pl)throw Error(s(261));return Nl=null,Al=0,Ol}function vu(){for(;null!==Pl;)wu(Pl)}function _u(){for(;null!==Pl&&!Qe();)wu(Pl)}function wu(e){var t=El(e.alternate,e,Rl);e.memoizedProps=e.pendingProps,null===t?bu(e):Pl=t,Cl.current=null}function bu(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ha(n,t,Rl)))return void(Pl=n)}else{if(null!==(n=Ga(n,t)))return n.flags&=32767,void(Pl=n);if(null===e)return Ol=6,void(Pl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Pl=t);Pl=t=e}while(null!==t);0===Ol&&(Ol=5)}function Iu(e,t,n){var r=_t,i=kl.transition;try{kl.transition=null,_t=1,function(e,t,n,r){do{Eu()}while(null!==Ql);if(0!==(6&xl))throw Error(s(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,o),e===Nl&&(Pl=Nl=null,Al=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Gl||(Gl=!0,Pu(tt,(function(){return Eu(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=kl.transition,kl.transition=null;var a=_t;_t=1;var l=xl;xl|=4,Cl.current=null,function(e,t){if(ei=$t,fr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(Vu){n=null;break e}var a=0,l=-1,u=-1,c=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==i&&3!==d.nodeType||(l=a+i),d!==o||0!==r&&3!==d.nodeType||(u=a+r),3===d.nodeType&&(a+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++c===i&&(l=a),f===o&&++h===r&&(u=a),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===u?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},$t=!1,Xa=t;null!==Xa;)if(e=(t=Xa).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xa=e;else for(;null!==Xa;){t=Xa;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,_=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:na(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(s(163))}}catch(Vu){Tu(t,t.return,Vu)}if(null!==(e=t.sibling)){e.return=t.return,Xa=e;break}Xa=t.return}m=tl,tl=!1}(e,n),gl(n,e),pr(ti),$t=!!ei,ti=ei=null,e.current=n,vl(n,e,i),Ye(),xl=l,_t=a,kl.transition=o}else e.current=n;if(Gl&&(Gl=!1,Ql=e,Yl=i),o=e.pendingLanes,0===o&&(Hl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),iu(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Wl)throw Wl=!1,e=Kl,Kl=null,e;0!==(1&Yl)&&0!==e.tag&&Eu(),o=e.pendingLanes,0!==(1&o)?e===Xl?Jl++:(Jl=0,Xl=e):Jl=0,ji()}(e,t,n,r)}finally{kl.transition=i,_t=r}return null}function Eu(){if(null!==Ql){var e=wt(Yl),t=kl.transition,n=_t;try{if(kl.transition=null,_t=16>e?16:e,null===Ql)var r=!1;else{if(e=Ql,Ql=null,Yl=0,0!==(6&xl))throw Error(s(331));var i=xl;for(xl|=4,Xa=e.current;null!==Xa;){var o=Xa,a=o.child;if(0!==(16&Xa.flags)){var l=o.deletions;if(null!==l){for(var u=0;u<l.length;u++){var c=l[u];for(Xa=c;null!==Xa;){var h=Xa;switch(h.tag){case 0:case 11:case 15:nl(8,h,o)}var d=h.child;if(null!==d)d.return=h,Xa=d;else for(;null!==Xa;){var f=(h=Xa).sibling,p=h.return;if(sl(h),h===c){Xa=null;break}if(null!==f){f.return=p,Xa=f;break}Xa=p}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Xa=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,Xa=a;else e:for(;null!==Xa;){if(0!==(2048&(o=Xa).flags))switch(o.tag){case 0:case 11:case 15:nl(9,o,o.return)}var v=o.sibling;if(null!==v){v.return=o.return,Xa=v;break e}Xa=o.return}}var _=e.current;for(Xa=_;null!==Xa;){var w=(a=Xa).child;if(0!==(2064&a.subtreeFlags)&&null!==w)w.return=a,Xa=w;else e:for(a=_;null!==Xa;){if(0!==(2048&(l=Xa).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(I){Tu(l,l.return,I)}if(l===a){Xa=null;break e}var b=l.sibling;if(null!==b){b.return=l.return,Xa=b;break e}Xa=l.return}}if(xl=i,ji(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(it,e)}catch(I){}r=!0}return r}finally{_t=n,kl.transition=t}}return!1}function Su(e,t,n){e=Vs(e,t=fa(0,t=ua(n,t),1),1),t=tu(),null!==e&&(yt(e,1,t),iu(e,t))}function Tu(e,t,n){if(3===e.tag)Su(e,e,n);else for(;null!==t;){if(3===t.tag){Su(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Hl||!Hl.has(r))){t=Vs(t,e=pa(t,e=ua(n,e),1),1),e=tu(),null!==t&&(yt(t,1,e),iu(t,e));break}}t=t.return}}function Cu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tu(),e.pingedLanes|=e.suspendedLanes&n,Nl===e&&(Al&n)===n&&(4===Ol||3===Ol&&(130023424&Al)===Al&&500>Je()-jl?fu(e,0):Ul|=n),iu(e,t)}function ku(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=tu();null!==(e=Os(e,t))&&(yt(e,t,n),iu(e,n))}function xu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),ku(e,n)}function Nu(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),ku(e,n)}function Pu(e,t){return He(e,t)}function Au(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ru(e,t,n,r){return new Au(e,t,n,r)}function Du(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ou(e,t){var n=e.alternate;return null===n?((n=Ru(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Lu(e,t,n,r,i,o){var a=2;if(r=e,"function"===typeof e)Du(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case E:return Mu(n.children,i,o,t);case S:a=8,i|=8;break;case T:return(e=Ru(12,n,t,2|i)).elementType=T,e.lanes=o,e;case N:return(e=Ru(13,n,t,i)).elementType=N,e.lanes=o,e;case P:return(e=Ru(19,n,t,i)).elementType=P,e.lanes=o,e;case D:return Fu(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:a=10;break e;case k:a=9;break e;case x:a=11;break e;case A:a=14;break e;case R:a=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Ru(a,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Mu(e,t,n,r){return(e=Ru(7,e,r,t)).lanes=n,e}function Fu(e,t,n,r){return(e=Ru(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Uu(e,t,n){return(e=Ru(6,e,null,t)).lanes=n,e}function qu(e,t,n){return(t=Ru(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zu(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function ju(e,t,n,r,i,s,o,a,l){return e=new zu(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Ru(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ms(s),e}function Bu(e){if(!e)return ki;e:{if(je(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ri(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Ri(n))return Li(e,n,t)}return t}function $u(e,t,n,r,i,s,o,a,l){return(e=ju(n,r,!0,e,0,s,0,a,l)).context=Bu(null),n=e.current,(s=Us(r=tu(),i=nu(n))).callback=void 0!==t&&null!==t?t:null,Vs(n,s,i),e.current.lanes=i,yt(e,i,r),iu(e,r),e}function Wu(e,t,n,r){var i=t.current,s=tu(),o=nu(i);return n=Bu(n),null===t.context?t.context=n:t.pendingContext=n,(t=Us(s,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Vs(i,t,o))&&(ru(e,i,o,s),qs(e,i,o)),o}function Ku(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Gu(e,t){Hu(e,t),(e=e.alternate)&&Hu(e,t)}El=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ni.current)_a=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return _a=!1,function(e,t,n){switch(t.tag){case 3:Na(t),fs();break;case 5:Js(t);break;case 1:Ri(t.type)&&Mi(t);break;case 4:Qs(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ci(Is,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ci(Zs,1&Zs.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Fa(e,t,n):(Ci(Zs,1&Zs.current),null!==(e=$a(e,t,n))?e.sibling:null);Ci(Zs,1&Zs.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return ja(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ci(Zs,Zs.current),r)break;return null;case 22:case 23:return t.lanes=0,Sa(e,t,n)}return $a(e,t,n)}(e,t,n);_a=0!==(131072&e.flags)}else _a=!1,is&&0!==(1048576&t.flags)&&Zi(t,Ki,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ba(e,t),e=t.pendingProps;var i=Ai(t,xi.current);Ns(t,n),i=go(null,t,r,e,i,n);var o=yo();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ri(r)?(o=!0,Mi(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Ms(t),i.updater=ia,t.stateNode=i,i._reactInternals=t,la(t,r,e,n),t=xa(null,t,r,!0,o,n)):(t.tag=0,is&&o&&es(t),wa(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ba(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Du(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===x)return 11;if(e===A)return 14}return 2}(r),e=na(r,e),i){case 0:t=Ca(null,t,r,e,n);break e;case 1:t=ka(null,t,r,e,n);break e;case 11:t=ba(null,t,r,e,n);break e;case 14:t=Ia(null,t,r,na(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Ca(e,t,r,i=t.elementType===r?i:na(r,i),n);case 1:return r=t.type,i=t.pendingProps,ka(e,t,r,i=t.elementType===r?i:na(r,i),n);case 3:e:{if(Na(t),null===e)throw Error(s(387));r=t.pendingProps,i=(o=t.memoizedState).element,Fs(e,t),js(t,r,null,n);var a=t.memoizedState;if(r=a.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Pa(e,t,r,n,i=ua(Error(s(423)),t));break e}if(r!==i){t=Pa(e,t,r,n,i=ua(Error(s(424)),t));break e}for(rs=ui(t.stateNode.containerInfo.firstChild),ns=t,is=!0,ss=null,n=bs(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fs(),r===i){t=$a(e,t,n);break e}wa(e,t,r,n)}t=t.child}return t;case 5:return Js(t),null===e&&us(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,ni(r,i)?a=null:null!==o&&ni(r,o)&&(t.flags|=32),Ta(e,t),wa(e,t,a,n),t.child;case 6:return null===e&&us(t),null;case 13:return Fa(e,t,n);case 4:return Qs(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=ws(t,null,r,n):wa(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,ba(e,t,r,i=t.elementType===r?i:na(r,i),n);case 7:return wa(e,t,t.pendingProps,n),t.child;case 8:case 12:return wa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=i.value,Ci(Is,r._currentValue),r._currentValue=a,null!==o)if(ar(o.value,a)){if(o.children===i.children&&!Ni.current){t=$a(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var u=l.firstContext;null!==u;){if(u.context===r){if(1===o.tag){(u=Us(-1,n&-n)).tag=2;var c=o.updateQueue;if(null!==c){var h=(c=c.shared).pending;null===h?u.next=u:(u.next=h.next,h.next=u),c.pending=u}}o.lanes|=n,null!==(u=o.alternate)&&(u.lanes|=n),xs(o.return,n,t),l.lanes|=n;break}u=u.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),xs(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}wa(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ns(t,n),r=r(i=Ps(i)),t.flags|=1,wa(e,t,r,n),t.child;case 14:return i=na(r=t.type,t.pendingProps),Ia(e,t,r,i=na(r.type,i),n);case 15:return Ea(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:na(r,i),Ba(e,t),t.tag=1,Ri(r)?(e=!0,Mi(t)):e=!1,Ns(t,n),oa(t,r,i),la(t,r,i,n),xa(null,t,r,!0,e,n);case 19:return ja(e,t,n);case 22:return Sa(e,t,n)}throw Error(s(156,t.tag))};var Qu="function"===typeof reportError?reportError:function(e){console.error(e)};function Yu(e){this._internalRoot=e}function Ju(e){this._internalRoot=e}function Xu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Zu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function ec(){}function tc(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof i){var a=i;i=function(){var e=Ku(o);a.call(e)}}Wu(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var s=r;r=function(){var e=Ku(o);s.call(e)}}var o=$u(t,r,e,0,null,!1,0,"",ec);return e._reactRootContainer=o,e[pi]=o.current,jr(8===e.nodeType?e.parentNode:e),hu(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var a=r;r=function(){var e=Ku(l);a.call(e)}}var l=ju(e,0,!1,null,0,!1,0,"",ec);return e._reactRootContainer=l,e[pi]=l.current,jr(8===e.nodeType?e.parentNode:e),hu((function(){Wu(t,l,n,r)})),l}(n,t,e,i,r);return Ku(o)}Ju.prototype.render=Yu.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Wu(e,t,null,null)},Ju.prototype.unmount=Yu.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;hu((function(){Wu(null,e,null,null)})),t[pi]=null}},Ju.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Ft(e)}},bt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(vt(t,1|n),iu(t,Je()),0===(6&xl)&&(Bl=Je()+500,ji()))}break;case 13:hu((function(){var t=Os(e,1);if(null!==t){var n=tu();ru(t,e,1,n)}})),Gu(e,1)}},It=function(e){if(13===e.tag){var t=Os(e,134217728);if(null!==t)ru(t,e,134217728,tu());Gu(e,134217728)}},Et=function(e){if(13===e.tag){var t=nu(e),n=Os(e,t);if(null!==n)ru(n,e,t,tu());Gu(e,t)}},St=function(){return _t},Tt=function(e,t){var n=_t;try{return _t=e,t()}finally{_t=n}},Ie=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=bi(r);if(!i)throw Error(s(90));H(r),X(r,i)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},xe=cu,Ne=hu;var nc={usingClientEntryPoint:!1,Events:[_i,wi,bi,Ce,ke,cu]},rc={findFiberByHostInstance:vi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ic={bundleType:rc.bundleType,version:rc.version,rendererPackageName:rc.rendererPackageName,rendererConfig:rc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:rc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var oc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!oc.isDisabled&&oc.supportsFiber)try{it=oc.inject(ic),st=oc}catch(ce){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nc,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xu(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:I,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Xu(e))throw Error(s(299));var n=!1,r="",i=Qu;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=ju(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,jr(8===e.nodeType?e.parentNode:e),new Yu(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return hu(e)},t.hydrate=function(e,t,n){if(!Zu(t))throw Error(s(200));return tc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Xu(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",a=Qu;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=$u(t,null,e,1,null!=n?n:null,i,0,o,a),e[pi]=t.current,jr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Ju(t)},t.render=function(e,t,n){if(!Zu(t))throw Error(s(200));return tc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Zu(e))throw Error(s(40));return!!e._reactRootContainer&&(hu((function(){tc(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=cu,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Zu(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return tc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},153:(e,t,n)=>{var r=n(43),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,n){var r,s={},u=null,c=null;for(r in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:u,ref:c,props:s,_owner:a.current}}t.jsx=u,t.jsxs=u},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function v(){}function _(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var w=_.prototype=new v;w.constructor=_,m(w,y.prototype),w.isPureReactComponent=!0;var b=Array.isArray,I=Object.prototype.hasOwnProperty,E={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function T(e,t,r){var i,s={},o=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)I.call(t,i)&&!S.hasOwnProperty(i)&&(s[i]=t[i]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];s.children=u}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===s[i]&&(s[i]=l[i]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:E.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var k=/\/+/g;function x(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function N(e,t,i,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=e),e=""===s?"."+x(l,0):s,b(o)?(i="",null!=e&&(i=e.replace(k,"$&/")+"/"),N(o,t,i,"",(function(e){return e}))):null!=o&&(C(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(k,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",b(e))for(var u=0;u<e.length;u++){var c=s+x(a=e[u],u);l+=N(a,t,i,c,o)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),u=0;!(a=e.next()).done;)l+=N(a=a.value,t,i,c=s+x(a,u++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function P(e,t,n){if(null==e)return e;var r=[],i=0;return N(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},D={transition:null},O={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:D,ReactCurrentOwner:E};function L(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:P,forEach:function(e,t,n){P(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return P(e,(function(){t++})),t},toArray:function(e){return P(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=i,t.Profiler=o,t.PureComponent=_,t.StrictMode=s,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.act=L,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=E.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)I.call(t,u)&&!S.hasOwnProperty(u)&&(i[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];i.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=T,t.createFactory=function(e){var t=T.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=L,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},43:(e,t,n)=>{e.exports=n(202)},579:(e,t,n)=>{e.exports=n(153)},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var a=2*(r+1)-1,l=e[a],u=a+1,c=e[u];if(0>s(l,n))u<i&&0>s(c,l)?(e[r]=c,e[u]=n,r=u):(e[r]=l,e[a]=n,r=a);else{if(!(u<i&&0>s(c,n)))break e;e[r]=c,e[u]=n,r=u}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var u=[],c=[],h=1,d=null,f=3,p=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,_="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(c);null!==t;){if(null===t.callback)i(c);else{if(!(t.startTime<=e))break;i(c),t.sortIndex=t.expirationTime,n(u,t)}t=r(c)}}function b(e){if(g=!1,w(e),!m)if(null!==r(u))m=!0,D(I);else{var t=r(c);null!==t&&O(b,t.startTime-e)}}function I(e,n){m=!1,g&&(g=!1,v(C),C=-1),p=!0;var s=f;try{for(w(n),d=r(u);null!==d&&(!(d.expirationTime>n)||e&&!N());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var a=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?d.callback=a:d===r(u)&&i(u),w(n)}else i(u);d=r(u)}if(null!==d)var l=!0;else{var h=r(c);null!==h&&O(b,h.startTime-n),l=!1}return l}finally{d=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,S=!1,T=null,C=-1,k=5,x=-1;function N(){return!(t.unstable_now()-x<k)}function P(){if(null!==T){var e=t.unstable_now();x=e;var n=!0;try{n=T(!0,e)}finally{n?E():(S=!1,T=null)}}else S=!1}if("function"===typeof _)E=function(){_(P)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,R=A.port2;A.port1.onmessage=P,E=function(){R.postMessage(null)}}else E=function(){y(P,0)};function D(e){T=e,S||(S=!0,E())}function O(e,n){C=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,D(I))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(c,e),null===r(u)&&e===r(c)&&(g?(v(C),C=-1):g=!0,O(b,s-o))):(e.sortIndex=a,n(u,e),m||p||(m=!0,D(I))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},853:(e,t,n)=>{e.exports=n(234)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var s=Object.create(null);n.r(s);var o={};e=e||[null,t({}),t([]),t(t)];for(var a=2&i&&r;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>o[e]=()=>r[e]));return o.default=()=>r,n.d(s,o),s}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};n.r(r),n.d(r,{FirebaseError:()=>Xe,SDK_VERSION:()=>Bn,_DEFAULT_ENTRY_NAME:()=>kn,_addComponent:()=>Rn,_addOrOverwriteComponent:()=>Dn,_apps:()=>Nn,_clearComponents:()=>Vn,_components:()=>An,_getProvider:()=>Ln,_isFirebaseApp:()=>Fn,_isFirebaseServerApp:()=>Un,_registerComponent:()=>On,_removeServiceInstance:()=>Mn,_serverApps:()=>Pn,deleteApp:()=>Gn,getApp:()=>Kn,getApps:()=>Hn,initializeApp:()=>$n,initializeServerApp:()=>Wn,onLog:()=>Yn,registerVersion:()=>Qn,setLogLevel:()=>Jn});var i,s=n(43),o=n.t(s,2),a=n(391),l=n(950),u=n.t(l,2);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(i||(i={}));const h="popstate";function d(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function f(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function p(e,t){return{usr:e.state,key:e.key,idx:t}}function m(e,t,n,r){return void 0===n&&(n=null),c({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?y(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function g(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function y(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function v(e,t,n,r){void 0===r&&(r={});let{window:s=document.defaultView,v5Compat:o=!1}=r,a=s.history,l=i.Pop,u=null,f=y();function y(){return(a.state||{idx:null}).idx}function v(){l=i.Pop;let e=y(),t=null==e?null:e-f;f=e,u&&u({action:l,location:w.location,delta:t})}function _(e){let t="null"!==s.location.origin?s.location.origin:s.location.href,n="string"===typeof e?e:g(e);return n=n.replace(/ $/,"%20"),d(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==f&&(f=0,a.replaceState(c({},a.state,{idx:f}),""));let w={get action(){return l},get location(){return e(s,a)},listen(e){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(h,v),u=e,()=>{s.removeEventListener(h,v),u=null}},createHref:e=>t(s,e),createURL:_,encodeLocation(e){let t=_(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l=i.Push;let r=m(w.location,e,t);n&&n(r,e),f=y()+1;let c=p(r,f),h=w.createHref(r);try{a.pushState(c,"",h)}catch(kb){if(kb instanceof DOMException&&"DataCloneError"===kb.name)throw kb;s.location.assign(h)}o&&u&&u({action:l,location:w.location,delta:1})},replace:function(e,t){l=i.Replace;let r=m(w.location,e,t);n&&n(r,e),f=y();let s=p(r,f),c=w.createHref(r);a.replaceState(s,"",c),o&&u&&u({action:l,location:w.location,delta:0})},go:e=>a.go(e)};return w}var _;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(_||(_={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function w(e,t,n){return void 0===n&&(n="/"),b(e,t,n,!1)}function b(e,t,n,r){let i=L(("string"===typeof t?y(t):t).pathname||"/",n);if(null==i)return null;let s=I(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(s);let o=null;for(let a=0;null==o&&a<s.length;++a){let e=O(i);o=R(s[a],e,r)}return o}function I(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let i=(e,i,s)=>{let o={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};o.relativePath.startsWith("/")&&(d(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(r.length));let a=q([r,o.relativePath]),l=n.concat(o);e.children&&e.children.length>0&&(d(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+a+'".'),I(e.children,t,l,a)),(null!=e.path||e.index)&&t.push({path:a,score:A(a,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of E(e.path))i(e,t,r);else i(e,t)})),t}function E(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===r.length)return i?[s,""]:[s];let o=E(r.join("/")),a=[];return a.push(...o.map((e=>""===e?s:[s,e].join("/")))),i&&a.push(...o),a.map((t=>e.startsWith("/")&&""===t?"/":t))}const S=/^:[\w-]+$/,T=3,C=2,k=1,x=10,N=-2,P=e=>"*"===e;function A(e,t){let n=e.split("/"),r=n.length;return n.some(P)&&(r+=N),t&&(r+=C),n.filter((e=>!P(e))).reduce(((e,t)=>e+(S.test(t)?T:""===t?k:x)),r)}function R(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,i={},s="/",o=[];for(let a=0;a<r.length;++a){let e=r[a],l=a===r.length-1,u="/"===s?t:t.slice(s.length)||"/",c=D({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},u),h=e.route;if(!c&&l&&n&&!r[r.length-1].route.index&&(c=D({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},u)),!c)return null;Object.assign(i,c.params),o.push({params:i,pathname:q([s,c.pathname]),pathnameBase:z(q([s,c.pathnameBase])),route:h}),"/"!==c.pathnameBase&&(s=q([s,c.pathnameBase]))}return o}function D(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);f("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(r.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");let s=new RegExp(i,t?void 0:"i");return[s,r]}(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce(((e,t,n)=>{let{paramName:r,isOptional:i}=t;if("*"===r){let e=a[n]||"";o=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=a[n];return e[r]=i&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{}),pathname:s,pathnameBase:o,pattern:e}}function O(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(kb){return f(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+kb+")."),e}}function L(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function M(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function F(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function U(e,t){let n=F(e);return t?n.map(((e,t)=>t===n.length-1?e.pathname:e.pathnameBase)):n.map((e=>e.pathnameBase))}function V(e,t,n,r){let i;void 0===r&&(r=!1),"string"===typeof e?i=y(e):(i=c({},e),d(!i.pathname||!i.pathname.includes("?"),M("?","pathname","search",i)),d(!i.pathname||!i.pathname.includes("#"),M("#","pathname","hash",i)),d(!i.search||!i.search.includes("#"),M("#","search","hash",i)));let s,o=""===e||""===i.pathname,a=o?"/":i.pathname;if(null==a)s=n;else{let e=t.length-1;if(!r&&a.startsWith("..")){let t=a.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}s=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:i=""}="string"===typeof e?y(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:j(r),hash:B(i)}}(i,s),u=a&&"/"!==a&&a.endsWith("/"),h=(o||"."===a)&&n.endsWith("/");return l.pathname.endsWith("/")||!u&&!h||(l.pathname+="/"),l}const q=e=>e.join("/").replace(/\/\/+/g,"/"),z=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),j=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",B=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function $(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const W=["post","put","patch","delete"],K=(new Set(W),["get",...W]);new Set(K),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function H(){return H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},H.apply(this,arguments)}const G=s.createContext(null);const Q=s.createContext(null);const Y=s.createContext(null);const J=s.createContext(null);const X=s.createContext({outlet:null,matches:[],isDataRoute:!1});const Z=s.createContext(null);function ee(){return null!=s.useContext(J)}function te(){return ee()||d(!1),s.useContext(J).location}function ne(e){s.useContext(Y).static||s.useLayoutEffect(e)}function re(){let{isDataRoute:e}=s.useContext(X);return e?function(){let{router:e}=de(ce.UseNavigateStable),t=pe(he.UseNavigateStable),n=s.useRef(!1);return ne((()=>{n.current=!0})),s.useCallback((function(r,i){void 0===i&&(i={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,H({fromRouteId:t},i)))}),[e,t])}():function(){ee()||d(!1);let e=s.useContext(G),{basename:t,future:n,navigator:r}=s.useContext(Y),{matches:i}=s.useContext(X),{pathname:o}=te(),a=JSON.stringify(U(i,n.v7_relativeSplatPath)),l=s.useRef(!1);return ne((()=>{l.current=!0})),s.useCallback((function(n,i){if(void 0===i&&(i={}),!l.current)return;if("number"===typeof n)return void r.go(n);let s=V(n,JSON.parse(a),o,"path"===i.relative);null==e&&"/"!==t&&(s.pathname="/"===s.pathname?t:q([t,s.pathname])),(i.replace?r.replace:r.push)(s,i.state,i)}),[t,r,a,o,e])}()}function ie(e,t,n,r){ee()||d(!1);let{navigator:o}=s.useContext(Y),{matches:a}=s.useContext(X),l=a[a.length-1],u=l?l.params:{},c=(l&&l.pathname,l?l.pathnameBase:"/");l&&l.route;let h,f=te();if(t){var p;let e="string"===typeof t?y(t):t;"/"===c||(null==(p=e.pathname)?void 0:p.startsWith(c))||d(!1),h=e}else h=f;let m=h.pathname||"/",g=m;if("/"!==c){let e=c.replace(/^\//,"").split("/");g="/"+m.replace(/^\//,"").split("/").slice(e.length).join("/")}let v=w(e,{pathname:g});let _=ue(v&&v.map((e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:q([c,o.encodeLocation?o.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?c:q([c,o.encodeLocation?o.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),a,n,r);return t&&_?s.createElement(J.Provider,{value:{location:H({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:i.Pop}},_):_}function se(){let e=function(){var e;let t=s.useContext(Z),n=fe(he.UseRouteError),r=pe(he.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[r]}(),t=$(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r};return s.createElement(s.Fragment,null,s.createElement("h2",null,"Unexpected Application Error!"),s.createElement("h3",{style:{fontStyle:"italic"}},t),n?s.createElement("pre",{style:i},n):null,null)}const oe=s.createElement(se,null);class ae extends s.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?s.createElement(X.Provider,{value:this.props.routeContext},s.createElement(Z.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function le(e){let{routeContext:t,match:n,children:r}=e,i=s.useContext(G);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),s.createElement(X.Provider,{value:t},r)}function ue(e,t,n,r){var i;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var o;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(o=r)&&o.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let a=e,l=null==(i=n)?void 0:i.errors;if(null!=l){let e=a.findIndex((e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id])));e>=0||d(!1),a=a.slice(0,Math.min(a.length,e+1))}let u=!1,c=-1;if(n&&r&&r.v7_partialHydration)for(let s=0;s<a.length;s++){let e=a[s];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(c=s),e.route.id){let{loaderData:t,errors:r}=n,i=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||i){u=!0,a=c>=0?a.slice(0,c+1):[a[0]];break}}}return a.reduceRight(((e,r,i)=>{let o,h=!1,d=null,f=null;var p;n&&(o=l&&r.route.id?l[r.route.id]:void 0,d=r.route.errorElement||oe,u&&(c<0&&0===i?(p="route-fallback",!1||me[p]||(me[p]=!0),h=!0,f=null):c===i&&(h=!0,f=r.route.hydrateFallbackElement||null)));let m=t.concat(a.slice(0,i+1)),g=()=>{let t;return t=o?d:h?f:r.route.Component?s.createElement(r.route.Component,null):r.route.element?r.route.element:e,s.createElement(le,{match:r,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===i)?s.createElement(ae,{location:n.location,revalidation:n.revalidation,component:d,error:o,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()}),null)}var ce=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ce||{}),he=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(he||{});function de(e){let t=s.useContext(G);return t||d(!1),t}function fe(e){let t=s.useContext(Q);return t||d(!1),t}function pe(e){let t=function(){let e=s.useContext(X);return e||d(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||d(!1),n.route.id}const me={};o.startTransition;function ge(e){let{to:t,replace:n,state:r,relative:i}=e;ee()||d(!1);let{future:o,static:a}=s.useContext(Y),{matches:l}=s.useContext(X),{pathname:u}=te(),c=re(),h=V(t,U(l,o.v7_relativeSplatPath),u,"path"===i),f=JSON.stringify(h);return s.useEffect((()=>c(JSON.parse(f),{replace:n,state:r,relative:i})),[c,f,i,n,r]),null}function ye(e){d(!1)}function ve(e){let{basename:t="/",children:n=null,location:r,navigationType:o=i.Pop,navigator:a,static:l=!1,future:u}=e;ee()&&d(!1);let c=t.replace(/^\/*/,"/"),h=s.useMemo((()=>({basename:c,navigator:a,static:l,future:H({v7_relativeSplatPath:!1},u)})),[c,u,a,l]);"string"===typeof r&&(r=y(r));let{pathname:f="/",search:p="",hash:m="",state:g=null,key:v="default"}=r,_=s.useMemo((()=>{let e=L(f,c);return null==e?null:{location:{pathname:e,search:p,hash:m,state:g,key:v},navigationType:o}}),[c,f,p,m,g,v,o]);return null==_?null:s.createElement(Y.Provider,{value:h},s.createElement(J.Provider,{children:n,value:_}))}function _e(e){let{children:t,location:n}=e;return ie(we(t),n)}new Promise((()=>{}));s.Component;function we(e,t){void 0===t&&(t=[]);let n=[];return s.Children.forEach(e,((e,r)=>{if(!s.isValidElement(e))return;let i=[...t,r];if(e.type===s.Fragment)return void n.push.apply(n,we(e.props.children,i));e.type!==ye&&d(!1),e.props.index&&e.props.children&&d(!1);let o={id:e.props.id||i.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=we(e.props.children,i)),n.push(o)})),n}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);try{window.__reactRouterVersion="6"}catch(cx){}new Map;const be=o.startTransition;u.flushSync,o.useId;function Ie(e){let{basename:t,children:n,future:r,window:i}=e,o=s.useRef();var a;null==o.current&&(o.current=(void 0===(a={window:i,v5Compat:!0})&&(a={}),v((function(e,t){let{pathname:n,search:r,hash:i}=e.location;return m("",{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:g(t)}),null,a)));let l=o.current,[u,c]=s.useState({action:l.action,location:l.location}),{v7_startTransition:h}=r||{},d=s.useCallback((e=>{h&&be?be((()=>c(e))):c(e)}),[c,h]);return s.useLayoutEffect((()=>l.listen(d)),[l,d]),s.createElement(ve,{basename:t,children:n,location:u.location,navigationType:u.action,navigator:l,future:r})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var Ee,Se;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ee||(Ee={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Se||(Se={}));const Te=!1,Ce=!1,ke="${JSCORE_VERSION}",xe=function(e,t){if(!e)throw Ne(t)},Ne=function(e){return new Error("Firebase Database ("+ke+") INTERNAL ASSERT FAILED: "+e)},Pe=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},Ae={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,o=s?e[i+1]:0,a=i+2<e.length,l=a?e[i+2]:0,u=t>>2,c=(3&t)<<4|o>>4;let h=(15&o)<<2|l>>6,d=63&l;a||(d=64,s||(h=64)),r.push(n[u],n[c],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Pe(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const o=i<e.length?n[e.charAt(i)]:64;++i;const a=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==o||null==a)throw new Re;const l=t<<2|s>>4;if(r.push(l),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Re extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const De=function(e){const t=Pe(e);return Ae.encodeByteArray(t,!0)},Oe=function(e){return De(e).replace(/\./g,"")},Le=function(e){try{return Ae.decodeString(e,!0)}catch(cx){console.error("base64Decode failed: ",cx)}return null};function Me(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=Me(e[n],t[n]));return e}function Fe(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const Ue=()=>{try{return Fe().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/opensecurityroom",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(cx){return}const t=e&&Le(e[1]);return t&&JSON.parse(t)})()}catch(cx){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${cx}`)}},Ve=()=>{var e;return null===(e=Ue())||void 0===e?void 0:e.config};class qe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function ze(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Oe(JSON.stringify({alg:"none",type:"JWT"})),Oe(JSON.stringify(s)),""].join(".")}function je(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function Be(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(je())}function $e(){var e;const t=null===(e=Ue())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(cx){return!1}}function We(){return"undefined"!==typeof WorkerGlobalScope&&"undefined"!==typeof self&&self instanceof WorkerGlobalScope}function Ke(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function He(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function Ge(){const e=je();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function Qe(){return!0===Te||!0===Ce}function Ye(){return!$e()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Je(){try{return"object"===typeof indexedDB}catch(cx){return!1}}class Xe extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Xe.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ze.prototype.create)}}class Ze{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,r=this.errors[e],i=r?function(e,t){return e.replace(et,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(r,t):"Error",s=`${this.serviceName}: ${i} (${n}).`;return new Xe(n,s,t)}}const et=/\{\$([^}]+)}/g;function tt(e){return JSON.parse(e)}function nt(e){return JSON.stringify(e)}const rt=function(e){let t={},n={},r={},i="";try{const s=e.split(".");t=tt(Le(s[0])||""),n=tt(Le(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(cx){}return{header:t,claims:n,data:r,signature:i}};function it(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function st(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function ot(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function at(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function lt(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(ut(n)&&ut(s)){if(!lt(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function ut(e){return null!==e&&"object"===typeof e}function ct(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function ht(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function dt(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class ft{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"===typeof e)for(let c=0;c<16;c++)n[c]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let c=0;c<16;c++)n[c]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let c=16;c<80;c++){const e=n[c-3]^n[c-8]^n[c-14]^n[c-16];n[c]=4294967295&(e<<1|e>>>31)}let r,i,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],l=this.chain_[3],u=this.chain_[4];for(let c=0;c<80;c++){c<40?c<20?(r=l^o&(a^l),i=1518500249):(r=o^a^l,i=1859775393):c<60?(r=o&a|l&(o|a),i=2400959708):(r=o^a^l,i=3395469782);const e=(s<<5|s>>>27)+r+u+i+n[c]&4294967295;u=l,l=a,a=4294967295&(o<<30|o>>>2),o=s,s=e}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let s=this.inbuf_;for(;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"===typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let r=0;r<5;r++)for(let t=24;t>=0;t-=8)e[n]=this.chain_[r]>>t&255,++n;return e}}function pt(e,t){const n=new mt(e,t);return n.subscribe.bind(n)}class mt{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=gt),void 0===r.error&&(r.error=gt),void 0===r.complete&&(r.complete=gt);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(cx){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(cx){"undefined"!==typeof console&&console.error&&console.error(cx)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function gt(){}const yt=function(e,t,n,r){let i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i){throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")}};function vt(e,t){return`${e} failed: ${t} argument `}function _t(e,t,n,r){if((!r||n)&&"function"!==typeof n)throw new Error(vt(e,t)+"must be a valid function.")}function wt(e,t,n,r){if((!r||n)&&("object"!==typeof n||null===n))throw new Error(vt(e,t)+"must be a valid context object.")}const bt=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function It(e){return e&&e._delegate?e._delegate:e}class Et{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const St="[DEFAULT]";class Tt{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new qe;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(cx){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(cx){if(r)return null;throw cx}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:St})}catch(cx){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(cx){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:St;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:St;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:St;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===St?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(s){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:St;return this.component?this.component.multipleInstances?e:St:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Ct{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Tt(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const kt=[];var xt;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(xt||(xt={}));const Nt={debug:xt.DEBUG,verbose:xt.VERBOSE,info:xt.INFO,warn:xt.WARN,error:xt.ERROR,silent:xt.SILENT},Pt=xt.INFO,At={[xt.DEBUG]:"log",[xt.VERBOSE]:"log",[xt.INFO]:"info",[xt.WARN]:"warn",[xt.ERROR]:"error"},Rt=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=At[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];console[r](`[${n}]  ${e.name}:`,...s)};class Dt{constructor(e){this.name=e,this._logLevel=Pt,this._logHandler=Rt,this._userLogHandler=null,kt.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in xt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?Nt[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,xt.DEBUG,...t),this._logHandler(this,xt.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,xt.VERBOSE,...t),this._logHandler(this,xt.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,xt.INFO,...t),this._logHandler(this,xt.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,xt.WARN,...t),this._logHandler(this,xt.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,xt.ERROR,...t),this._logHandler(this,xt.ERROR,...t)}}let Ot,Lt;const Mt=new WeakMap,Ft=new WeakMap,Ut=new WeakMap,Vt=new WeakMap,qt=new WeakMap;let zt={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Ft.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Ut.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return $t(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function jt(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Lt||(Lt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(Wt(this),n),$t(Mt.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return $t(e.apply(Wt(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call(Wt(this),t,...r);return Ut.set(s,t.sort?t.sort():[t]),$t(s)}}function Bt(e){return"function"===typeof e?jt(e):(e instanceof IDBTransaction&&function(e){if(Ft.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));Ft.set(e,t)}(e),t=e,(Ot||(Ot=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,zt):e);var t}function $t(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t($t(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&Mt.set(t,e)})).catch((()=>{})),qt.set(t,e),t}(e);if(Vt.has(e))return Vt.get(e);const t=Bt(e);return t!==e&&(Vt.set(e,t),qt.set(t,e)),t}const Wt=e=>qt.get(e);const Kt=["get","getKey","getAll","getAllKeys","count"],Ht=["put","add","delete","clear"],Gt=new Map;function Qt(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(Gt.get(t))return Gt.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Ht.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Kt.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return r&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),i&&t.done]))[0]};return Gt.set(t,s),s}zt=(e=>({...e,get:(t,n,r)=>Qt(t,n)||e.get(t,n,r),has:(t,n)=>!!Qt(t,n)||e.has(t,n)}))(zt);class Yt{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const Jt="@firebase/app",Xt="0.10.12",Zt=new Dt("@firebase/app"),en="@firebase/app-compat",tn="@firebase/analytics-compat",nn="@firebase/analytics",rn="@firebase/app-check-compat",sn="@firebase/app-check",on="@firebase/auth",an="@firebase/auth-compat",ln="@firebase/database",un="@firebase/data-connect",cn="@firebase/database-compat",hn="@firebase/functions",dn="@firebase/functions-compat",fn="@firebase/installations",pn="@firebase/installations-compat",mn="@firebase/messaging",gn="@firebase/messaging-compat",yn="@firebase/performance",vn="@firebase/performance-compat",_n="@firebase/remote-config",wn="@firebase/remote-config-compat",bn="@firebase/storage",In="@firebase/storage-compat",En="@firebase/firestore",Sn="@firebase/vertexai-preview",Tn="@firebase/firestore-compat",Cn="firebase",kn="[DEFAULT]",xn={[Jt]:"fire-core",[en]:"fire-core-compat",[nn]:"fire-analytics",[tn]:"fire-analytics-compat",[sn]:"fire-app-check",[rn]:"fire-app-check-compat",[on]:"fire-auth",[an]:"fire-auth-compat",[ln]:"fire-rtdb",[un]:"fire-data-connect",[cn]:"fire-rtdb-compat",[hn]:"fire-fn",[dn]:"fire-fn-compat",[fn]:"fire-iid",[pn]:"fire-iid-compat",[mn]:"fire-fcm",[gn]:"fire-fcm-compat",[yn]:"fire-perf",[vn]:"fire-perf-compat",[_n]:"fire-rc",[wn]:"fire-rc-compat",[bn]:"fire-gcs",[In]:"fire-gcs-compat",[En]:"fire-fst",[Tn]:"fire-fst-compat",[Sn]:"fire-vertex","fire-js":"fire-js",[Cn]:"fire-js-all"},Nn=new Map,Pn=new Map,An=new Map;function Rn(e,t){try{e.container.addComponent(t)}catch(cx){Zt.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,cx)}}function Dn(e,t){e.container.addOrOverwriteComponent(t)}function On(e){const t=e.name;if(An.has(t))return Zt.debug(`There were multiple attempts to register component ${t}.`),!1;An.set(t,e);for(const n of Nn.values())Rn(n,e);for(const n of Pn.values())Rn(n,e);return!0}function Ln(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Mn(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:kn;Ln(e,t).clearInstance(n)}function Fn(e){return void 0!==e.options}function Un(e){return void 0!==e.settings}function Vn(){An.clear()}const qn=new Ze("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class zn{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Et("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qn.create("app-deleted",{appName:this._name})}}class jn extends zn{constructor(e,t,n,r){const i=void 0!==t.automaticDataCollectionEnabled&&t.automaticDataCollectionEnabled,s={name:n,automaticDataCollectionEnabled:i};if(void 0!==e.apiKey)super(e,s,r);else{super(e.options,s,r)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:i},t),this._finalizationRegistry=null,"undefined"!==typeof FinalizationRegistry&&(this._finalizationRegistry=new FinalizationRegistry((()=>{this.automaticCleanup()}))),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,Qn(Jt,Xt,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,void 0!==e&&null!==this._finalizationRegistry&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Gn(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw qn.create("server-app-deleted")}}const Bn="10.14.0";function $n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:kn,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!==typeof i||!i)throw qn.create("bad-app-name",{appName:String(i)});if(n||(n=Ve()),!n)throw qn.create("no-options");const s=Nn.get(i);if(s){if(lt(n,s.options)&&lt(r,s.config))return s;throw qn.create("duplicate-app",{appName:i})}const o=new Ct(i);for(const l of An.values())o.addComponent(l);const a=new zn(n,r,o);return Nn.set(i,a),a}function Wn(e,t){if(("undefined"!==typeof window||We())&&!We())throw qn.create("invalid-server-app-environment");let n;void 0===t.automaticDataCollectionEnabled&&(t.automaticDataCollectionEnabled=!1),n=Fn(e)?e.options:e;const r=Object.assign(Object.assign({},t),n);void 0!==r.releaseOnDeref&&delete r.releaseOnDeref;if(void 0!==t.releaseOnDeref&&"undefined"===typeof FinalizationRegistry)throw qn.create("finalization-registry-not-supported",{});const i=""+(s=JSON.stringify(r),[...s].reduce(((e,t)=>Math.imul(31,e)+t.charCodeAt(0)|0),0));var s;const o=Pn.get(i);if(o)return o.incRefCount(t.releaseOnDeref),o;const a=new Ct(i);for(const u of An.values())a.addComponent(u);const l=new jn(n,t,i,a);return Pn.set(i,l),l}function Kn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kn;const t=Nn.get(e);if(!t&&e===kn&&Ve())return $n();if(!t)throw qn.create("no-app",{appName:e});return t}function Hn(){return Array.from(Nn.values())}async function Gn(e){let t=!1;const n=e.name;if(Nn.has(n))t=!0,Nn.delete(n);else if(Pn.has(n)){e.decRefCount()<=0&&(Pn.delete(n),t=!0)}t&&(await Promise.all(e.container.getProviders().map((e=>e.delete()))),e.isDeleted=!0)}function Qn(e,t,n){var r;let i=null!==(r=xn[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Zt.warn(e.join(" "))}On(new Et(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}function Yn(e,t){if(null!==e&&"function"!==typeof e)throw qn.create("invalid-log-argument");!function(e,t){for(const n of kt){let r=null;t&&t.level&&(r=Nt[t.level]),n.userLogHandler=null===e?null:function(t,n){for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];const a=s.map((e=>{if(null==e)return null;if("string"===typeof e)return e;if("number"===typeof e||"boolean"===typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}})).filter((e=>e)).join(" ");n>=(null!==r&&void 0!==r?r:t.logLevel)&&e({level:xt[n].toLowerCase(),message:a,args:s,type:t.name})}}}(e,t)}function Jn(e){var t;t=e,kt.forEach((e=>{e.setLogLevel(t)}))}const Xn="firebase-heartbeat-store";let Zn=null;function er(){return Zn||(Zn=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(e,t),a=$t(o);return r&&o.addEventListener("upgradeneeded",(e=>{r($t(o.result),e.oldVersion,e.newVersion,$t(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Xn)}catch(cx){console.warn(cx)}}}).catch((e=>{throw qn.create("idb-open",{originalErrorMessage:e.message})}))),Zn}async function tr(e,t){try{const n=(await er()).transaction(Xn,"readwrite"),r=n.objectStore(Xn);await r.put(t,nr(e)),await n.done}catch(cx){if(cx instanceof Xe)Zt.warn(cx.message);else{const t=qn.create("idb-set",{originalErrorMessage:null===cx||void 0===cx?void 0:cx.message});Zt.warn(t.message)}}}function nr(e){return`${e.name}!${e.options.appId}`}class rr{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new sr(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=ir();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return;return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}catch(cx){Zt.warn(cx)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=ir(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),or(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),or(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=Oe(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(cx){return Zt.warn(cx),""}}}function ir(){return(new Date).toISOString().substring(0,10)}class sr{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!Je()&&new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(kb){t(kb)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await er()).transaction(Xn),n=await t.objectStore(Xn).get(nr(e));return await t.done,n}catch(cx){if(cx instanceof Xe)Zt.warn(cx.message);else{const t=qn.create("idb-get",{originalErrorMessage:null===cx||void 0===cx?void 0:cx.message});Zt.warn(t.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return tr(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return tr(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function or(e){return Oe(JSON.stringify({version:2,heartbeats:e})).length}var ar;ar="",On(new Et("platform-logger",(e=>new Yt(e)),"PRIVATE")),On(new Et("heartbeat",(e=>new rr(e)),"PRIVATE")),Qn(Jt,Xt,ar),Qn(Jt,Xt,"esm2017"),Qn("fire-js","");class lr{constructor(e,t){this._delegate=e,this.firebase=t,Rn(e,new Et("app-compat",(()=>this),"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise((e=>{this._delegate.checkDestroyed(),e()})).then((()=>(this.firebase.INTERNAL.removeApp(this.name),Gn(this._delegate))))}_getService(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kn;var n;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kn;this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Rn(this._delegate,e)}_addOrOverwriteComponent(e){Dn(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const ur=new Ze("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."});const cr=function e(){const t=function(e){const t={},n={__esModule:!0,initializeApp:function(r){const i=$n(r,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});if(it(t,i.name))return t[i.name];const s=new e(i,n);return t[i.name]=s,s},app:i,registerVersion:Qn,setLogLevel:Jn,onLog:Yn,apps:null,SDK_VERSION:Bn,INTERNAL:{registerComponent:function(t){const r=t.name,s=r.replace("-compat","");if(On(t)&&"PUBLIC"===t.type){const o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i();if("function"!==typeof e[s])throw ur.create("invalid-app-argument",{appName:r});return e[s]()};void 0!==t.serviceProps&&Me(o,t.serviceProps),n[s]=o,e.prototype[s]=function(){const e=this._getService.bind(this,r);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return e.apply(this,t.multipleInstances?i:[])}}return"PUBLIC"===t.type?n[s]:null},removeApp:function(e){delete t[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:r}};function i(e){if(!it(t,e=e||kn))throw ur.create("no-app",{appName:e});return t[e]}return n.default=n,Object.defineProperty(n,"apps",{get:function(){return Object.keys(t).map((e=>t[e]))}}),i.App=e,n}(lr);return t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){Me(t,e)},createSubscribe:pt,ErrorFactory:Ze,deepExtend:Me}),t}(),hr=new Dt("@firebase/app-compat");try{const e=Fe();if(void 0!==e.firebase){hr.warn("\n      Warning: Firebase is already defined in the global scope. Please make sure\n      Firebase library is only loaded once.\n    ");const t=e.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&hr.warn("\n        Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n        ")}}catch(hx){}const dr=cr;!function(e){Qn("@firebase/app-compat","0.2.42",e)}();dr.registerVersion("firebase","10.14.0","app-compat");function fr(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;const pr="facebook.com",mr="github.com",gr="google.com",yr="password",vr="twitter.com",_r="EMAIL_SIGNIN",wr="PASSWORD_RESET",br="RECOVER_EMAIL",Ir="REVERT_SECOND_FACTOR_ADDITION",Er="VERIFY_AND_CHANGE_EMAIL",Sr="VERIFY_EMAIL";function Tr(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Cr=function(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}},kr=Tr,xr=new Ze("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Nr=new Dt("@firebase/auth");function Pr(e){if(Nr.logLevel<=xt.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Nr.error(`Auth (${Bn}): ${e}`,...n)}}function Ar(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Mr(e,...n)}function Rr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Mr(e,...n)}function Dr(e,t,n){const r=Object.assign(Object.assign({},kr()),{[t]:n});return new Ze("auth","Firebase",r).create(t,{appName:e.name})}function Or(e){return Dr(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Lr(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&Ar(e,"argument-error"),Dr(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Mr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return xr.create(e,...n)}function Fr(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw Mr(t,...r)}}function Ur(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Pr(t),new Error(t)}function Vr(e,t){e||Ur(t)}function qr(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function zr(){return"http:"===jr()||"https:"===jr()}function jr(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class Br{constructor(e,t){this.shortDelay=e,this.longDelay=t,Vr(t>e,"Short delay should be less than long delay!"),this.isMobile=Be()||He()}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(zr()||Ke()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function $r(e,t){Vr(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class Wr{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void Ur("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void Ur("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void Ur("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Kr={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Hr=new Br(3e4,6e4);function Gr(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Qr(e,t,n,r){return Yr(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=ct(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:a},i);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),Wr.fetch()(Xr(e,e.config.apiHost,n,o),l)}))}async function Yr(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Kr),t);try{const t=new ei(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw ti(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw ti(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw ti(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw ti(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw Dr(e,a,o);Ar(e,a)}}catch(cx){if(cx instanceof Xe)throw cx;Ar(e,"network-request-failed",{message:String(cx)})}}async function Jr(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await Qr(e,t,n,r,i);return"mfaPendingCredential"in s&&Ar(e,"multi-factor-auth-required",{_serverResponse:s}),s}function Xr(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?$r(e.config,i):`${e.config.apiScheme}://${i}`}function Zr(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class ei{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(Rr(this.auth,"network-request-failed"))),Hr.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function ti(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Rr(e,t,r);return i.customData._tokenResponse=n,i}function ni(e){return void 0!==e&&void 0!==e.getResponse}function ri(e){return void 0!==e&&void 0!==e.enterprise}class ii{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Zr(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function si(e,t){return Qr(e,"GET","/v2/recaptchaConfig",Gr(e,t))}async function oi(e,t){return Qr(e,"POST","/v1/accounts:lookup",t)}function ai(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(cx){}}function li(e){return 1e3*Number(e)}function ui(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Pr("JWT malformed, contained fewer than 3 sections"),null;try{const e=Le(n);return e?JSON.parse(e):(Pr("Failed to decode base64 JWT payload"),null)}catch(cx){return Pr("Caught error parsing JWT payload as JSON",null===cx||void 0===cx?void 0:cx.toString()),null}}function ci(e){const t=ui(e);return Fr(t,"internal-error"),Fr("undefined"!==typeof t.exp,"internal-error"),Fr("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function hi(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(cx){throw cx instanceof Xe&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(cx)&&e.auth.currentUser===e&&await e.auth.signOut(),cx}}class di{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(cx){return void("auth/network-request-failed"===(null===cx||void 0===cx?void 0:cx.code)&&this.schedule(!0))}this.schedule()}}class fi{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ai(this.lastLoginAt),this.creationTime=ai(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function pi(e){var t;const n=e.auth,r=await e.getIdToken(),i=await hi(e,oi(n,{idToken:r}));Fr(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?mi(s.providerUserInfo):[],a=(l=e.providerData,u=o,[...l.filter((e=>!u.some((t=>t.providerId===e.providerId)))),...u]);var l,u;const c=e.isAnonymous,h=!(e.email&&s.passwordHash)&&!(null===a||void 0===a?void 0:a.length),d=!!c&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new fi(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)}function mi(e){return e.map((e=>{var{providerId:t}=e,n=fr(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class gi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Fr(e.idToken,"internal-error"),Fr("undefined"!==typeof e.idToken,"internal-error"),Fr("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):ci(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Fr(0!==e.length,"internal-error");const t=ci(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(Fr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await Yr(e,{},(async()=>{const n=ct({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=Xr(e,r,"/v1/token",`key=${i}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Wr.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new gi;return n&&(Fr("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(Fr("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(Fr("number"===typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new gi,this.toJSON())}_performRefresh(){return Ur("not implemented")}}function yi(e,t){Fr("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class vi{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=fr(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new di(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new fi(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await hi(this,this.stsTokenManager.getToken(this.auth,e));return Fr(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=It(e),r=await n.getIdToken(t),i=ui(r);Fr(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"===typeof i.firebase?i.firebase:void 0,o=null===s||void 0===s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:ai(li(i.auth_time)),issuedAtTime:ai(li(i.iat)),expirationTime:ai(li(i.exp)),signInProvider:o||null,signInSecondFactor:(null===s||void 0===s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=It(e);await pi(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Fr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new vi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Fr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await pi(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Un(this.auth.app))return Promise.reject(Or(this.auth));const e=await this.getIdToken();return await hi(this,async function(e,t){return Qr(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,l,u;const c=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,y=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:_,isAnonymous:w,providerData:b,stsTokenManager:I}=t;Fr(v&&I,e,"internal-error");const E=gi.fromJSON(this.name,I);Fr("string"===typeof v,e,"internal-error"),yi(c,e.name),yi(h,e.name),Fr("boolean"===typeof _,e,"internal-error"),Fr("boolean"===typeof w,e,"internal-error"),yi(d,e.name),yi(f,e.name),yi(p,e.name),yi(m,e.name),yi(g,e.name),yi(y,e.name);const S=new vi({uid:v,auth:e,email:h,emailVerified:_,displayName:c,isAnonymous:w,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:E,createdAt:g,lastLoginAt:y});return b&&Array.isArray(b)&&(S.providerData=b.map((e=>Object.assign({},e)))),m&&(S._redirectEventId=m),S}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new gi;r.updateFromServerResponse(t);const i=new vi({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await pi(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];Fr(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?mi(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length),o=new gi;o.updateFromIdToken(n);const a=new vi({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:s}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new fi(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length)};return Object.assign(a,l),a}}const _i=new Map;function wi(e){Vr(e instanceof Function,"Expected a class definition");let t=_i.get(e);return t?(Vr(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,_i.set(e,t),t)}class bi{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}bi.type="NONE";const Ii=bi;function Ei(e,t,n){return`firebase:${e}:${t}:${n}`}class Si{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=Ei(this.userKey,r.apiKey,i),this.fullPersistenceKey=Ei("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?vi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new Si(wi(Ii),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||wi(Ii);const s=Ei(n,e.config.apiKey,e.name);let o=null;for(const l of t)try{const t=await l._get(s);if(t){const n=vi._fromJSON(e,t);l!==i&&(o=n),i=l;break}}catch(hx){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(s)}catch(hx){}}))),new Si(i,e,n)):new Si(i,e,n)}}function Ti(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Ni(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Ci(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Ai(t))return"Blackberry";if(Ri(t))return"Webos";if(ki(t))return"Safari";if((t.includes("chrome/")||xi(t))&&!t.includes("edge/"))return"Chrome";if(Pi(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function Ci(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je();return/firefox\//i.test(e)}function ki(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:je()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function xi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je();return/crios\//i.test(e)}function Ni(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je();return/iemobile/i.test(e)}function Pi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je();return/android/i.test(e)}function Ai(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je();return/blackberry/i.test(e)}function Ri(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je();return/webos/i.test(e)}function Di(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Oi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je();return Di(e)||Pi(e)||Ri(e)||Ai(e)||/windows phone/i.test(e)||Ni(e)}function Li(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Ti(je());break;case"Worker":t=`${Ti(je())}-${e}`;break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${Bn}/${r}`}class Mi{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(cx){r(cx)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(cx){t.reverse();for(const r of t)try{r()}catch(n){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===cx||void 0===cx?void 0:cx.message})}}}class Fi{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class Ui{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new qi(this),this.idTokenSubscription=new qi(this),this.beforeStateQueue=new Mi(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=xr,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=wi(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await Si.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(cx){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await oi(this,{idToken:e}),n=await vi._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Un(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null===r||void 0===r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null===o||void 0===o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(cx){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(cx)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Fr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(cx){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await pi(e)}catch(cx){if("auth/network-request-failed"!==(null===cx||void 0===cx?void 0:cx.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Un(this.app))return Promise.reject(Or(this));const t=e?It(e):null;return t&&Fr(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&Fr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return Un(this.app)?Promise.reject(Or(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Un(this.app)?Promise.reject(Or(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(wi(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return Qr(e,"GET","/v2/passwordPolicy",Gr(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new Fi(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ze("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Qr(e,"POST","/v2/accounts:revokeToken",Gr(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&wi(e)||this._popupRedirectResolver;Fr(t,this,"argument-error"),this.redirectPersistenceManager=await Si.create(this,[wi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Fr(o,this,"internal-error"),o.then((()=>{s||i(this.currentUser)})),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Fr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Li(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(Nr.logLevel<=xt.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Nr.warn(`Auth (${Bn}): ${e}`,...n)}}(`Error while retrieving App Check token: ${t.error}`),null===t||void 0===t?void 0:t.token}}function Vi(e){return It(e)}class qi{constructor(e){this.auth=e,this.observer=null,this.addObserver=pt((e=>this.observer=e))}get next(){return Fr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let zi={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ji(e){return zi.loadJS(e)}function Bi(e){return`__${e}${Math.floor(1e6*Math.random())}`}class $i{constructor(e){this.type="recaptcha-enterprise",this.auth=Vi(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;ri(i)?i.enterprise.ready((()=>{i.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{si(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new ii(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((i=>{if(!t&&ri(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=zi.recaptchaEnterpriseScript;0!==t.length&&(t+=i),ji(t).then((()=>{n(i,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function Wi(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=new $i(e);let s;try{s=await i.verify(n)}catch(kb){s=await i.verify(n,!0)}const o=Object.assign({},t);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Ki(e,t,n,r){var i;if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Wi(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch((async i=>{if("auth/missing-recaptcha-token"===i.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await Wi(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)}))}function Hi(e,t,n){const r=Vi(e);Fr(r._canInitEmulator,r,"emulator-config-failed"),Fr(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null===n||void 0===n?void 0:n.disableWarnings),s=Gi(t),{host:o,port:a}=function(e){const t=Gi(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:Qi(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Qi(t)}}}(t),l=null===a?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Gi(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Qi(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Yi{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ur("not implemented")}_getIdTokenResponse(e){return Ur("not implemented")}_linkToIdToken(e,t){return Ur("not implemented")}_getReauthenticationResolver(e){return Ur("not implemented")}}async function Ji(e,t){return Qr(e,"POST","/v1/accounts:resetPassword",Gr(e,t))}async function Xi(e,t){return Qr(e,"POST","/v1/accounts:signUp",t)}async function Zi(e,t){return Jr(e,"POST","/v1/accounts:signInWithPassword",Gr(e,t))}async function es(e,t){return Qr(e,"POST","/v1/accounts:sendOobCode",Gr(e,t))}async function ts(e,t){return es(e,t)}async function ns(e,t){return es(e,t)}class rs extends Yi{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new rs(e,t,"password")}static _fromEmailAndCode(e,t){return new rs(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Ki(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Zi);case"emailLink":return async function(e,t){return Jr(e,"POST","/v1/accounts:signInWithEmailLink",Gr(e,t))}(e,{email:this._email,oobCode:this._password});default:Ar(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Ki(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Xi);case"emailLink":return async function(e,t){return Jr(e,"POST","/v1/accounts:signInWithEmailLink",Gr(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Ar(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function is(e,t){return Jr(e,"POST","/v1/accounts:signInWithIdp",Gr(e,t))}class ss extends Yi{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ss(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ar("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=fr(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new ss(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return is(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,is(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,is(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ct(t)}return e}}const os={USER_NOT_FOUND:"user-not-found"};class as extends Yi{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new as({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new as({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Jr(e,"POST","/v1/accounts:signInWithPhoneNumber",Gr(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Jr(e,"POST","/v1/accounts:signInWithPhoneNumber",Gr(e,t));if(n.temporaryProof)throw ti(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Jr(e,"POST","/v1/accounts:signInWithPhoneNumber",Gr(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),os)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new as({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class ls{constructor(e){var t,n,r,i,s,o;const a=ht(dt(e)),l=null!==(t=a.apiKey)&&void 0!==t?t:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,c=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);Fr(l&&u&&c,"argument-error"),this.apiKey=l,this.operation=c,this.code=u,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=ht(dt(e)).link,n=t?ht(dt(t)).deep_link_id:null,r=ht(dt(e)).deep_link_id;return(r?ht(dt(r)).link:null)||r||n||t||e}(e);try{return new ls(t)}catch(hx){return null}}}class us{constructor(){this.providerId=us.PROVIDER_ID}static credential(e,t){return rs._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=ls.parseLink(t);return Fr(n,"argument-error"),rs._fromEmailAndCode(e,n.code,n.tenantId)}}us.PROVIDER_ID="password",us.EMAIL_PASSWORD_SIGN_IN_METHOD="password",us.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class cs{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class hs extends cs{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ds extends hs{static credentialFromJSON(e){const t="string"===typeof e?JSON.parse(e):e;return Fr("providerId"in t&&"signInMethod"in t,"argument-error"),ss._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return Fr(e.idToken||e.accessToken,"argument-error"),ss._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return ds.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return ds.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=t;if(!r&&!i&&!n&&!s)return null;if(!a)return null;try{return new ds(a)._credential({idToken:n,accessToken:r,nonce:o,pendingToken:s})}catch(cx){return null}}}class fs extends hs{constructor(){super("facebook.com")}static credential(e){return ss._fromParams({providerId:fs.PROVIDER_ID,signInMethod:fs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return fs.credentialFromTaggedObject(e)}static credentialFromError(e){return fs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return fs.credential(t.oauthAccessToken)}catch(hx){return null}}}fs.FACEBOOK_SIGN_IN_METHOD="facebook.com",fs.PROVIDER_ID="facebook.com";class ps extends hs{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ss._fromParams({providerId:ps.PROVIDER_ID,signInMethod:ps.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ps.credentialFromTaggedObject(e)}static credentialFromError(e){return ps.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return ps.credential(n,r)}catch(hx){return null}}}ps.GOOGLE_SIGN_IN_METHOD="google.com",ps.PROVIDER_ID="google.com";class ms extends hs{constructor(){super("github.com")}static credential(e){return ss._fromParams({providerId:ms.PROVIDER_ID,signInMethod:ms.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ms.credentialFromTaggedObject(e)}static credentialFromError(e){return ms.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return ms.credential(t.oauthAccessToken)}catch(hx){return null}}}ms.GITHUB_SIGN_IN_METHOD="github.com",ms.PROVIDER_ID="github.com";class gs extends Yi{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return is(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,is(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,is(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,pendingToken:i}=t;return n&&r&&i&&n===r?new gs(n,i):null}static _create(e,t){return new gs(e,t)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class ys extends cs{constructor(e){Fr(e.startsWith("saml."),"argument-error"),super(e)}static credentialFromResult(e){return ys.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return ys.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=gs.fromJSON(e);return Fr(t,"argument-error"),t}static samlCredentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{pendingToken:n,providerId:r}=t;if(!n||!r)return null;try{return gs._create(r,n)}catch(cx){return null}}}class vs extends hs{constructor(){super("twitter.com")}static credential(e,t){return ss._fromParams({providerId:vs.PROVIDER_ID,signInMethod:vs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return vs.credentialFromTaggedObject(e)}static credentialFromError(e){return vs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return vs.credential(n,r)}catch(hx){return null}}}async function _s(e,t){return Jr(e,"POST","/v1/accounts:signUp",Gr(e,t))}vs.TWITTER_SIGN_IN_METHOD="twitter.com",vs.PROVIDER_ID="twitter.com";class ws{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await vi._fromIdTokenResponse(e,n,r),s=bs(n);return new ws({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=bs(n);return new ws({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function bs(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Is extends Xe{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Is.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Is(e,t,n,r)}}function Es(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Is._fromErrorAndOperation(e,n,t,r);throw n}))}function Ss(e){return new Set(e.map((e=>{let{providerId:t}=e;return t})).filter((e=>!!e)))}async function Ts(e,t){const n=It(e);await ks(!0,n,t);const{providerUserInfo:r}=await async function(e,t){return Qr(e,"POST","/v1/accounts:update",t)}(n.auth,{idToken:await n.getIdToken(),deleteProvider:[t]}),i=Ss(r||[]);return n.providerData=n.providerData.filter((e=>i.has(e.providerId))),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function Cs(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await hi(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return ws._forOperation(e,"link",r)}async function ks(e,t,n){await pi(t);const r=!1===e?"provider-already-linked":"no-such-provider";Fr(Ss(t.providerData).has(n)===e,t.auth,r)}async function xs(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(Un(r.app))return Promise.reject(Or(r));const i="reauthenticate";try{const s=await hi(e,Es(r,i,t,e),n);Fr(s.idToken,r,"internal-error");const o=ui(s.idToken);Fr(o,r,"internal-error");const{sub:a}=o;return Fr(e.uid===a,r,"user-mismatch"),ws._forOperation(e,i,s)}catch(cx){throw"auth/user-not-found"===(null===cx||void 0===cx?void 0:cx.code)&&Ar(r,"user-mismatch"),cx}}async function Ns(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Un(e.app))return Promise.reject(Or(e));const r="signIn",i=await Es(e,r,t),s=await ws._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function Ps(e,t){return Ns(Vi(e),t)}async function As(e,t){const n=It(e);return await ks(!1,n,t.providerId),Cs(n,t)}async function Rs(e,t){return xs(It(e),t)}async function Ds(e,t){if(Un(e.app))return Promise.reject(Or(e));const n=Vi(e),r=await async function(e,t){return Jr(e,"POST","/v1/accounts:signInWithCustomToken",Gr(e,t))}(n,{token:t,returnSecureToken:!0}),i=await ws._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}class Os{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?Ls._fromServerResponse(e,t):"totpInfo"in t?Ms._fromServerResponse(e,t):Ar(e,"internal-error")}}class Ls extends Os{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new Ls(t)}}class Ms extends Os{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Ms(t)}}function Fs(e,t,n){var r;Fr((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),Fr("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Fr(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(Fr(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function Us(e){const t=Vi(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function Vs(e,t){await async function(e,t){return Qr(e,"POST","/v1/accounts:update",Gr(e,t))}(It(e),{oobCode:t})}async function qs(e,t){const n=It(e),r=await Ji(n,{oobCode:t}),i=r.requestType;switch(Fr(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Fr(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Fr(r.mfaInfo,n,"internal-error");default:Fr(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=Os._fromServerResponse(Vi(n),r.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.newEmail:r.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function zs(e,t){const n={identifier:t,continueUri:zr()?qr():"http://localhost"},{signinMethods:r}=await async function(e,t){return Qr(e,"POST","/v1/accounts:createAuthUri",Gr(e,t))}(It(e),n);return r||[]}async function js(e,t){const n=It(e),r={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&Fs(n.auth,r,t);const{email:i}=await async function(e,t){return es(e,t)}(n.auth,r);i!==e.email&&await e.reload()}async function Bs(e,t,n){const r=It(e),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await e.getIdToken(),newEmail:t};n&&Fs(r.auth,i,n);const{email:s}=await async function(e,t){return es(e,t)}(r.auth,i);s!==e.email&&await e.reload()}async function $s(e,t){let{displayName:n,photoURL:r}=t;if(void 0===n&&void 0===r)return;const i=It(e),s={idToken:await i.getIdToken(),displayName:n,photoUrl:r,returnSecureToken:!0},o=await hi(i,async function(e,t){return Qr(e,"POST","/v1/accounts:update",t)}(i.auth,s));i.displayName=o.displayName||null,i.photoURL=o.photoUrl||null;const a=i.providerData.find((e=>{let{providerId:t}=e;return"password"===t}));a&&(a.displayName=i.displayName,a.photoURL=i.photoURL),await i._updateTokensIfNecessary(o)}async function Ws(e,t,n){const{auth:r}=e,i={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(i.email=t),n&&(i.password=n);const s=await hi(e,async function(e,t){return Qr(e,"POST","/v1/accounts:update",t)}(r,i));await e._updateTokensIfNecessary(s,!0)}class Ks{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.isNewUser=e,this.providerId=t,this.profile=n}}class Hs extends Ks{constructor(e,t,n,r){super(e,t,n),this.username=r}}class Gs extends Ks{constructor(e,t){super(e,"facebook.com",t)}}class Qs extends Hs{constructor(e,t){super(e,"github.com",t,"string"===typeof(null===t||void 0===t?void 0:t.login)?null===t||void 0===t?void 0:t.login:null)}}class Ys extends Ks{constructor(e,t){super(e,"google.com",t)}}class Js extends Hs{constructor(e,t,n){super(e,"twitter.com",t,n)}}function Xs(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;const{providerId:r}=e,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},s=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null===e||void 0===e?void 0:e.idToken)){const r=null===(n=null===(t=ui(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(r)return new Ks(s,"anonymous"!==r&&"custom"!==r?r:null)}if(!r)return null;switch(r){case"facebook.com":return new Gs(s,i);case"github.com":return new Qs(s,i);case"google.com":return new Ys(s,i);case"twitter.com":return new Js(s,i,e.screenName||null);case"custom":case"anonymous":return new Ks(s,null);default:return new Ks(s,r,i)}}(n)}class Zs{constructor(e,t,n){this.type=e,this.credential=t,this.user=n}static _fromIdtoken(e,t){return new Zs("enroll",e,t)}static _fromMfaPendingCredential(e){return new Zs("signin",e)}toJSON(){const e="enroll"===this.type?"idToken":"pendingCredential";return{multiFactorSession:{[e]:this.credential}}}static fromJSON(e){var t,n;if(null===e||void 0===e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return Zs._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return Zs._fromIdtoken(e.multiFactorSession.idToken)}return null}}class eo{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=Vi(e),r=t.customData._serverResponse,i=(r.mfaInfo||[]).map((e=>Os._fromServerResponse(n,e)));Fr(r.mfaPendingCredential,n,"internal-error");const s=Zs._fromMfaPendingCredential(r.mfaPendingCredential);return new eo(s,i,(async e=>{const i=await e._process(n,s);delete r.mfaInfo,delete r.mfaPendingCredential;const o=Object.assign(Object.assign({},r),{idToken:i.idToken,refreshToken:i.refreshToken});switch(t.operationType){case"signIn":const e=await ws._fromIdTokenResponse(n,t.operationType,o);return await n._updateCurrentUser(e.user),e;case"reauthenticate":return Fr(t.user,n,"internal-error"),ws._forOperation(t.user,t.operationType,o);default:Ar(n,"internal-error")}}))}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}class to{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload((t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map((t=>Os._fromServerResponse(e.auth,t))))}))}static _fromUser(e){return new to(e)}async getSession(){return Zs._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const n=e,r=await this.getSession(),i=await hi(this.user,n._process(this.user.auth,r,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const t="string"===typeof e?e:e.uid,n=await this.user.getIdToken();try{const e=await hi(this.user,function(e,t){return Qr(e,"POST","/v2/accounts/mfaEnrollment:withdraw",Gr(e,t))}(this.user.auth,{idToken:n,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter((e=>{let{uid:n}=e;return n!==t})),await this.user._updateTokensIfNecessary(e),await this.user.reload()}catch(cx){throw cx}}}const no=new WeakMap;const ro="__sak";class io{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ro,"1"),this.storage.removeItem(ro),Promise.resolve(!0)):Promise.resolve(!1)}catch(hx){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class so extends io{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Oi(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);Ge()&&10===document.documentMode&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}so.type="LOCAL";const oo=so;class ao extends io{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ao.type="SESSION";const lo=ao;class uo{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new uo(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function co(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}uo.receivers=[];class ho{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const l=co("",20);r.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(u),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(u),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function fo(){return window}function po(){return"undefined"!==typeof fo().WorkerGlobalScope&&"function"===typeof fo().importScripts}const mo="firebaseLocalStorageDb",go="firebaseLocalStorage",yo="fbase_key";class vo{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function _o(e,t){return e.transaction([go],t?"readwrite":"readonly").objectStore(go)}function wo(){const e=indexedDB.open(mo,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(go,{keyPath:yo})}catch(cx){n(cx)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(go)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(mo);return new vo(e).toPromise()}(),t(await wo()))}))}))}async function bo(e,t,n){const r=_o(e,!0).put({[yo]:t,value:n});return new vo(r).toPromise()}function Io(e,t){const n=_o(e,!0).delete(t);return new vo(n).toPromise()}class Eo{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await wo()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(cx){if(t++>3)throw cx;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return po()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=uo._getInstance(po()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new ho(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(hx){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await wo();return await bo(e,ro,"1"),await Io(e,ro),!0}catch(hx){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>bo(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=_o(e,!1).get(t),r=await new vo(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Io(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=_o(e,!1).getAll();return new vo(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Eo.type="LOCAL";const So=Eo;const To=1e12;class Co{constructor(e){this.auth=e,this.counter=To,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new ko(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||To;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||To;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||To;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class ko{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r="string"===typeof e?document.getElementById(e):e;Fr(r,"argument-error",{appName:t}),this.container=r,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((()=>{this.responseToken=function(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(cx){}this.timerId=window.setTimeout((()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(cx){}this.isVisible&&this.execute()}),6e4)}),500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const xo=Bi("rcb"),No=new Br(3e4,6e4);class Po{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(e=fo().grecaptcha)||void 0===e?void 0:e.render)}load(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Fr(function(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}(t),e,"argument-error"),this.shouldResolveImmediately(t)&&ni(fo().grecaptcha)?Promise.resolve(fo().grecaptcha):new Promise(((n,r)=>{const i=fo().setTimeout((()=>{r(Rr(e,"network-request-failed"))}),No.get());fo()[xo]=()=>{fo().clearTimeout(i),delete fo()[xo];const s=fo().grecaptcha;if(!s||!ni(s))return void r(Rr(e,"internal-error"));const o=s.render;s.render=(e,t)=>{const n=o(e,t);return this.counter++,n},this.hostLanguage=t,n(s)};ji(`${zi.recaptchaV2Script}?${ct({onload:xo,render:"explicit",hl:t})}`).catch((()=>{clearTimeout(i),r(Rr(e,"internal-error"))}))}))}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(null===(t=fo().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Ao{async load(e){return new Co(e)}clearedOneInstance(){}}const Ro="recaptcha",Do={theme:"light",type:"image"};class Oo{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.assign({},Do);this.parameters=n,this.type=Ro,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Vi(e),this.isInvisible="invisible"===this.parameters.size,Fr("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment");const r="string"===typeof t?document.getElementById(t):t;Fr(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Ao:new Po,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise((n=>{const r=e=>{e&&(this.tokenChangeListeners.delete(r),n(e))};this.tokenChangeListeners.add(r),this.isInvisible&&t.execute(e)}))}render(){try{this.assertNotDestroyed()}catch(cx){return Promise.reject(cx)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((e=>{throw this.renderPromise=null,e}))),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((e=>{this.container.removeChild(e)}))}validateStartingState(){Fr(!this.parameters.sitekey,this.auth,"argument-error"),Fr(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Fr("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach((e=>e(t))),"function"===typeof e)e(t);else if("string"===typeof e){const n=fo()[e];"function"===typeof n&&n(t)}}}assertNotDestroyed(){Fr(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){Fr(zr()&&!po(),this.auth,"internal-error"),await function(){let e=null;return new Promise((t=>{"complete"!==document.readyState?(e=()=>t(),window.addEventListener("load",e)):t()})).catch((t=>{throw e&&window.removeEventListener("load",e),t}))}(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await async function(e){return(await Qr(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}(this.auth);Fr(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return Fr(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Lo{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=as._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function Mo(e,t,n){var r;const i=await n.verify();try{let s;if(Fr("string"===typeof i,e,"argument-error"),Fr(n.type===Ro,e,"argument-error"),s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){Fr("enroll"===t.type,e,"internal-error");const n=await function(e,t){return Qr(e,"POST","/v2/accounts/mfaEnrollment:start",Gr(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{Fr("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;Fr(n,e,"missing-multi-factor-info");const o=await function(e,t){return Qr(e,"POST","/v2/accounts/mfaSignIn:start",Gr(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Qr(e,"POST","/v1/accounts:sendVerificationCode",Gr(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}class Fo{constructor(e){this.providerId=Fo.PROVIDER_ID,this.auth=Vi(e)}verifyPhoneNumber(e,t){return Mo(this.auth,e,It(t))}static credential(e,t){return as._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Fo.credentialFromTaggedObject(t)}static credentialFromError(e){return Fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?as._fromTokenResponse(n,r):null}}function Uo(e,t){return t?wi(t):(Fr(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Fo.PROVIDER_ID="phone",Fo.PHONE_SIGN_IN_METHOD="phone";class Vo extends Yi{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return is(e,this._buildIdpRequest())}_linkToIdToken(e,t){return is(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return is(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function qo(e){return Ns(e.auth,new Vo(e),e.bypassAuthState)}function zo(e){const{auth:t,user:n}=e;return Fr(n,t,"internal-error"),xs(n,new Vo(e),e.bypassAuthState)}async function jo(e){const{auth:t,user:n}=e;return Fr(n,t,"internal-error"),Cs(n,new Vo(e),e.bypassAuthState)}class Bo{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(cx){this.reject(cx)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(cx){this.reject(cx)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return qo;case"linkViaPopup":case"linkViaRedirect":return jo;case"reauthViaPopup":case"reauthViaRedirect":return zo;default:Ar(this.auth,"internal-error")}}resolve(e){Vr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Vr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const $o=new Br(2e3,1e4);class Wo extends Bo{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Wo.currentPopupAction&&Wo.currentPopupAction.cancel(),Wo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Fr(e,this.auth,"internal-error"),e}async onExecution(){Vr(1===this.filter.length,"Popup operations only handle one event");const e=co();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(Rr(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Rr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Wo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Rr(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,$o.get())};e()}}Wo.currentPopupAction=null;const Ko=new Map;class Ho extends Bo{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=Ko.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=Jo(t),r=Yo(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(cx){e=()=>Promise.reject(cx)}Ko.set(this.auth._key(),e)}return this.bypassAuthState||Ko.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function Go(e,t){return Yo(e)._set(Jo(t),"true")}function Qo(e,t){Ko.set(e._key(),t)}function Yo(e){return wi(e._redirectPersistence)}function Jo(e){return Ei("pendingRedirect",e.config.apiKey,e.name)}function Xo(e,t,n){return async function(e,t,n){if(Un(e.app))return Promise.reject(Or(e));const r=Vi(e);Lr(e,t,cs),await r._initializationPromise;const i=Uo(r,n);return await Go(i,r),i._openRedirect(r,t,"signInViaRedirect")}(e,t,n)}function Zo(e,t,n){return async function(e,t,n){const r=It(e);if(Lr(r.auth,t,cs),Un(r.auth.app))return Promise.reject(Or(r.auth));await r.auth._initializationPromise;const i=Uo(r.auth,n);await Go(i,r.auth);const s=await na(r);return i._openRedirect(r.auth,t,"reauthViaRedirect",s)}(e,t,n)}function ea(e,t,n){return async function(e,t,n){const r=It(e);Lr(r.auth,t,cs),await r.auth._initializationPromise;const i=Uo(r.auth,n);await ks(!1,r,t.providerId),await Go(i,r.auth);const s=await na(r);return i._openRedirect(r.auth,t,"linkViaRedirect",s)}(e,t,n)}async function ta(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Un(e.app))return Promise.reject(Or(e));const r=Vi(e),i=Uo(r,t),s=new Ho(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}async function na(e){const t=co(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}class ra{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return sa(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!sa(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Rr(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(ia(e))}saveEventToCache(e){this.cachedEventUids.add(ia(e)),this.lastProcessedEventTime=Date.now()}}function ia(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function sa(e){let{type:t,error:n}=e;return"unknown"===t&&"auth/no-auth-event"===(null===n||void 0===n?void 0:n.code)}async function oa(e){return Qr(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}const aa=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,la=/^https?/;function ua(e){const t=qr(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!la.test(n))return!1;if(aa.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const ca=new Br(3e4,6e4);function ha(){const e=fo().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function da(e){return new Promise(((t,n)=>{var r,i,s;function o(){ha(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{ha(),n(Rr(e,"network-request-failed"))},timeout:ca.get()})}if(null===(i=null===(r=fo().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=fo().gapi)||void 0===s?void 0:s.load)){const t=Bi("iframefcb");return fo()[t]=()=>{gapi.load?o():n(Rr(e,"network-request-failed"))},ji(`${zi.gapiScript}?onload=${t}`).catch((e=>n(e)))}o()}})).catch((e=>{throw fa=null,e}))}let fa=null;const pa=new Br(5e3,15e3),ma={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ga=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ya(e){const t=e.config;Fr(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?$r(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:Bn},i=ga.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${ct(r).slice(1)}`}async function va(e){const t=await function(e){return fa=fa||da(e),fa}(e),n=fo().gapi;return Fr(n,e,"internal-error"),t.open({where:document.body,url:ya(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ma,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=Rr(e,"network-request-failed"),s=fo().setTimeout((()=>{r(i)}),pa.get());function o(){fo().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}const _a={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class wa{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(cx){}}}function ba(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},_a),{width:r.toString(),height:i.toString(),top:s,left:o}),u=je().toLowerCase();n&&(a=xi(u)?"_blank":n),Ci(u)&&(t=t||"http://localhost",l.scrollbars="yes");const c=Object.entries(l).reduce(((e,t)=>{let[n,r]=t;return`${e}${n}=${r},`}),"");if(function(){var e;return Di(arguments.length>0&&void 0!==arguments[0]?arguments[0]:je())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(u)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new wa(null);const h=window.open(t||"",a,c);Fr(h,e,"popup-blocked");try{h.focus()}catch(cx){}return new wa(h)}const Ia="__/auth/handler",Ea="emulator/auth/handler",Sa=encodeURIComponent("fac");async function Ta(e,t,n,r,i,s){Fr(e.config.authDomain,e,"auth-domain-config-required"),Fr(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Bn,eventId:i};if(t instanceof cs){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",ot(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof hs){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const c of Object.keys(a))void 0===a[c]&&delete a[c];const l=await e._getAppCheckToken(),u=l?`#${Sa}=${encodeURIComponent(l)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${Ia}`;return $r(t,Ea)}(e)}?${ct(a).slice(1)}${u}`}const Ca="webStorageSupport";const ka=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=lo,this._completeRedirectFn=ta,this._overrideRedirectResult=Qo}async _openPopup(e,t,n,r){var i;Vr(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return ba(e,await Ta(e,t,n,qr(),r),co())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){fo().location.href=e}(await Ta(e,t,n,qr(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Vr(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await va(e),n=new ra(e);return t.register("authEvent",(t=>{Fr(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ca,{type:Ca},(n=>{var r;const i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[Ca];void 0!==i&&t(!!i),Ar(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await oa(e);for(const n of t)try{if(ua(n))return}catch(hx){}Ar(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Oi()||ki()||Di()}};class xa{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return Ur("unexpected MultiFactorSessionType")}}}class Na extends xa{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Na(e)}_finalizeEnroll(e,t,n){return function(e,t){return Qr(e,"POST","/v2/accounts/mfaEnrollment:finalize",Gr(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return function(e,t){return Qr(e,"POST","/v2/accounts/mfaSignIn:finalize",Gr(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class Pa{constructor(){}static assertion(e){return Na._fromCredential(e)}}Pa.FACTOR_ID="phone";var Aa="@firebase/auth",Ra="1.7.9";class Da{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Fr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}(e=>{var t;null===(t=Ue())||void 0===t||t[`_${e}`]})("authIdTokenMaxAge");var Oa,La;function Ma(){return window}Oa={loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=Rr("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},zi=Oa,La="Browser",On(new Et("auth",((e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Fr(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:La,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Li(La)},u=new Ui(r,i,s,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(wi);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(u,n),u}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),On(new Et("auth-internal",(e=>(e=>new Da(e))(Vi(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Qn(Aa,Ra,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(La)),Qn(Aa,Ra,"esm2017");async function Fa(e,t,n){var r;const{BuildInfo:i}=Ma();Vr(t.sessionId,"AuthEvent did not contain a session ID");const s=await async function(e){const t=function(e){if(Vr(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!==typeof TextEncoder)return(new TextEncoder).encode(e);const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(t.sessionId),o={};return Di()?o.ibi=i.packageName:Pi()?o.apn=i.packageName:Ar(e,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,Ta(e,n,t.type,void 0,null!==(r=t.eventId)&&void 0!==r?r:void 0,o)}function Ua(e){const{cordova:t}=Ma();return new Promise((n=>{t.plugins.browsertab.isAvailable((r=>{let i=null;r?t.plugins.browsertab.openUrl(e):i=t.InAppBrowser.open(e,function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je();return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}()?"_blank":"_system","location=yes"),n(i)}))}))}class Va extends ra{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise((e=>{this.resolveInitialized=e}))}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach((t=>t(e))),super.onEvent(e)}async initialized(){await this.initPromise}}async function qa(e){const t=await Ba()._get($a(e));return t&&await Ba()._remove($a(e)),t}function za(e,t){var n,r;const i=function(e){const t=Wa(e),n=t.link?decodeURIComponent(t.link):void 0,r=Wa(n).link,i=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return Wa(i).link||i||r||n||e}(t);if(i.includes("/__/auth/callback")){const t=Wa(i),s=t.firebaseError?function(e){try{return JSON.parse(e)}catch(cx){return null}}(decodeURIComponent(t.firebaseError)):null,o=null===(r=null===(n=null===s||void 0===s?void 0:s.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],a=o?Rr(o):null;return a?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:a,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:i,postBody:null}}return null}function ja(){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<20;n++){const n=Math.floor(62*Math.random());e.push(t.charAt(n))}return e.join("")}function Ba(){return wi(oo)}function $a(e){return Ei("authEvent",e.config.apiKey,e.name)}function Wa(e){if(!(null===e||void 0===e?void 0:e.includes("?")))return{};const[t,...n]=e.split("?");return ht(n.join("?"))}const Ka=class{constructor(){this._redirectPersistence=lo,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=ta,this._overrideRedirectResult=Qo}async _initialize(e){const t=e._key();let n=this.eventManagers.get(t);return n||(n=new Va(e),this.eventManagers.set(t,n),this.attachCallbackListeners(e,n)),n}_openPopup(e){Ar(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,n,r){!function(e){var t,n,r,i,s,o,a,l,u,c;const h=Ma();Fr("function"===typeof(null===(t=null===h||void 0===h?void 0:h.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),Fr("undefined"!==typeof(null===(n=null===h||void 0===h?void 0:h.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),Fr("function"===typeof(null===(s=null===(i=null===(r=null===h||void 0===h?void 0:h.cordova)||void 0===r?void 0:r.plugins)||void 0===i?void 0:i.browsertab)||void 0===s?void 0:s.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Fr("function"===typeof(null===(l=null===(a=null===(o=null===h||void 0===h?void 0:h.cordova)||void 0===o?void 0:o.plugins)||void 0===a?void 0:a.browsertab)||void 0===l?void 0:l.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Fr("function"===typeof(null===(c=null===(u=null===h||void 0===h?void 0:h.cordova)||void 0===u?void 0:u.InAppBrowser)||void 0===c?void 0:c.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(e);const i=await this._initialize(e);await i.initialized(),i.resetRedirect(),Ko.clear(),await this._originValidation(e);const s=function(e,t){return{type:t,eventId:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,urlResponse:null,sessionId:ja(),postBody:null,tenantId:e.tenantId,error:Rr(e,"no-auth-event")}}(e,n,r);await function(e,t){return Ba()._set($a(e),t)}(e,s);const o=await Fa(e,s,t);return async function(e,t,n){const{cordova:r}=Ma();let i=()=>{};try{await new Promise(((s,o)=>{let a=null;function l(){var e;s();const t=null===(e=r.plugins.browsertab)||void 0===e?void 0:e.close;"function"===typeof t&&t(),"function"===typeof(null===n||void 0===n?void 0:n.close)&&n.close()}function u(){a||(a=window.setTimeout((()=>{o(Rr(e,"redirect-cancelled-by-user"))}),2e3))}function c(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&u()}t.addPassiveListener(l),document.addEventListener("resume",u,!1),Pi()&&document.addEventListener("visibilitychange",c,!1),i=()=>{t.removePassiveListener(l),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",c,!1),a&&window.clearTimeout(a)}}))}finally{i()}}(e,i,await Ua(o))}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){const{BuildInfo:t}=Ma(),n={};Di()?n.iosBundleId=t.packageName:Pi()?n.androidPackageName=t.packageName:Ar(e,"operation-not-supported-in-this-environment"),await oa(e,n)}(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:n,handleOpenURL:r,BuildInfo:i}=Ma(),s=setTimeout((async()=>{await qa(e),t.onEvent(Ha())}),500),o=async n=>{clearTimeout(s);const r=await qa(e);let i=null;r&&(null===n||void 0===n?void 0:n.url)&&(i=za(r,n.url)),t.onEvent(i||Ha())};"undefined"!==typeof n&&"function"===typeof n.subscribe&&n.subscribe(null,o);const a=r,l=`${i.packageName.toLowerCase()}://`;Ma().handleOpenURL=async e=>{if(e.toLowerCase().startsWith(l)&&o({url:e}),"function"===typeof a)try{a(e)}catch(cx){console.error(cx)}}}};function Ha(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Rr("no-auth-event")}}function Ga(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function Qa(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je();return!("file:"!==Ga()&&"ionic:"!==Ga()&&"capacitor:"!==Ga()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function Ya(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je();return Ge()&&11===(null===document||void 0===document?void 0:document.documentMode)||function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je();return/Edge\/\d+/.test(e)}(e)}function Ja(){try{const e=self.localStorage,t=co();if(e)return e.setItem(t,"1"),e.removeItem(t),!Ya()||Je()}catch(cx){return Xa()&&Je()}return!1}function Xa(){return"undefined"!==typeof n.g&&"WorkerGlobalScope"in n.g&&"importScripts"in n.g}function Za(){return("http:"===Ga()||"https:"===Ga()||Ke()||Qa())&&!(He()||$e())&&Ja()&&!Xa()}function el(){return Qa()&&"undefined"!==typeof document}const tl={LOCAL:"local",NONE:"none",SESSION:"session"},nl=Fr,rl="persistence";async function il(e){await e._initializationPromise;const t=sl(),n=Ei(rl,e.config.apiKey,e.name);t&&t.setItem(n,e._getPersistence())}function sl(){var e;try{return(null===(e="undefined"!==typeof window?window:null)||void 0===e?void 0:e.sessionStorage)||null}catch(cx){return null}}const ol=Fr;class al{constructor(){this.browserResolver=wi(ka),this.cordovaResolver=wi(Ka),this.underlyingResolver=null,this._redirectPersistence=lo,this._completeRedirectFn=ta,this._overrideRedirectResult=Qo}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,n,r)}async _openRedirect(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,n,r)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return el()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return ol(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await async function(){return!!el()&&new Promise((e=>{const t=setTimeout((()=>{e(!1)}),1e3);document.addEventListener("deviceready",(()=>{clearTimeout(t),e(!0)}))}))}();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}function ll(e){return e.unwrap()}function ul(e,t){var n;const r=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===(null===t||void 0===t?void 0:t.code)){t.resolver=new fl(e,function(e,t){var n;const r=It(e),i=t;return Fr(t.customData.operationType,r,"argument-error"),Fr(null===(n=i.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,r,"argument-error"),eo._fromError(r,i)}(e,t))}else if(r){const e=cl(t),n=t;e&&(n.credential=e,n.tenantId=r.tenantId||void 0,n.email=r.email||void 0,n.phoneNumber=r.phoneNumber||void 0)}}function cl(e){const{_tokenResponse:t}=e instanceof Xe?e.customData:e;if(!t)return null;if(!(e instanceof Xe)&&"temporaryProof"in t&&"phoneNumber"in t)return Fo.credentialFromResult(e);const n=t.providerId;if(!n||n===yr)return null;let r;switch(n){case gr:r=ps;break;case pr:r=fs;break;case mr:r=ms;break;case vr:r=vs;break;default:const{oauthIdToken:e,oauthAccessToken:i,oauthTokenSecret:s,pendingToken:o,nonce:a}=t;return i||s||e||o?o?n.startsWith("saml.")?gs._create(n,o):ss._fromParams({providerId:n,signInMethod:n,pendingToken:o,idToken:e,accessToken:i}):new ds(n).credential({idToken:e,accessToken:i,rawNonce:a}):null}return e instanceof Xe?r.credentialFromError(e):r.credentialFromResult(e)}function hl(e,t){return t.catch((t=>{throw t instanceof Xe&&ul(e,t),t})).then((e=>{const t=e.operationType,n=e.user;return{operationType:t,credential:(r=e,cl(r)),additionalUserInfo:Xs(e),user:pl.getOrCreate(n)};var r}))}async function dl(e,t){const n=await t;return{verificationId:n.verificationId,confirm:t=>hl(e,n.confirm(t))}}class fl{constructor(e,t){this.resolver=t,this.auth=e.wrapped()}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return hl(ll(this.auth),this.resolver.resolveSignIn(e))}}class pl{constructor(e){this._delegate=e,this.multiFactor=function(e){const t=It(e);return no.has(t)||no.set(t,to._fromUser(t)),no.get(t)}(e)}static getOrCreate(e){return pl.USER_MAP.has(e)||pl.USER_MAP.set(e,new pl(e)),pl.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return hl(this.auth,As(this._delegate,e))}async linkWithPhoneNumber(e,t){return dl(this.auth,async function(e,t,n){const r=It(e);await ks(!1,r,"phone");const i=await Mo(r.auth,t,It(n));return new Lo(i,(e=>As(r,e)))}(this._delegate,e,t))}async linkWithPopup(e){return hl(this.auth,async function(e,t,n){const r=It(e);Lr(r.auth,t,cs);const i=Uo(r.auth,n);return new Wo(r.auth,"linkViaPopup",t,i,r).executeNotNull()}(this._delegate,e,al))}async linkWithRedirect(e){return await il(Vi(this.auth)),ea(this._delegate,e,al)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return hl(this.auth,Rs(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return dl(this.auth,async function(e,t,n){const r=It(e);if(Un(r.auth.app))return Promise.reject(Or(r.auth));const i=await Mo(r.auth,t,It(n));return new Lo(i,(e=>Rs(r,e)))}(this._delegate,e,t))}reauthenticateWithPopup(e){return hl(this.auth,async function(e,t,n){const r=It(e);if(Un(r.auth.app))return Promise.reject(Rr(r.auth,"operation-not-supported-in-this-environment"));Lr(r.auth,t,cs);const i=Uo(r.auth,n);return new Wo(r.auth,"reauthViaPopup",t,i,r).executeNotNull()}(this._delegate,e,al))}async reauthenticateWithRedirect(e){return await il(Vi(this.auth)),Zo(this._delegate,e,al)}sendEmailVerification(e){return js(this._delegate,e)}async unlink(e){return await Ts(this._delegate,e),this}updateEmail(e){return function(e,t){const n=It(e);return Un(n.auth.app)?Promise.reject(Or(n.auth)):Ws(n,t,null)}(this._delegate,e)}updatePassword(e){return function(e,t){return Ws(It(e),null,t)}(this._delegate,e)}updatePhoneNumber(e){return async function(e,t){const n=It(e);if(Un(n.auth.app))return Promise.reject(Or(n.auth));await Cs(n,t)}(this._delegate,e)}updateProfile(e){return $s(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return Bs(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}pl.USER_MAP=new WeakMap;const ml=Fr;class gl{constructor(e,t){if(this.app=e,t.isInitialized())return this._delegate=t.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:n}=e.options;ml(n,"invalid-api-key",{appName:e.name}),ml(n,"invalid-api-key",{appName:e.name});const r="undefined"!==typeof window?al:void 0;this._delegate=t.initialize({options:{persistence:vl(n,e.name),popupRedirectResolver:r}}),this._delegate._updateErrorMap(Cr),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?pl.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){Hi(this._delegate,e,t)}applyActionCode(e){return Vs(this._delegate,e)}checkActionCode(e){return qs(this._delegate,e)}confirmPasswordReset(e,t){return async function(e,t,n){await Ji(It(e),{oobCode:t,newPassword:n}).catch((async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&Us(e),t}))}(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return hl(this._delegate,async function(e,t,n){if(Un(e.app))return Promise.reject(Or(e));const r=Vi(e),i=Ki(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",_s),s=await i.catch((t=>{throw"auth/password-does-not-meet-requirements"===t.code&&Us(e),t})),o=await ws._fromIdTokenResponse(r,"signIn",s);return await r._updateCurrentUser(o.user),o}(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return zs(this._delegate,e)}isSignInWithEmailLink(e){return function(e,t){const n=ls.parseLink(t);return"EMAIL_SIGNIN"===(null===n||void 0===n?void 0:n.operation)}(this._delegate,e)}async getRedirectResult(){ml(Za(),this._delegate,"operation-not-supported-in-this-environment");const e=await async function(e,t){return await Vi(e)._initializationPromise,ta(e,t,!1)}(this._delegate,al);return e?hl(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){!function(e,t){Vi(e)._logFramework(t)}(this._delegate,e)}onAuthStateChanged(e,t,n){const{next:r,error:i,complete:s}=yl(e,t,n);return this._delegate.onAuthStateChanged(r,i,s)}onIdTokenChanged(e,t,n){const{next:r,error:i,complete:s}=yl(e,t,n);return this._delegate.onIdTokenChanged(r,i,s)}sendSignInLinkToEmail(e,t){return async function(e,t,n){const r=Vi(e),i={requestType:"EMAIL_SIGNIN",email:t,clientType:"CLIENT_TYPE_WEB"};!function(e,t){Fr(t.handleCodeInApp,r,"argument-error"),t&&Fs(r,e,t)}(i,n),await Ki(r,i,"getOobCode",ns)}(this._delegate,e,t)}sendPasswordResetEmail(e,t){return async function(e,t,n){const r=Vi(e),i={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};n&&Fs(r,i,n),await Ki(r,i,"getOobCode",ts)}(this._delegate,e,t||void 0)}async setPersistence(e){let t;switch(function(e,t){nl(Object.values(tl).includes(t),e,"invalid-persistence-type"),He()?nl(t!==tl.SESSION,e,"unsupported-persistence-type"):$e()?nl(t===tl.NONE,e,"unsupported-persistence-type"):Xa()?nl(t===tl.NONE||t===tl.LOCAL&&Je(),e,"unsupported-persistence-type"):nl(t===tl.NONE||Ja(),e,"unsupported-persistence-type")}(this._delegate,e),e){case tl.SESSION:t=lo;break;case tl.LOCAL:t=await wi(So)._isAvailable()?So:oo;break;case tl.NONE:t=Ii;break;default:return Ar("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return hl(this._delegate,async function(e){var t;if(Un(e.app))return Promise.reject(Or(e));const n=Vi(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new ws({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await _s(n,{returnSecureToken:!0}),i=await ws._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}(this._delegate))}signInWithCredential(e){return hl(this._delegate,Ps(this._delegate,e))}signInWithCustomToken(e){return hl(this._delegate,Ds(this._delegate,e))}signInWithEmailAndPassword(e,t){return hl(this._delegate,function(e,t,n){return Un(e.app)?Promise.reject(Or(e)):Ps(It(e),us.credential(t,n)).catch((async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&Us(e),t}))}(this._delegate,e,t))}signInWithEmailLink(e,t){return hl(this._delegate,async function(e,t,n){if(Un(e.app))return Promise.reject(Or(e));const r=It(e),i=us.credentialWithLink(t,n||qr());return Fr(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Ps(r,i)}(this._delegate,e,t))}signInWithPhoneNumber(e,t){return dl(this._delegate,async function(e,t,n){if(Un(e.app))return Promise.reject(Or(e));const r=Vi(e),i=await Mo(r,t,It(n));return new Lo(i,(e=>Ps(r,e)))}(this._delegate,e,t))}async signInWithPopup(e){return ml(Za(),this._delegate,"operation-not-supported-in-this-environment"),hl(this._delegate,async function(e,t,n){if(Un(e.app))return Promise.reject(Rr(e,"operation-not-supported-in-this-environment"));const r=Vi(e);Lr(e,t,cs);const i=Uo(r,n);return new Wo(r,"signInViaPopup",t,i).executeNotNull()}(this._delegate,e,al))}async signInWithRedirect(e){return ml(Za(),this._delegate,"operation-not-supported-in-this-environment"),await il(this._delegate),Xo(this._delegate,e,al)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return async function(e,t){const{data:n}=await qs(It(e),t);return n.email}(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}function yl(e,t,n){let r=e;"function"!==typeof e&&({next:r,error:t,complete:n}=e);const i=r;return{next:e=>i(e&&pl.getOrCreate(e)),error:t,complete:n}}function vl(e,t){const n=function(e,t){const n=sl();if(!n)return[];const r=Ei(rl,e,t);switch(n.getItem(r)){case tl.NONE:return[Ii];case tl.LOCAL:return[So,lo];case tl.SESSION:return[lo];default:return[]}}(e,t);if("undefined"===typeof self||n.includes(So)||n.push(So),"undefined"!==typeof window)for(const r of[oo,lo])n.includes(r)||n.push(r);return n.includes(Ii)||n.push(Ii),n}gl.Persistence=tl;class _l{constructor(){this.providerId="phone",this._delegate=new Fo(ll(dr.auth()))}static credential(e,t){return Fo.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}_l.PHONE_SIGN_IN_METHOD=Fo.PHONE_SIGN_IN_METHOD,_l.PROVIDER_ID=Fo.PROVIDER_ID;const wl=Fr;class bl{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:dr.app();var r;wl(null===(r=n.options)||void 0===r?void 0:r.apiKey,"invalid-api-key",{appName:n.name}),this._delegate=new Oo(n.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}var Il;(Il=dr).INTERNAL.registerComponent(new Et("auth-compat",(e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new gl(t,n)}),"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:_r,PASSWORD_RESET:wr,RECOVER_EMAIL:br,REVERT_SECOND_FACTOR_ADDITION:Ir,VERIFY_AND_CHANGE_EMAIL:Er,VERIFY_EMAIL:Sr}},EmailAuthProvider:us,FacebookAuthProvider:fs,GithubAuthProvider:ms,GoogleAuthProvider:ps,OAuthProvider:ds,SAMLAuthProvider:ys,PhoneAuthProvider:_l,PhoneMultiFactorGenerator:Pa,RecaptchaVerifier:bl,TwitterAuthProvider:vs,Auth:gl,AuthCredential:Yi,Error:Xe}).setInstantiationMode("LAZY").setMultipleInstances(!1)),Il.registerVersion("@firebase/auth-compat","0.5.14");var El,Sl,Tl="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Cl={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,i=this.B,s=this.h,o=0;o<t;){if(0==s)for(;o<=r;)n(this,e,o),o+=this.blockSize;if("string"===typeof e){for(;o<t;)if(i[s++]=e.charCodeAt(o++),s==this.blockSize){n(this,i),s=0;break}}else for(;o<t;)if(i[s++]=e[o++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var i={};function s(e){return-128<=e&&128>e?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new r([0|e],0>e?-1:0)})):new r([0|e],0>e?-1:0)}function o(e){if(isNaN(e)||!isFinite(e))return a;if(0>e)return d(o(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=4294967296;return new r(t,0)}var a=s(0),l=s(1),u=s(16777216);function c(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function d(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new r(n,~e.h).add(l)}function f(e,t){return e.add(d(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(c(t))throw Error("division by zero");if(c(e))return new m(a,a);if(h(e))return t=g(d(e),t),new m(d(t.g),d(t.h));if(h(t))return t=g(e,d(t)),new m(d(t.g),t.h);if(30<e.g.length){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;0>=r.l(e);)n=y(n),r=y(r);var i=v(n,1),s=v(r,1);for(r=v(r,2),n=v(n,2);!c(r);){var u=s.add(r);0>=u.l(e)&&(i=i.add(n),s=u),r=v(r,1),n=v(n,1)}return t=f(e,i.j(t)),new m(i,t)}for(i=a;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),u=(s=o(n)).j(t);h(u)||0<u.l(e);)u=(s=o(n-=r)).j(t);c(s)&&(s=l),i=i.add(s),e=f(e,u)}return new m(i,e)}function y(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.i(i)<<1|e.i(i-1)>>>31;return new r(n,e.h)}function v(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,s=[],o=0;o<i;o++)s[o]=0<t?e.i(o+n)>>>t|e.i(o+n+1)<<32-t:e.i(o+n);return new r(s,e.h)}(e=r.prototype).m=function(){if(h(this))return-d(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(c(this))return"0";if(h(this))return"-"+d(this).toString(e);for(var t=o(Math.pow(e,6)),n=this,r="";;){var i=g(n,t).g,s=((0<(n=f(n,i.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(c(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=f(this,e))?-1:c(e)?0:1},e.abs=function(){return h(this)?d(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,s=0;s<=t;s++){var o=i+(65535&this.i(s))+(65535&e.i(s)),a=(o>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);i=a>>>16,o&=65535,a&=65535,n[s]=a<<16|o}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(c(this)||c(e))return a;if(h(this))return h(e)?d(this).j(d(e)):d(d(this).j(e));if(h(e))return d(this.j(d(e)));if(0>this.l(u)&&0>e.l(u))return o(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var s=0;s<e.g.length;s++){var l=this.i(i)>>>16,f=65535&this.i(i),m=e.i(s)>>>16,g=65535&e.i(s);n[2*i+2*s]+=f*g,p(n,2*i+2*s),n[2*i+2*s+1]+=l*g,p(n,2*i+2*s+1),n[2*i+2*s+1]+=f*m,p(n,2*i+2*s+1),n[2*i+2*s+2]+=l*m,p(n,2*i+2*s+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new r(n,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)&e.i(i);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)|e.i(i);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)^e.i(i);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,Sl=Cl.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=o,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return d(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=o(Math.pow(n,8)),i=a,s=0;s<t.length;s+=8){var l=Math.min(8,t.length-s),u=parseInt(t.substring(s,s+l),n);8>l?(l=o(Math.pow(n,l)),i=i.j(l).add(o(u))):i=(i=i.j(r)).add(o(u))}return i},El=Cl.Integer=r}).apply("undefined"!==typeof Tl?Tl:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var kl,xl,Nl,Pl,Al,Rl,Dl,Ol,Ll="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Ml={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Ll&&Ll];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var i=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var o=e[s];if(!(o in i))break e;i=i[o]}(r=r(s=i[e=e[e.length-1]]))!=s&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e,t){return t}))}}));var r=r||{},i=this||self;function s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function a(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function u(e,t,n){return(u=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:l).apply(null,arguments)}function c(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function h(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function d(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(s(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function m(){var e=i.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var y=-1!=m().indexOf("Gecko")&&!(-1!=m().toLowerCase().indexOf("webkit")&&-1==m().indexOf("Edge"))&&!(-1!=m().indexOf("Trident")||-1!=m().indexOf("MSIE"))&&-1==m().indexOf("Edge");function v(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function _(e){const t={};for(const n in e)t[n]=e[n];return t}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<w.length;t++)n=w[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function I(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function E(e){i.setTimeout((()=>{throw e}),0)}function S(){var e=N;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var T=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new C),(e=>e.reset()));class C{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let k,x=!1,N=new class{constructor(){this.h=this.g=null}add(e,t){const n=T.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},P=()=>{const e=i.Promise.resolve(void 0);k=()=>{e.then(A)}};var A=()=>{for(var e;e=S();){try{e.h.call(e.g)}catch(n){E(n)}var t=T;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}x=!1};function R(){this.s=this.s,this.C=this.C}function D(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}R.prototype.s=!1,R.prototype.ma=function(){this.s||(this.s=!0,this.N())},R.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},D.prototype.h=function(){this.defaultPrevented=!0};var O=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(n){}return e}();function L(e,t){if(D.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(y){e:{try{g(t.nodeName);var i=!0;break e}catch(s){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:M[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&L.aa.h.call(this)}}h(L,D);var M={2:"touch",3:"pen",4:"mouse"};L.prototype.h=function(){L.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var F="closure_listenable_"+(1e6*Math.random()|0),U=0;function V(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++U,this.da=this.fa=!1}function q(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function z(e){this.src=e,this.g={},this.h=0}function j(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=Array.prototype.indexOf.call(i,t,void 0);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(q(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function B(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==r)return i}return-1}z.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=B(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new V(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var $="closure_lm_"+(1e6*Math.random()|0),W={};function K(e,t,n,r,i){if(r&&r.once)return G(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)K(e,t[s],n,r,i);return null}return n=te(n),e&&e[F]?e.K(t,n,o(r)?!!r.capture:!!r,i):H(e,t,n,!1,r,i)}function H(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var a=o(i)?!!i.capture:!!i,l=Z(e);if(l||(e[$]=l=new z(e)),(n=l.add(t,n,r,a,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=X;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)O||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(J(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function G(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)G(e,t[s],n,r,i);return null}return n=te(n),e&&e[F]?e.L(t,n,o(r)?!!r.capture:!!r,i):H(e,t,n,!0,r,i)}function Q(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)Q(e,t[s],n,r,i);else r=o(r)?!!r.capture:!!r,n=te(n),e&&e[F]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=B(s=e.g[t],n,r,i))&&(q(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=Z(e))&&(t=e.g[t.toString()],e=-1,t&&(e=B(t,n,r,i)),(n=-1<e?t[e]:null)&&Y(n))}function Y(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[F])j(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(J(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Z(t))?(j(n,e),0==n.h&&(n.src=null,t[$]=null)):q(e)}}}function J(e){return e in W?W[e]:W[e]="on"+e}function X(e,t){if(e.da)e=!0;else{t=new L(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&Y(e),e=n.call(r,t)}return e}function Z(e){return(e=e[$])instanceof z?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){R.call(this),this.i=new z(this),this.M=this,this.F=null}function re(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new D(t,e);else if(t instanceof D)t.target=t.target||e;else{var i=t;b(t=new D(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=ie(o,r,!0,t)&&i}if(i=ie(o=t.g=e,r,!0,t)&&i,i=ie(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=ie(o=t.g=n[s],r,!1,t)&&i}function ie(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.da&&o.capture==n){var a=o.listener,l=o.ha||o.src;o.fa&&j(e.i,o),i=!1!==a.call(l,r)&&i}}return i&&!r.defaultPrevented}function se(e,t,n){if("function"===typeof e)n&&(e=u(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=u(e.handleEvent,e)}return 2147483647<Number(t)?-1:i.setTimeout(e,t||0)}function oe(e){e.g=se((()=>{e.g=null,e.i&&(e.i=!1,oe(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}h(ne,R),ne.prototype[F]=!0,ne.prototype.removeEventListener=function(e,t,n,r){Q(this,e,t,n,r)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)q(n[r]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ne.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class ae extends R{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:oe(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){R.call(this),this.h=e,this.g={}}h(le,R);var ue=[];function ce(e){v(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Y(e)}),e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),ce(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var he=i.JSON.stringify,de=i.JSON.parse,fe=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function pe(){}function me(e){return e.h||(e.h=e.i())}function ge(){}pe.prototype.h=null;var ye={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ve(){D.call(this,"d")}function _e(){D.call(this,"c")}h(ve,D),h(_e,D);var we={},be=null;function Ie(){return be=be||new ne}function Ee(e){D.call(this,we.La,e)}function Se(e){const t=Ie();re(t,new Ee(t))}function Te(e,t){D.call(this,we.STAT_EVENT,e),this.stat=t}function Ce(e){const t=Ie();re(t,new Te(t,e))}function ke(e,t){D.call(this,we.Ma,e),this.size=t}function xe(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout((function(){e()}),t)}function Ne(){this.g=!0}function Pe(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return he(n)}catch(a){return t}}(e,n)+(r?" "+r:"")}))}we.La="serverreachability",h(Ee,D),we.STAT_EVENT="statevent",h(Te,D),we.Ma="timingevent",h(ke,D),Ne.prototype.xa=function(){this.g=!1},Ne.prototype.info=function(){};var Ae,Re={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},De={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Oe(){}function Le(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Me}function Me(){this.i=null,this.g="",this.h=!1}h(Oe,pe),Oe.prototype.g=function(){return new XMLHttpRequest},Oe.prototype.i=function(){return{}},Ae=new Oe;var Fe={},Ue={};function Ve(e,t,n){e.L=1,e.v=ht(ot(t)),e.m=n,e.P=!0,qe(e,null)}function qe(e,t){e.F=Date.now(),Be(e),e.A=ot(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),Tt(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Me,e.g=fn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new ae(u(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var i="readystatechange";Array.isArray(i)||(i&&(ue[0]=i.toString()),i=ue);for(var s=0;s<i.length;s++){var o=K(n,i[s],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}t=e.H?_(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Se(),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var u=a[l].split("=");if(1<u.length){var c=u[0];u=u[1];var h=c.split("_");o=2<=h.length&&"type"==h[1]?o+(c+"=")+u+"&":o+(c+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function ze(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function je(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Ue:(n=Number(t.substring(n,r)),isNaN(n)?Fe:(r+=1)+n>t.length?Ue:(t=t.slice(r,r+n),e.C=r+n,t))}function Be(e){e.S=Date.now()+e.I,$e(e,e.I)}function $e(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=xe(u(e.ba,e),t)}function We(e){e.B&&(i.clearTimeout(e.B),e.B=null)}function Ke(e){0==e.j.G||e.J||ln(e.j,e)}function He(e){We(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ce(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Ge(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Ze(n.h,e)))if(!e.K&&Ze(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(c){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;an(n),Yt(n)}rn(n),Ce(18)}}else n.za=i[1],0<n.za-n.T&&37500>i[2]&&n.F&&0==n.v&&!n.C&&(n.C=xe(u(n.Za,n),6e3));if(1>=Xe(n.h)&&n.ca){try{n.ca()}catch(c){}n.ca=void 0}}else cn(n,11)}else if((e.K||n.g==e)&&an(n),!p(t))for(i=n.Da.g.parse(t),t=0;t<i.length;t++){let u=i[t];if(n.T=u[0],u=u[1],2==n.G)if("c"==u[0]){n.K=u[1],n.ia=u[2];const t=u[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const i=u[4];null!=i&&(n.Aa=i,n.j.info("SVER="+n.Aa));const c=u[5];null!=c&&"number"===typeof c&&0<c&&(r=1.5*c,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(et(s,s.h),s.h=null))}if(r.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,ct(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var o=e;if((r=n).qa=dn(r,r.J?r.ia:null,r.W),o.K){tt(r.h,o);var a=o,l=r.L;l&&(a.I=l),a.B&&(We(a),Be(a)),r.g=o}else nn(r);0<n.i.length&&Xt(n)}else"stop"!=u[0]&&"close"!=u[0]||cn(n,7);else 3==n.G&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?cn(n,7):Qt(n):"noop"!=u[0]&&n.l&&n.l.ta(u),n.v=0)}Se()}catch(c){}}Le.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==Wt(e)?t.j():this.Y(e)},Le.prototype.Y=function(e){try{if(e==this.g)e:{const d=Wt(this.g);var t=this.g.Ba();this.g.Z();if(!(3>d)&&(3!=d||this.g&&(this.h.h||this.g.oa()||Kt(this.g)))){this.J||4!=d||7==t||Se(),We(this);var n=this.g.Z();this.X=n;t:if(ze(this)){var r=Kt(this.g);e="";var s=r.length,o=4==Wt(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){He(this),Ke(this);var a="";break t}this.h.i=new i.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(o&&t==s-1)});r.length=0,this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.oa();if(this.o=200==n,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.i,this.u,this.A,this.l,this.R,d,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,u=this.g;if((l=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var c=l;break t}}c=null}if(!(n=c)){this.o=!1,this.s=3,Ce(12),He(this),Ke(this);break e}Pe(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ge(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<a.length;){if(e=je(this,a),e==Ue){4==d&&(this.s=4,Ce(14),n=!1),Pe(this.i,this.l,null,"[Incomplete Response]");break}if(e==Fe){this.s=4,Ce(15),Pe(this.i,this.l,a,"[Invalid Chunk]"),n=!1;break}Pe(this.i,this.l,e,null),Ge(this,e)}if(ze(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=d||0!=a.length||this.h.h||(this.s=1,Ce(16),n=!1),this.o=this.o&&n,n){if(0<a.length&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.ba&&!h.M&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+a.length),sn(h),h.M=!0,Ce(11))}}else Pe(this.i,this.l,a,"[Invalid Chunked Response]"),He(this),Ke(this)}else Pe(this.i,this.l,a,null),Ge(this,a);4==d&&He(this),this.o&&!this.J&&(4==d?ln(this.j,this):(this.o=!1,Be(this)))}else(function(e){const t={};e=(e.g&&2<=Wt(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(p(e[r]))continue;var n=I(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<a.indexOf("Unknown SID")?(this.s=3,Ce(12)):(this.s=0,Ce(13)),He(this),Ke(this)}}}catch(Fl){}},Le.prototype.cancel=function(){this.J=!0,He(this)},Le.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(Se(),Ce(17)),He(this),this.s=2,Ke(this)):$e(this,this.S-e)};var Qe=class{constructor(e,t){this.g=e,this.map=t}};function Ye(e){this.l=e||10,i.PerformanceNavigationTiming?e=0<(e=i.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Je(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Xe(e){return e.h?1:e.g?e.g.size:0}function Ze(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return d(e.i)}function rt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(s(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(s(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(s(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}Ye.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var it=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function st(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof st){this.h=e.h,at(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,n=new bt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ut(this,n),this.m=e.m}else e&&(t=String(e).match(it))?(this.h=!1,at(this,t[1]||"",!0),this.o=dt(t[2]||""),this.g=dt(t[3]||"",!0),lt(this,t[4]),this.l=dt(t[5]||"",!0),ut(this,t[6]||"",!0),this.m=dt(t[7]||"")):(this.h=!1,this.i=new bt(null,this.h))}function ot(e){return new st(e)}function at(e,t,n){e.j=n?dt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ut(e,t,n){t instanceof bt?(e.i=t,function(e,t){t&&!e.j&&(It(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Et(this,t),Tt(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=ft(t,_t)),e.i=new bt(t,e.h))}function ct(e,t,n){e.i.set(t,n)}function ht(e){return ct(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function dt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ft(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,pt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function pt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}st.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ft(t,gt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ft(t,gt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ft(n,"/"==n.charAt(0)?vt:yt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ft(n,wt)),e.join("")};var mt,gt=/[#\/\?@]/g,yt=/[#\?:]/g,vt=/[#\?]/g,_t=/[#\?@]/g,wt=/#/g;function bt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function It(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Et(e,t){It(e),t=Ct(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function St(e,t){return It(e),t=Ct(e,t),e.g.has(t)}function Tt(e,t,n){Et(e,t),0<n.length&&(e.i=null,e.g.set(Ct(e,t),d(n)),e.h+=n.length)}function Ct(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function kt(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(s){}}function xt(){this.g=new fe}function Nt(e,t,n){const r=n||"";try{rt(e,(function(e,n){let i=e;o(e)&&(i=he(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(cx){throw t.push(r+"type="+encodeURIComponent("_badmap")),cx}}function Pt(e){this.l=e.Ub||null,this.j=e.eb||!1}function At(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Rt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Dt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Ot(e)}function Ot(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Lt(e){let t="";return v(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Mt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Lt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):ct(e,t,n))}function Ft(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=bt.prototype).add=function(e,t){It(this),this.i=null,e=Ct(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){It(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},e.na=function(){It(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},e.V=function(e){It(this);let t=[];if("string"===typeof e)St(this,e)&&(t=t.concat(this.g.get(Ct(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return It(this),this.i=null,St(this,e=Ct(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),o=this.V(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),e.push(i)}}return this.i=e.join("&")},h(Pt,pe),Pt.prototype.g=function(){return new At(this.l,this.j)},Pt.prototype.i=(mt={},function(){return mt}),h(At,ne),(e=At.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Ot(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||i).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Dt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Ot(this)),this.g&&(this.readyState=3,Ot(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Rt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Dt(this):Ot(this),3==this.readyState&&Rt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Dt(this))},e.Qa=function(e){this.g&&(this.response=e,Dt(this))},e.ga=function(){this.g&&Dt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(At.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),h(Ft,ne);var Ut=/^https?$/i,Vt=["POST","PUT"];function qt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,zt(e),Bt(e)}function zt(e){e.A||(e.A=!0,re(e,"complete"),re(e,"error"))}function jt(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=Wt(e)||2!=e.Z()))if(e.u&&4==Wt(e))se(e.Ea,0,e);else if(re(e,"readystatechange"),4==Wt(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var s;if(s=0===r){var o=String(e.D).match(it)[1]||null;!o&&i.self&&i.self.location&&(o=i.self.location.protocol.slice(0,-1)),s=!Ut.test(o?o.toLowerCase():"")}n=s}if(n)re(e,"complete"),re(e,"success");else{e.m=6;try{var a=2<Wt(e)?e.g.statusText:""}catch(l){a=""}e.l=a+" ["+e.Z()+"]",zt(e)}}finally{Bt(e)}}}function Bt(e,t){if(e.g){$t(e);const n=e.g,r=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||re(e,"ready");try{n.onreadystatechange=r}catch(cx){}}}function $t(e){e.I&&(i.clearTimeout(e.I),e.I=null)}function Wt(e){return e.g?e.g.readyState:0}function Kt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(ql){return null}}function Ht(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Gt(e){this.Aa=0,this.i=[],this.j=new Ne,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ht("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ht("baseRetryDelayMs",5e3,e),this.cb=Ht("retryDelaySeedMs",1e4,e),this.Wa=Ht("forwardChannelMaxRetries",2,e),this.wa=Ht("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Ye(e&&e.concurrentRequestLimit),this.Da=new xt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Qt(e){if(Jt(e),3==e.G){var t=e.U++,n=ot(e.I);if(ct(n,"SID",e.K),ct(n,"RID",t),ct(n,"TYPE","terminate"),en(e,n),(t=new Le(e,e.j,t)).L=2,t.v=ht(ot(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&i.Image&&((new Image).src=t.v,n=!0),n||(t.g=fn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),Be(t)}hn(e)}function Yt(e){e.g&&(sn(e),e.g.cancel(),e.g=null)}function Jt(e){Yt(e),e.u&&(i.clearTimeout(e.u),e.u=null),an(e),e.h.cancel(),e.s&&("number"===typeof e.s&&i.clearTimeout(e.s),e.s=null)}function Xt(e){if(!Je(e.h)&&!e.s){e.s=!0;var t=e.Ga;k||P(),x||(k(),x=!0),N.add(t,e),e.B=0}}function Zt(e,t){var n;n=t?t.l:e.U++;const r=ot(e.I);ct(r,"SID",e.K),ct(r,"RID",n),ct(r,"AID",e.T),en(e,r),e.m&&e.o&&Mt(r,e.m,e.o),n=new Le(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=tn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),Ve(n,r,t)}function en(e,t){e.H&&v(e.H,(function(e,n){ct(t,n,e)})),e.l&&rt({},(function(e,n){ct(t,n,e)}))}function tn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?u(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=i[o].g;const a=i[o].map;if(n-=t,0>n)t=Math.max(0,i[o].g-100),s=!1;else try{Nt(a,e,"req"+n+"_")}catch(Fl){r&&r(a)}}if(s){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function nn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;k||P(),x||(k(),x=!0),N.add(t,e),e.v=0}}function rn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=xe(u(e.Fa,e),un(e,e.v)),e.v++,!0)}function sn(e){null!=e.A&&(i.clearTimeout(e.A),e.A=null)}function on(e){e.g=new Le(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=ot(e.qa);ct(t,"RID","rpc"),ct(t,"SID",e.K),ct(t,"AID",e.T),ct(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ct(t,"TO",e.ja),ct(t,"TYPE","xmlhttp"),en(e,t),e.m&&e.o&&Mt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=ht(ot(t)),n.m=null,n.P=!0,qe(n,e)}function an(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function ln(e,t){var n=null;if(e.g==t){an(e),sn(e),e.g=null;var r=2}else{if(!Ze(e.h,t))return;n=t.D,tt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var i=e.B;re(r=Ie(),new ke(r,n)),Xt(e)}else nn(e);else if(3==(i=t.s)||0==i&&0<t.X||!(1==r&&function(e,t){return!(Xe(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=xe(u(e.Ga,e,t),un(e,e.B)),e.B++,!0))}(e,t)||2==r&&rn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:cn(e,5);break;case 4:cn(e,10);break;case 3:cn(e,6);break;default:cn(e,2)}}function un(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function cn(e,t){if(e.j.info("Error code "+t),2==t){var n=u(e.fb,e),r=e.Xa;const t=!r;r=new st(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||at(r,"https"),ht(r),t?function(e,t){const n=new Ne;if(i.Image){const r=new Image;r.onload=c(kt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=c(kt,n,"TestLoadImage: error",!1,t,r),r.onabort=c(kt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=c(kt,n,"TestLoadImage: timeout",!1,t,r),i.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ne;const n=new AbortController,r=setTimeout((()=>{n.abort(),kt(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(r),e.ok?kt(0,0,!0,t):kt(0,0,!1,t)})).catch((()=>{clearTimeout(r),kt(0,0,!1,t)}))}(r.toString(),n)}else Ce(2);e.G=0,e.l&&e.l.sa(t),hn(e),Jt(e)}function hn(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(f(e.ka,t),f(e.ka,e.i),e.h.i.length=0,d(e.i),e.i.length=0),e.l.ra()}}function dn(e,t,n){var r=n instanceof st?ot(n):new st(n);if(""!=r.g)t&&(r.g=t+"."+r.g),lt(r,r.s);else{var s=i.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var o=new st(null);r&&at(o,r),t&&(o.g=t),s&&lt(o,s),n&&(o.l=n),r=o}return n=e.D,t=e.ya,n&&t&&ct(r,n,t),ct(r,"VER",e.la),en(e,r),r}function fn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Ft(new Pt({eb:n})):new Ft(e.pa)).Ha(e.J),t}function pn(){}function mn(){}function gn(e,t){ne.call(this),this.g=new Gt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new _n(this)}function yn(e){ve.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function vn(){_e.call(this),this.status=1}function _n(e){this.g=e}(e=Ft.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ae.g(),this.v=this.o?me(this.o):me(Ae),this.g.onreadystatechange=u(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(o){return void qt(this,o)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),s=i.FormData&&e instanceof i.FormData,!(0<=Array.prototype.indexOf.call(Vt,t,void 0))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,a]of n)this.g.setRequestHeader(i,a);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{$t(this),this.u=!0,this.g.send(e),this.u=!1}catch(o){qt(this,o)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,re(this,"complete"),re(this,"abort"),Bt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Bt(this,!0)),Ft.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?jt(this):this.bb())},e.bb=function(){jt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<Wt(this)?this.g.status:-1}catch(mt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(mt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),de(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Gt.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Ce(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=dn(this,null,this.W),Xt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new Le(this,this.j,e);let s=this.o;if(this.S&&(s?(s=_(s),b(s,this.S)):s=this.S),null!==this.m||this.O||(i.H=s,s=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=tn(this,i,t),ct(n=ot(this.I),"RID",e),ct(n,"CVER",22),this.D&&ct(n,"X-HTTP-Session-Id",this.D),en(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Lt(s)))+"&"+t:this.m&&Mt(n,this.m,s)),et(this.h,i),this.Ua&&ct(n,"TYPE","init"),this.P?(ct(n,"$req",t),ct(n,"SID","null"),i.T=!0,Ve(i,n,null)):Ve(i,n,t),this.G=2}}else 3==this.G&&(e?Zt(this,e):0==this.i.length||Je(this.h)||Zt(this))},e.Fa=function(){if(this.u=null,on(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=xe(u(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ce(10),Yt(this),on(this))},e.Za=function(){null!=this.C&&(this.C=null,Yt(this),rn(this),Ce(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Ce(2)):(this.j.info("Failed to ping google.com"),Ce(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=pn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},mn.prototype.g=function(e,t){return new gn(e,t)},h(gn,ne),gn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gn.prototype.close=function(){Qt(this.g)},gn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=he(e),e=n);t.i.push(new Qe(t.Ya++,e)),3==t.G&&Xt(t)},gn.prototype.N=function(){this.g.l=null,delete this.j,Qt(this.g),delete this.g,gn.aa.N.call(this)},h(yn,ve),h(vn,_e),h(_n,pn),_n.prototype.ua=function(){re(this.g,"a")},_n.prototype.ta=function(e){re(this.g,new yn(e))},_n.prototype.sa=function(e){re(this.g,new vn)},_n.prototype.ra=function(){re(this.g,"b")},mn.prototype.createWebChannel=mn.prototype.g,gn.prototype.send=gn.prototype.o,gn.prototype.open=gn.prototype.m,gn.prototype.close=gn.prototype.close,Ol=Ml.createWebChannelTransport=function(){return new mn},Dl=Ml.getStatEventTarget=function(){return Ie()},Rl=Ml.Event=we,Al=Ml.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Re.NO_ERROR=0,Re.TIMEOUT=8,Re.HTTP_ERROR=6,Pl=Ml.ErrorCode=Re,De.COMPLETE="complete",Nl=Ml.EventType=De,ge.EventType=ye,ye.OPEN="a",ye.CLOSE="b",ye.ERROR="c",ye.MESSAGE="d",ne.prototype.listen=ne.prototype.K,xl=Ml.WebChannel=ge,Ml.FetchXmlHttpFactory=Pt,Ft.prototype.listenOnce=Ft.prototype.L,Ft.prototype.getLastError=Ft.prototype.Ka,Ft.prototype.getLastErrorCode=Ft.prototype.Ba,Ft.prototype.getStatus=Ft.prototype.Z,Ft.prototype.getResponseJson=Ft.prototype.Oa,Ft.prototype.getResponseText=Ft.prototype.oa,Ft.prototype.send=Ft.prototype.ea,Ft.prototype.setWithCredentials=Ft.prototype.Ha,kl=Ml.XhrIo=Ft}).apply("undefined"!==typeof Ll?Ll:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const Fl="@firebase/firestore";class Ul{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ul.UNAUTHENTICATED=new Ul(null),Ul.GOOGLE_CREDENTIALS=new Ul("google-credentials-uid"),Ul.FIRST_PARTY=new Ul("first-party-uid"),Ul.MOCK_USER=new Ul("mock-user");let Vl="10.14.0";const ql=new Dt("@firebase/firestore");function zl(){return ql.logLevel}function jl(e){if(ql.logLevel<=xt.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Wl);ql.debug(`Firestore (${Vl}): ${e}`,...i)}}function Bl(e){if(ql.logLevel<=xt.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Wl);ql.error(`Firestore (${Vl}): ${e}`,...i)}}function $l(e){if(ql.logLevel<=xt.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Wl);ql.warn(`Firestore (${Vl}): ${e}`,...i)}}function Wl(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function Kl(){const e=`FIRESTORE (${Vl}) INTERNAL ASSERTION FAILED: `+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state");throw Bl(e),new Error(e)}function Hl(e,t){e||Kl()}function Gl(e,t){return e}const Ql={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Yl extends Xe{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Jl{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Xl{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Zl{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ul.UNAUTHENTICATED)))}shutdown(){}}class eu{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class tu{constructor(e){this.t=e,this.currentUser=Ul.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Hl(void 0===this.o);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new Jl;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Jl,e.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{jl("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(jl("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Jl)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(jl("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Hl("string"==typeof t.accessToken),new Xl(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Hl(null===e||"string"==typeof e),new Ul(e)}}class nu{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Ul.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class ru{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new nu(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(Ul.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class iu{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class su{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Hl(void 0===this.o);const n=e=>{null!=e.error&&jl("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,jl("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{jl("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):jl("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Hl("string"==typeof e.token),this.R=e.token,new iu(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function ou(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class au{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=ou(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function lu(e,t){return e<t?-1:e>t?1:0}function uu(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}function cu(e){return e+"\0"}class hu{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Yl(Ql.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Yl(Ql.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Yl(Ql.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Yl(Ql.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return hu.fromMillis(Date.now())}static fromDate(e){return hu.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new hu(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?lu(this.nanoseconds,e.nanoseconds):lu(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class du{constructor(e){this.timestamp=e}static fromTimestamp(e){return new du(e)}static min(){return new du(new hu(0,0))}static max(){return new du(new hu(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class fu{constructor(e,t,n){void 0===t?t=0:t>e.length&&Kl(),void 0===n?n=e.length-t:n>e.length-t&&Kl(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===fu.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof fu?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class pu extends fu{construct(e,t,n){return new pu(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new Yl(Ql.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter((e=>e.length>0)))}return new pu(e)}static emptyPath(){return new pu([])}}const mu=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class gu extends fu{construct(e,t,n){return new gu(e,t,n)}static isValidIdentifier(e){return mu.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gu.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new gu(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Yl(Ql.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Yl(Ql.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Yl(Ql.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new Yl(Ql.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new gu(t)}static emptyPath(){return new gu([])}}class yu{constructor(e){this.path=e}static fromPath(e){return new yu(pu.fromString(e))}static fromName(e){return new yu(pu.fromString(e).popFirst(5))}static empty(){return new yu(pu.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===pu.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return pu.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new yu(new pu(e.slice()))}}class vu{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function _u(e){return e.fields.find((e=>2===e.kind))}function wu(e){return e.fields.filter((e=>2!==e.kind))}vu.UNKNOWN_ID=-1;class bu{constructor(e,t){this.fieldPath=e,this.kind=t}}class Iu{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Iu(0,Tu.min())}}function Eu(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=du.fromTimestamp(1e9===r?new hu(n+1,0):new hu(n,r));return new Tu(i,yu.empty(),t)}function Su(e){return new Tu(e.readTime,e.key,-1)}class Tu{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Tu(du.min(),yu.empty(),-1)}static max(){return new Tu(du.max(),yu.empty(),-1)}}function Cu(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=yu.comparator(e.documentKey,t.documentKey),0!==n?n:lu(e.largestBatchId,t.largestBatchId))}const ku="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class xu{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Nu(e){if(e.code!==Ql.FAILED_PRECONDITION||e.message!==ku)throw e;jl("LocalStore","Unexpectedly lost primary lease")}class Pu{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Kl(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Pu(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Pu?t:Pu.resolve(t)}catch(e){return Pu.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Pu.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Pu.reject(t)}static resolve(e){return new Pu(((t,n)=>{t(e)}))}static reject(e){return new Pu(((t,n)=>{n(e)}))}static waitFor(e){return new Pu(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=Pu.resolve(!1);for(const n of e)t=t.next((e=>e?Pu.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new Pu(((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const l=a;t(e[l]).next((e=>{s[l]=e,++o,o===i&&n(s)}),(e=>r(e)))}}))}static doWhile(e,t){return new Pu(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}class Au{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Jl,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Lu(e,t.error)):this.V.resolve()},this.transaction.onerror=t=>{const n=qu(t.target.error);this.V.reject(new Lu(e,n))}}static open(e,t,n,r){try{return new Au(t,e.transaction(r,n))}catch(e){throw new Lu(t,e)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(jl("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Fu(t)}}class Ru{constructor(e,t,n){this.name=e,this.version=t,this.p=n,12.2===Ru.S(je())&&Bl("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return jl("SimpleDb","Removing database:",e),Uu(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Je())return!1;if(Ru.v())return!0;const e=je(),t=Ru.S(e),n=0<t&&t<10,r=Du(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static v(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.C)}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}async M(e){return this.db||(jl("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new Lu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new Yl(Ql.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new Yl(Ql.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new Lu(e,r))},r.onupgradeneeded=e=>{jl("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.p.O(t,r.transaction,e.oldVersion,this.version).next((()=>{jl("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.N&&(this.db.onversionchange=e=>this.N(e)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.M(e);const t=Au.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).next((e=>(t.g(),e))).catch((e=>(t.abort(e),Pu.reject(e)))).toPromise();return s.catch((()=>{})),await t.m,s}catch(e){const t=e,n="FirebaseError"!==t.name&&s<3;if(jl("SimpleDb","Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Du(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class Ou{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Uu(this.B.delete())}}class Lu extends Yl{constructor(e,t){super(Ql.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Mu(e){return"IndexedDbTransactionError"===e.name}class Fu{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(jl("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(jl("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Uu(n)}add(e){return jl("SimpleDb","ADD",this.store.name,e,e),Uu(this.store.add(e))}get(e){return Uu(this.store.get(e)).next((t=>(void 0===t&&(t=null),jl("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return jl("SimpleDb","DELETE",this.store.name,e),Uu(this.store.delete(e))}count(){return jl("SimpleDb","COUNT",this.store.name),Uu(this.store.count())}U(e,t){const n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const e=r.getAll(n.range);return new Pu(((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}{const e=this.cursor(n),t=[];return this.W(e,((e,n)=>{t.push(n)})).next((()=>t))}}G(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new Pu(((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}}))}j(e,t){jl("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.H=!1;const r=this.cursor(n);return this.W(r,((e,t,n)=>n.delete()))}J(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.W(r,t)}Y(e){const t=this.cursor({});return new Pu(((n,r)=>{t.onerror=e=>{const t=qu(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}W(e,t){const n=[];return new Pu(((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new Ou(i),o=t(i.primaryKey,i.value,s);if(o instanceof Pu){const e=o.catch((e=>(s.done(),Pu.reject(e))));n.push(e)}s.isDone?r():null===s.K?i.continue():i.continue(s.K)}})).next((()=>Pu.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Uu(e){return new Pu(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=qu(e.target.error);n(t)}}))}let Vu=!1;function qu(e){const t=Ru.S(je());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new Yl("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Vu||(Vu=!0,setTimeout((()=>{throw e}),0)),e}}return e}class zu{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}X(e){jl("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{jl("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(e){Mu(e)?jl("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",e):await Nu(e)}await this.X(6e4)}))}}class ju{constructor(e,t){this.localStore=e,this.persistence=t}async ee(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.te(t,e)))}te(e,t){const n=new Set;let r=t,i=!0;return Pu.doWhile((()=>!0===i&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((t=>{if(null!==t&&!n.has(t))return jl("IndexBackfiller",`Processing collection: ${t}`),this.ne(e,t,r).next((e=>{r-=e,n.add(t)}));i=!1})))).next((()=>t-r))}ne(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next((n=>{const i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next((()=>this.re(r,n))).next((n=>(jl("IndexBackfiller",`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n)))).next((()=>i.size))}))))}re(e,t){let n=e;return t.changes.forEach(((e,t)=>{const r=Su(t);Cu(r,n)>0&&(n=r)})),new Tu(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Bu{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function $u(e){return null==e}function Wu(e){return 0===e&&1/e==-1/0}function Ku(e){return"number"==typeof e&&Number.isInteger(e)&&!Wu(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function Hu(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Qu(t)),t=Gu(e.get(n),t);return Qu(t)}function Gu(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=t}}return n}function Qu(e){return e+"\x01\x01"}function Yu(e){const t=e.length;if(Hl(t>=2),2===t)return Hl("\x01"===e.charAt(0)&&"\x01"===e.charAt(1)),pu.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf("\x01",s);switch((t<0||t>n)&&Kl(),e.charAt(t+1)){case"\x01":const n=e.substring(s,t);let o;0===i.length?o=n:(i+=n,o=i,i=""),r.push(o);break;case"\x10":i+=e.substring(s,t),i+="\0";break;case"\x11":i+=e.substring(s,t+1);break;default:Kl()}s=t+2}return new pu(r)}Bu.oe=-1;const Ju=["userId","batchId"];function Xu(e,t){return[e,Hu(t)]}function Zu(e,t,n){return[e,Hu(t),n]}const ec={},tc=["prefixPath","collectionGroup","readTime","documentId"],nc=["prefixPath","collectionGroup","documentId"],rc=["collectionGroup","readTime","prefixPath","documentId"],ic=["canonicalId","targetId"],sc=["targetId","path"],oc=["path","targetId"],ac=["collectionId","parent"],lc=["indexId","uid"],uc=["uid","sequenceNumber"],cc=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],hc=["indexId","uid","orderedDocumentKey"],dc=["userId","collectionPath","documentId"],fc=["userId","collectionPath","largestBatchId"],pc=["userId","collectionGroup","largestBatchId"],mc=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],gc=[...mc,"documentOverlays"],yc=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],vc=yc,_c=[...vc,"indexConfiguration","indexState","indexEntries"],wc=_c,bc=[..._c,"globals"];class Ic extends xu{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function Ec(e,t){const n=Gl(e);return Ru.F(n._e,t)}function Sc(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Tc(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Cc(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class kc{constructor(e,t){this.comparator=e,this.root=t||Nc.EMPTY}insert(e,t){return new kc(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Nc.BLACK,null,null))}remove(e){return new kc(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Nc.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new xc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new xc(this.root,e,this.comparator,!1)}getReverseIterator(){return new xc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new xc(this.root,e,this.comparator,!0)}}class xc{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Nc{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Nc.RED,this.left=null!=r?r:Nc.EMPTY,this.right=null!=i?i:Nc.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Nc(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Nc.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Nc.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Nc.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Nc.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Kl();if(this.right.isRed())throw Kl();const e=this.left.check();if(e!==this.right.check())throw Kl();return e+(this.isRed()?0:1)}}Nc.EMPTY=null,Nc.RED=!0,Nc.BLACK=!1,Nc.EMPTY=new class{constructor(){this.size=0}get key(){throw Kl()}get value(){throw Kl()}get color(){throw Kl()}get left(){throw Kl()}get right(){throw Kl()}copy(e,t,n,r,i){return this}insert(e,t,n){return new Nc(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Pc{constructor(e){this.comparator=e,this.data=new kc(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ac(this.data.getIterator())}getIteratorFrom(e){return new Ac(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof Pc))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Pc(this.comparator);return t.data=e,t}}class Ac{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Rc(e){return e.hasNext()?e.getNext():void 0}class Dc{constructor(e){this.fields=e,e.sort(gu.comparator)}static empty(){return new Dc([])}unionWith(e){let t=new Pc(gu.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Dc(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return uu(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Oc extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Lc{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Oc("Invalid base64 string: "+e):e}}(e);return new Lc(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Lc(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return lu(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Lc.EMPTY_BYTE_STRING=new Lc("");const Mc=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fc(e){if(Hl(!!e),"string"==typeof e){let t=0;const n=Mc.exec(e);if(Hl(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Uc(e.seconds),nanos:Uc(e.nanos)}}function Uc(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Vc(e){return"string"==typeof e?Lc.fromBase64String(e):Lc.fromUint8Array(e)}function qc(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function zc(e){const t=e.mapValue.fields.__previous_value__;return qc(t)?zc(t):t}function jc(e){const t=Fc(e.mapValue.fields.__local_write_time__.timestampValue);return new hu(t.seconds,t.nanos)}class Bc{constructor(e,t,n,r,i,s,o,a,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l}}class $c{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new $c("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof $c&&e.projectId===this.projectId&&e.database===this.database}}const Wc={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Kc={nullValue:"NULL_VALUE"};function Hc(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?qc(e)?4:uh(e)?9007199254740991:ah(e)?10:11:Kl()}function Gc(e,t){if(e===t)return!0;const n=Hc(e);if(n!==Hc(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return jc(e).isEqual(jc(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Fc(e.timestampValue),r=Fc(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Vc(e.bytesValue).isEqual(Vc(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Uc(e.geoPointValue.latitude)===Uc(t.geoPointValue.latitude)&&Uc(e.geoPointValue.longitude)===Uc(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Uc(e.integerValue)===Uc(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Uc(e.doubleValue),r=Uc(t.doubleValue);return n===r?Wu(n)===Wu(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return uu(e.arrayValue.values||[],t.arrayValue.values||[],Gc);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Sc(n)!==Sc(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Gc(n[i],r[i])))return!1;return!0}(e,t);default:return Kl()}}function Qc(e,t){return void 0!==(e.values||[]).find((e=>Gc(e,t)))}function Yc(e,t){if(e===t)return 0;const n=Hc(e),r=Hc(t);if(n!==r)return lu(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return lu(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Uc(e.integerValue||e.doubleValue),r=Uc(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Jc(e.timestampValue,t.timestampValue);case 4:return Jc(jc(e),jc(t));case 5:return lu(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Vc(e),r=Vc(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=lu(n[i],r[i]);if(0!==e)return e}return lu(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=lu(Uc(e.latitude),Uc(t.latitude));return 0!==n?n:lu(Uc(e.longitude),Uc(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Xc(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,s;const o=e.fields||{},a=t.fields||{},l=null===(n=o.value)||void 0===n?void 0:n.arrayValue,u=null===(r=a.value)||void 0===r?void 0:r.arrayValue,c=lu((null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0,(null===(s=null==u?void 0:u.values)||void 0===s?void 0:s.length)||0);return 0!==c?c:Xc(l,u)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Wc.mapValue&&t===Wc.mapValue)return 0;if(e===Wc.mapValue)return 1;if(t===Wc.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const e=lu(r[o],s[o]);if(0!==e)return e;const t=Yc(n[r[o]],i[s[o]]);if(0!==t)return t}return lu(r.length,s.length)}(e.mapValue,t.mapValue);default:throw Kl()}}function Jc(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return lu(e,t);const n=Fc(e),r=Fc(t),i=lu(n.seconds,r.seconds);return 0!==i?i:lu(n.nanos,r.nanos)}function Xc(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=Yc(n[i],r[i]);if(e)return e}return lu(n.length,r.length)}function Zc(e){return eh(e)}function eh(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Fc(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Vc(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return yu.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=eh(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${eh(e.fields[i])}`;return n+"}"}(e.mapValue):Kl()}function th(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function nh(e){return!!e&&"integerValue"in e}function rh(e){return!!e&&"arrayValue"in e}function ih(e){return!!e&&"nullValue"in e}function sh(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function oh(e){return!!e&&"mapValue"in e}function ah(e){var t,n;return"__vector__"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function lh(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Tc(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=lh(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=lh(e.arrayValue.values[n]);return t}return Object.assign({},e)}function uh(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}const ch={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function hh(e){return"nullValue"in e?Kc:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?th($c.empty(),yu.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?ah(e)?ch:{mapValue:{}}:Kl()}function dh(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?th($c.empty(),yu.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?ch:"mapValue"in e?ah(e)?{mapValue:{}}:Wc:Kl()}function fh(e,t){const n=Yc(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function ph(e,t){const n=Yc(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class mh{constructor(e){this.value=e}static empty(){return new mh({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!oh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=lh(t)}setAll(e){let t=gu.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=lh(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());oh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Gc(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];oh(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Tc(t,((t,n)=>e[t]=n));for(const r of n)delete e[r]}clone(){return new mh(lh(this.value))}}function gh(e){const t=[];return Tc(e.fields,((e,n)=>{const r=new gu([e]);if(oh(n)){const e=gh(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new Dc(t)}class yh{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new yh(e,0,du.min(),du.min(),du.min(),mh.empty(),0)}static newFoundDocument(e,t,n,r){return new yh(e,1,t,du.min(),n,r,0)}static newNoDocument(e,t){return new yh(e,2,t,du.min(),du.min(),mh.empty(),0)}static newUnknownDocument(e,t){return new yh(e,3,t,du.min(),du.min(),mh.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(du.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=mh.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=mh.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=du.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof yh&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new yh(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class vh{constructor(e,t){this.position=e,this.inclusive=t}}function _h(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?yu.comparator(yu.fromName(o.referenceValue),n.key):Yc(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function wh(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Gc(e.position[n],t.position[n]))return!1;return!0}class bh{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function Ih(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Eh{}class Sh extends Eh{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Oh(e,t,n):"array-contains"===t?new Uh(e,n):"in"===t?new Vh(e,n):"not-in"===t?new qh(e,n):"array-contains-any"===t?new zh(e,n):new Sh(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Lh(e,n):new Mh(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Yc(t,this.value)):null!==t&&Hc(this.value)===Hc(t)&&this.matchesComparison(Yc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Kl()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Th extends Eh{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Th(e,t)}matches(e){return Ch(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Ch(e){return"and"===e.op}function kh(e){return"or"===e.op}function xh(e){return Nh(e)&&Ch(e)}function Nh(e){for(const t of e.filters)if(t instanceof Th)return!1;return!0}function Ph(e){if(e instanceof Sh)return e.field.canonicalString()+e.op.toString()+Zc(e.value);if(xh(e))return e.filters.map((e=>Ph(e))).join(",");{const t=e.filters.map((e=>Ph(e))).join(",");return`${e.op}(${t})`}}function Ah(e,t){return e instanceof Sh?function(e,t){return t instanceof Sh&&e.op===t.op&&e.field.isEqual(t.field)&&Gc(e.value,t.value)}(e,t):e instanceof Th?function(e,t){return t instanceof Th&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&Ah(n,t.filters[r])),!0)}(e,t):void Kl()}function Rh(e,t){const n=e.filters.concat(t);return Th.create(n,e.op)}function Dh(e){return e instanceof Sh?function(e){return`${e.field.canonicalString()} ${e.op} ${Zc(e.value)}`}(e):e instanceof Th?function(e){return e.op.toString()+" {"+e.getFilters().map(Dh).join(" ,")+"}"}(e):"Filter"}class Oh extends Sh{constructor(e,t,n){super(e,t,n),this.key=yu.fromName(n.referenceValue)}matches(e){const t=yu.comparator(e.key,this.key);return this.matchesComparison(t)}}class Lh extends Sh{constructor(e,t){super(e,"in",t),this.keys=Fh("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Mh extends Sh{constructor(e,t){super(e,"not-in",t),this.keys=Fh("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Fh(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>yu.fromName(e.referenceValue)))}class Uh extends Sh{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return rh(t)&&Qc(t.arrayValue,this.value)}}class Vh extends Sh{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Qc(this.value.arrayValue,t)}}class qh extends Sh{constructor(e,t){super(e,"not-in",t)}matches(e){if(Qc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Qc(this.value.arrayValue,t)}}class zh extends Sh{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!rh(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Qc(this.value.arrayValue,e)))}}class jh{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.ue=null}}function Bh(e){return new jh(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function $h(e){const t=Gl(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>Ph(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),$u(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Zc(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Zc(e))).join(",")),t.ue=e}return t.ue}function Wh(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Ih(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Ah(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!wh(e.startAt,t.startAt)&&wh(e.endAt,t.endAt)}function Kh(e){return yu.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Hh(e,t){return e.filters.filter((e=>e instanceof Sh&&e.field.isEqual(t)))}function Gh(e,t,n){let r=Kc,i=!0;for(const s of Hh(e,t)){let e=Kc,t=!0;switch(s.op){case"<":case"<=":e=hh(s.value);break;case"==":case"in":case">=":e=s.value;break;case">":e=s.value,t=!1;break;case"!=":case"not-in":e=Kc}fh({value:r,inclusive:i},{value:e,inclusive:t})<0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];fh({value:r,inclusive:i},{value:e,inclusive:n.inclusive})<0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}function Qh(e,t,n){let r=Wc,i=!0;for(const s of Hh(e,t)){let e=Wc,t=!0;switch(s.op){case">=":case">":e=dh(s.value),t=!1;break;case"==":case"in":case"<=":e=s.value;break;case"<":e=s.value,t=!1;break;case"!=":case"not-in":e=Wc}ph({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];ph({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}class Yh{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Jh(e,t,n,r,i,s,o,a){return new Yh(e,t,n,r,i,s,o,a)}function Xh(e){return new Yh(e)}function Zh(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function ed(e){return null!==e.collectionGroup}function td(e){const t=Gl(e);if(null===t.ce){t.ce=[];const e=new Set;for(const i of t.explicitOrderBy)t.ce.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new Pc(gu.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.ce.push(new bh(r,n))})),e.has(gu.keyField().canonicalString())||t.ce.push(new bh(gu.keyField(),n))}return t.ce}function nd(e){const t=Gl(e);return t.le||(t.le=rd(t,td(e))),t.le}function rd(e,t){if("F"===e.limitType)return Bh(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new bh(e.field,t)}));const n=e.endAt?new vh(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new vh(e.startAt.position,e.startAt.inclusive):null;return Bh(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function id(e,t){const n=e.filters.concat([t]);return new Yh(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function sd(e,t,n){return new Yh(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function od(e,t){return Wh(nd(e),nd(t))&&e.limitType===t.limitType}function ad(e){return`${$h(nd(e))}|lt:${e.limitType}`}function ld(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>Dh(e))).join(", ")}]`),$u(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Zc(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Zc(e))).join(",")),`Target(${t})`}(nd(e))}; limitType=${e.limitType})`}function ud(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):yu.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of td(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=_h(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,td(e),t))&&!(e.endAt&&!function(e,t,n){const r=_h(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,td(e),t))}(e,t)}function cd(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function hd(e){return(t,n)=>{let r=!1;for(const i of td(e)){const e=dd(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function dd(e,t,n){const r=e.field.isKeyField()?yu.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?Yc(r,i):Kl()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Kl()}}class fd{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Tc(this.inner,((t,n)=>{for(const[r,i]of n)e(r,i)}))}isEmpty(){return Cc(this.inner)}size(){return this.innerSize}}const pd=new kc(yu.comparator);function md(){return pd}const gd=new kc(yu.comparator);function yd(){let e=gd;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function vd(e){let t=gd;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function _d(){return bd()}function wd(){return bd()}function bd(){return new fd((e=>e.toString()),((e,t)=>e.isEqual(t)))}const Id=new kc(yu.comparator),Ed=new Pc(yu.comparator);function Sd(){let e=Ed;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const Td=new Pc(lu);function Cd(){return Td}function kd(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Wu(t)?"-0":t}}function xd(e){return{integerValue:""+e}}function Nd(e,t){return Ku(t)?xd(t):kd(e,t)}class Pd{constructor(){this._=void 0}}function Ad(e,t,n){return e instanceof Od?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&qc(t)&&(t=zc(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Ld?Md(e,t):e instanceof Fd?Ud(e,t):function(e,t){const n=Dd(e,t),r=qd(n)+qd(e.Pe);return nh(n)&&nh(e.Pe)?xd(r):kd(e.serializer,r)}(e,t)}function Rd(e,t,n){return e instanceof Ld?Md(e,t):e instanceof Fd?Ud(e,t):n}function Dd(e,t){return e instanceof Vd?function(e){return nh(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Od extends Pd{}class Ld extends Pd{constructor(e){super(),this.elements=e}}function Md(e,t){const n=zd(t);for(const r of e.elements)n.some((e=>Gc(e,r)))||n.push(r);return{arrayValue:{values:n}}}class Fd extends Pd{constructor(e){super(),this.elements=e}}function Ud(e,t){let n=zd(t);for(const r of e.elements)n=n.filter((e=>!Gc(e,r)));return{arrayValue:{values:n}}}class Vd extends Pd{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function qd(e){return Uc(e.integerValue||e.doubleValue)}function zd(e){return rh(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class jd{constructor(e,t){this.field=e,this.transform=t}}class Bd{constructor(e,t){this.version=e,this.transformResults=t}}class $d{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new $d}static exists(e){return new $d(void 0,e)}static updateTime(e){return new $d(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Wd(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Kd{}function Hd(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new rf(e.key,$d.none()):new Xd(e.key,e.data,$d.none());{const n=e.data,r=mh.empty();let i=new Pc(gu.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Zd(e.key,r,new Dc(i.toArray()),$d.none())}}function Gd(e,t,n){e instanceof Xd?function(e,t,n){const r=e.value.clone(),i=tf(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Zd?function(e,t,n){if(!Wd(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=tf(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(ef(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Qd(e,t,n,r){return e instanceof Xd?function(e,t,n,r){if(!Wd(e.precondition,t))return n;const i=e.value.clone(),s=nf(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Zd?function(e,t,n,r){if(!Wd(e.precondition,t))return n;const i=nf(e.fieldTransforms,r,t),s=t.data;return s.setAll(ef(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return Wd(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Yd(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Dd(r.transform,e||null);null!=i&&(null===n&&(n=mh.empty()),n.set(r.field,i))}return n||null}function Jd(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&uu(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Ld&&t instanceof Ld||e instanceof Fd&&t instanceof Fd?uu(e.elements,t.elements,Gc):e instanceof Vd&&t instanceof Vd?Gc(e.Pe,t.Pe):e instanceof Od&&t instanceof Od}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Xd extends Kd{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Zd extends Kd{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function ef(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function tf(e,t,n){const r=new Map;Hl(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,Rd(o,a,n[i]))}return r}function nf(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,Ad(e,s,t))}return r}class rf extends Kd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class sf extends Kd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class of{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Gd(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Qd(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Qd(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=wd();return this.mutations.forEach((r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=Hd(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(du.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Sd())}isEqual(e){return this.batchId===e.batchId&&uu(this.mutations,e.mutations,((e,t)=>Jd(e,t)))&&uu(this.baseMutations,e.baseMutations,((e,t)=>Jd(e,t)))}}class af{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Hl(e.mutations.length===n.length);let r=Id;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new af(e,t,n,r)}}class lf{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class uf{constructor(e,t){this.count=e,this.unchangedNames=t}}var cf,hf;function df(e){switch(e){default:return Kl();case Ql.CANCELLED:case Ql.UNKNOWN:case Ql.DEADLINE_EXCEEDED:case Ql.RESOURCE_EXHAUSTED:case Ql.INTERNAL:case Ql.UNAVAILABLE:case Ql.UNAUTHENTICATED:return!1;case Ql.INVALID_ARGUMENT:case Ql.NOT_FOUND:case Ql.ALREADY_EXISTS:case Ql.PERMISSION_DENIED:case Ql.FAILED_PRECONDITION:case Ql.ABORTED:case Ql.OUT_OF_RANGE:case Ql.UNIMPLEMENTED:case Ql.DATA_LOSS:return!0}}function ff(e){if(void 0===e)return Bl("GRPC error has no .code"),Ql.UNKNOWN;switch(e){case cf.OK:return Ql.OK;case cf.CANCELLED:return Ql.CANCELLED;case cf.UNKNOWN:return Ql.UNKNOWN;case cf.DEADLINE_EXCEEDED:return Ql.DEADLINE_EXCEEDED;case cf.RESOURCE_EXHAUSTED:return Ql.RESOURCE_EXHAUSTED;case cf.INTERNAL:return Ql.INTERNAL;case cf.UNAVAILABLE:return Ql.UNAVAILABLE;case cf.UNAUTHENTICATED:return Ql.UNAUTHENTICATED;case cf.INVALID_ARGUMENT:return Ql.INVALID_ARGUMENT;case cf.NOT_FOUND:return Ql.NOT_FOUND;case cf.ALREADY_EXISTS:return Ql.ALREADY_EXISTS;case cf.PERMISSION_DENIED:return Ql.PERMISSION_DENIED;case cf.FAILED_PRECONDITION:return Ql.FAILED_PRECONDITION;case cf.ABORTED:return Ql.ABORTED;case cf.OUT_OF_RANGE:return Ql.OUT_OF_RANGE;case cf.UNIMPLEMENTED:return Ql.UNIMPLEMENTED;case cf.DATA_LOSS:return Ql.DATA_LOSS;default:return Kl()}}(hf=cf||(cf={}))[hf.OK=0]="OK",hf[hf.CANCELLED=1]="CANCELLED",hf[hf.UNKNOWN=2]="UNKNOWN",hf[hf.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",hf[hf.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",hf[hf.NOT_FOUND=5]="NOT_FOUND",hf[hf.ALREADY_EXISTS=6]="ALREADY_EXISTS",hf[hf.PERMISSION_DENIED=7]="PERMISSION_DENIED",hf[hf.UNAUTHENTICATED=16]="UNAUTHENTICATED",hf[hf.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",hf[hf.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",hf[hf.ABORTED=10]="ABORTED",hf[hf.OUT_OF_RANGE=11]="OUT_OF_RANGE",hf[hf.UNIMPLEMENTED=12]="UNIMPLEMENTED",hf[hf.INTERNAL=13]="INTERNAL",hf[hf.UNAVAILABLE=14]="UNAVAILABLE",hf[hf.DATA_LOSS=15]="DATA_LOSS";let pf=null;function mf(){return new TextEncoder}const gf=new El([4294967295,4294967295],0);function yf(e){const t=mf().encode(e),n=new Sl;return n.update(t),new Uint8Array(n.digest())}function vf(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new El([n,r],0),new El([i,s],0)]}class _f{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new wf(`Invalid padding: ${t}`);if(n<0)throw new wf(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new wf(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new wf(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=El.fromNumber(this.Ie)}Ee(e,t,n){let r=e.add(t.multiply(El.fromNumber(n)));return 1===r.compare(gf)&&(r=new El([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=yf(e),[n,r]=vf(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);if(!this.de(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new _f(i,r,t);return n.forEach((e=>s.insert(e))),s}insert(e){if(0===this.Ie)return;const t=yf(e),[n,r]=vf(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);this.Ae(e)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class wf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class bf{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,If.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new bf(du.min(),r,new kc(lu),md(),Sd())}}class If{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new If(n,t,Sd(),Sd(),Sd())}}class Ef{constructor(e,t,n,r){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=r}}class Sf{constructor(e,t){this.targetId=e,this.me=t}}class Tf{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Lc.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Cf{constructor(){this.fe=0,this.ge=Nf(),this.pe=Lc.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Sd(),t=Sd(),n=Sd();return this.ge.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Kl()}})),new If(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=Nf()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Hl(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class kf{constructor(e){this.Le=e,this.Be=new Map,this.ke=md(),this.qe=xf(),this.Qe=new kc(lu)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,(t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:Kl()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(((e,n)=>{this.ze(n)&&t(n)}))}He(e){const t=e.targetId,n=e.me.count,r=this.Je(t);if(r){const i=r.target;if(Kh(i))if(0===n){const e=new yu(i.path);this.Ue(t,e,yh.newNoDocument(e,du.min()))}else Hl(1===n);else{const r=this.Ye(t);if(r!==n){const n=this.Ze(e),i=n?this.Xe(n,e,r):1;if(0!==i){this.je(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,e)}null==pf||pf.et(function(e,t,n,r,i){var s,o,a,l,u,c;const h={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},d=t.unchangedNames;return d&&(h.bloomFilter={applied:0===i,hashCount:null!==(s=null==d?void 0:d.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(l=null===(a=null===(o=null==d?void 0:d.bits)||void 0===o?void 0:o.bitmap)||void 0===a?void 0:a.length)&&void 0!==l?l:0,padding:null!==(c=null===(u=null==d?void 0:d.bits)||void 0===u?void 0:u.padding)&&void 0!==c?c:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),h}(r,e.me,this.Le.tt(),n,i))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,o;try{s=Vc(n).toUint8Array()}catch(e){if(e instanceof Oc)return $l("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new _f(s,r,i)}catch(e){return $l(e instanceof wf?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.Ie?null:o}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const i=this.Le.tt(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(s)||(this.Ue(t,n,null),r++)})),r}rt(e){const t=new Map;this.Be.forEach(((n,r)=>{const i=this.Je(r);if(i){if(n.current&&Kh(i.target)){const t=new yu(i.target.path);null!==this.ke.get(t)||this.it(r,t)||this.Ue(r,t,yh.newNoDocument(t,e))}n.be&&(t.set(r,n.ve()),n.Ce())}}));let n=Sd();this.qe.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Je(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.ke.forEach(((t,n)=>n.setReadTime(e)));const r=new bf(e,t,this.Qe,this.ke,n);return this.ke=md(),this.qe=xf(),this.Qe=new kc(lu),r}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Cf,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Pc(lu),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||jl("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Cf),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.Ue(e,t,null)}))}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function xf(){return new kc(yu.comparator)}function Nf(){return new kc(yu.comparator)}const Pf={asc:"ASCENDING",desc:"DESCENDING"},Af={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Rf={and:"AND",or:"OR"};class Df{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Of(e,t){return e.useProto3Json||$u(t)?t:{value:t}}function Lf(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Mf(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Ff(e,t){return Lf(e,t.toTimestamp())}function Uf(e){return Hl(!!e),du.fromTimestamp(function(e){const t=Fc(e);return new hu(t.seconds,t.nanos)}(e))}function Vf(e,t){return qf(e,t).canonicalString()}function qf(e,t){const n=function(e){return new pu(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function zf(e){const t=pu.fromString(e);return Hl(up(t)),t}function jf(e,t){return Vf(e.databaseId,t.path)}function Bf(e,t){const n=zf(t);if(n.get(1)!==e.databaseId.projectId)throw new Yl(Ql.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Yl(Ql.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new yu(Hf(n))}function $f(e,t){return Vf(e.databaseId,t)}function Wf(e){const t=zf(e);return 4===t.length?pu.emptyPath():Hf(t)}function Kf(e){return new pu(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Hf(e){return Hl(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Gf(e,t,n){return{name:jf(e,t),fields:n.value.mapValue.fields}}function Qf(e,t,n){const r=Bf(e,t.name),i=Uf(t.updateTime),s=t.createTime?Uf(t.createTime):du.min(),o=new mh({mapValue:{fields:t.fields}}),a=yh.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function Yf(e,t){let n;if(t instanceof Xd)n={update:Gf(e,t.key,t.value)};else if(t instanceof rf)n={delete:jf(e,t.key)};else if(t instanceof Zd)n={update:Gf(e,t.key,t.data),updateMask:lp(t.fieldMask)};else{if(!(t instanceof sf))return Kl();n={verify:jf(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof Od)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ld)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Fd)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Vd)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw Kl()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Ff(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Kl()}(e,t.precondition)),n}function Jf(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?$d.updateTime(Uf(e.updateTime)):void 0!==e.exists?$d.exists(e.exists):$d.none()}(t.currentDocument):$d.none(),r=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)Hl("REQUEST_TIME"===t.setToServerValue),n=new Od;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new Ld(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new Fd(e)}else"increment"in t?n=new Vd(e,t.increment):Kl();const r=gu.fromServerFormat(t.fieldPath);return new jd(r,n)}(e,t))):[];if(t.update){t.update.name;const i=Bf(e,t.update.name),s=new mh({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new Dc(t.map((e=>gu.fromServerFormat(e))))}(t.updateMask);return new Zd(i,s,e,n,r)}return new Xd(i,s,n,r)}if(t.delete){const r=Bf(e,t.delete);return new rf(r,n)}if(t.verify){const r=Bf(e,t.verify);return new sf(r,n)}return Kl()}function Xf(e,t){return{documents:[$f(e,t.path)]}}function Zf(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=$f(e,i);const s=function(e){if(0!==e.length)return ap(Th.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:sp(e.field),direction:np(e.dir)}}(e)))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Of(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:n,parent:i}}function ep(e){let t=Wf(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Hl(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=tp(e);return t instanceof Th&&xh(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new bh(op(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,$u(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new vh(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new vh(n,t)}(n.endAt)),Jh(t,i,o,s,a,"F",l,u)}function tp(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=op(e.unaryFilter.field);return Sh.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=op(e.unaryFilter.field);return Sh.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=op(e.unaryFilter.field);return Sh.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=op(e.unaryFilter.field);return Sh.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Kl()}}(e):void 0!==e.fieldFilter?function(e){return Sh.create(op(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Kl()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Th.create(e.compositeFilter.filters.map((e=>tp(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Kl()}}(e.compositeFilter.op))}(e):Kl()}function np(e){return Pf[e]}function rp(e){return Af[e]}function ip(e){return Rf[e]}function sp(e){return{fieldPath:e.canonicalString()}}function op(e){return gu.fromServerFormat(e.fieldPath)}function ap(e){return e instanceof Sh?function(e){if("=="===e.op){if(sh(e.value))return{unaryFilter:{field:sp(e.field),op:"IS_NAN"}};if(ih(e.value))return{unaryFilter:{field:sp(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(sh(e.value))return{unaryFilter:{field:sp(e.field),op:"IS_NOT_NAN"}};if(ih(e.value))return{unaryFilter:{field:sp(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:sp(e.field),op:rp(e.op),value:e.value}}}(e):e instanceof Th?function(e){const t=e.getFilters().map((e=>ap(e)));return 1===t.length?t[0]:{compositeFilter:{op:ip(e.op),filters:t}}}(e):Kl()}function lp(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function up(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class cp{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:du.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:du.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Lc.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new cp(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new cp(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new cp(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new cp(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class hp{constructor(e){this.ct=e}}function dp(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:fp(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:jf(e,t.key),fields:t.data.value.mapValue.fields,updateTime:Lf(e,t.version.toTimestamp()),createTime:Lf(e,t.createTime.toTimestamp())}}(e.ct,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:pp(t.version)};else{if(!t.isUnknownDocument())return Kl();r.unknownDocument={path:n.path.toArray(),version:pp(t.version)}}return r}function fp(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function pp(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function mp(e){const t=new hu(e.seconds,e.nanoseconds);return du.fromTimestamp(t)}function gp(e,t){const n=(t.baseMutations||[]).map((t=>Jf(e.ct,t)));for(let s=0;s<t.mutations.length-1;++s){const e=t.mutations[s];if(s+1<t.mutations.length&&void 0!==t.mutations[s+1].transform){const n=t.mutations[s+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(s+1,1),++s}}const r=t.mutations.map((t=>Jf(e.ct,t))),i=hu.fromMillis(t.localWriteTimeMs);return new of(t.batchId,i,n,r)}function yp(e){const t=mp(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?mp(e.lastLimboFreeSnapshotVersion):du.min();let r;return r=function(e){return void 0!==e.documents}(e.query)?function(e){return Hl(1===e.documents.length),nd(Xh(Wf(e.documents[0])))}(e.query):function(e){return nd(ep(e))}(e.query),new cp(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,Lc.fromBase64String(e.resumeToken))}function vp(e,t){const n=pp(t.snapshotVersion),r=pp(t.lastLimboFreeSnapshotVersion);let i;i=Kh(t.target)?Xf(e.ct,t.target):Zf(e.ct,t.target)._t;const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:$h(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function _p(e){const t=ep({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?sd(t,t.limit,"L"):t}function wp(e,t){return new lf(t.largestBatchId,Jf(e.ct,t.overlayMutation))}function bp(e,t){const n=t.path.lastSegment();return[e,Hu(t.path.popLast()),n]}function Ip(e,t,n,r){return{indexId:e,uid:t,sequenceNumber:n,readTime:pp(r.readTime),documentKey:Hu(r.documentKey.path),largestBatchId:r.largestBatchId}}class Ep{getBundleMetadata(e,t){return Sp(e).get(t).next((e=>{if(e)return function(e){return{id:e.bundleId,createTime:mp(e.createTime),version:e.version}}(e)}))}saveBundleMetadata(e,t){return Sp(e).put(function(e){return{bundleId:e.id,createTime:pp(Uf(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return Tp(e).get(t).next((e=>{if(e)return function(e){return{name:e.name,query:_p(e.bundledQuery),readTime:mp(e.readTime)}}(e)}))}saveNamedQuery(e,t){return Tp(e).put(function(e){return{name:e.name,readTime:pp(Uf(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function Sp(e){return Ec(e,"bundles")}function Tp(e){return Ec(e,"namedQueries")}class Cp{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const n=t.uid||"";return new Cp(e,n)}getOverlay(e,t){return kp(e).get(bp(this.userId,t)).next((e=>e?wp(this.serializer,e):null))}getOverlays(e,t){const n=_d();return Pu.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){const r=[];return n.forEach(((n,i)=>{const s=new lf(t,i);r.push(this.ht(e,s))})),Pu.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach((e=>r.add(Hu(e.getCollectionPath()))));const i=[];return r.forEach((t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(kp(e).j("collectionPathOverlayIndex",r))})),Pu.waitFor(i)}getOverlaysForCollection(e,t,n){const r=_d(),i=Hu(t),s=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return kp(e).U("collectionPathOverlayIndex",s).next((e=>{for(const t of e){const e=wp(this.serializer,t);r.set(e.getKey(),e)}return r}))}getOverlaysForCollectionGroup(e,t,n,r){const i=_d();let s;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return kp(e).J({index:"collectionGroupOverlayIndex",range:o},((e,t,n)=>{const o=wp(this.serializer,t);i.size()<r||o.largestBatchId===s?(i.set(o.getKey(),o),s=o.largestBatchId):n.done()})).next((()=>i))}ht(e,t){return kp(e).put(function(e,t,n){const[r,i,s]=bp(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:Yf(e.ct,n.mutation)}}(this.serializer,this.userId,t))}}function kp(e){return Ec(e,"documentOverlays")}class xp{Pt(e){return Ec(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next((e=>{const t=null==e?void 0:e.value;return t?Lc.fromUint8Array(t):Lc.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Np{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Uc(e.integerValue));else if("doubleValue"in e){const n=Uc(e.doubleValue);isNaN(n)?this.dt(t,13):(this.dt(t,15),Wu(n)?t.At(0):t.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(t,20),"string"==typeof n&&(n=Fc(n)),t.Rt(`${n.seconds||""}`),t.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Vc(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(t,45),t.At(n.latitude||0),t.At(n.longitude||0)}else"mapValue"in e?uh(e)?this.dt(t,Number.MAX_SAFE_INTEGER):ah(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Kl()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const n=e.fields||{};this.dt(t,55);for(const r of Object.keys(n))this.Vt(r,t),this.Tt(n[r],t)}wt(e,t){var n,r;const i=e.fields||{};this.dt(t,53);const s="value",o=(null===(r=null===(n=i[s].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.dt(t,15),t.At(Uc(o)),this.Vt(s,t),this.Tt(i[s],t)}bt(e,t){const n=e.values||[];this.dt(t,50);for(const r of n)this.Tt(r,t)}yt(e,t){this.dt(t,37),yu.fromName(e).path.forEach((e=>{this.dt(t,60),this.Dt(e,t)}))}dt(e,t){e.At(t)}ft(e){e.At(2)}}function Pp(e){if(0===e)return 8;let t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function Ap(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=Pp(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}Np.vt=new Np;class Rp{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ft(n.value),n=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ot(n.value),n=t.next();this.Nt()}Lt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ft(e);else if(e<2048)this.Ft(960|e>>>6),this.Ft(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ft(480|e>>>12),this.Ft(128|63&e>>>6),this.Ft(128|63&e);else{const e=t.codePointAt(0);this.Ft(240|e>>>18),this.Ft(128|63&e>>>12),this.Ft(128|63&e>>>6),this.Ft(128|63&e)}}this.Mt()}Bt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ot(e);else if(e<2048)this.Ot(960|e>>>6),this.Ot(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ot(480|e>>>12),this.Ot(128|63&e>>>6),this.Ot(128|63&e);else{const e=t.codePointAt(0);this.Ot(240|e>>>18),this.Ot(128|63&e>>>12),this.Ot(128|63&e>>>6),this.Ot(128|63&e)}}this.Nt()}kt(e){const t=this.qt(e),n=Ap(t);this.Qt(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}Kt(e){const t=this.qt(e),n=Ap(t);this.Qt(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}Ft(e){const t=255&e;0===t?(this.Ut(0),this.Ut(255)):255===t?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;0===t?(this.Gt(0),this.Gt(255)):255===t?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class Dp{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class Op{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Lp{constructor(){this.jt=new Rp,this.Ht=new Dp(this.jt),this.Jt=new Op(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return 0===e?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}class Mp{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}Zt(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new Mp(this.indexId,this.documentKey,this.arrayValue,n)}}function Fp(e,t){let n=e.indexId-t.indexId;return 0!==n?n:(n=Up(e.arrayValue,t.arrayValue),0!==n?n:(n=Up(e.directionalValue,t.directionalValue),0!==n?n:yu.comparator(e.documentKey,t.documentKey)))}function Up(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}class Vp{constructor(e){this.Xt=new Pc(((e,t)=>gu.comparator(e.field,t.field))),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const e=t;e.isInequality()?this.Xt=this.Xt.add(e):this.tn.push(e)}}get nn(){return this.Xt.size>1}rn(e){if(Hl(e.collectionGroup===this.collectionId),this.nn)return!1;const t=_u(e);if(void 0!==t&&!this.sn(t))return!1;const n=wu(e);let r=new Set,i=0,s=0;for(;i<n.length&&this.sn(n[i]);++i)r=r.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(this.Xt.size>0){const e=this.Xt.getIterator().getNext();if(!r.has(e.field.canonicalString())){const t=n[i];if(!this.on(e,t)||!this._n(this.en[s++],t))return!1}++i}for(;i<n.length;++i){const e=n[i];if(s>=this.en.length||!this._n(this.en[s++],e))return!1}return!0}an(){if(this.nn)return null;let e=new Pc(gu.comparator);const t=[];for(const n of this.tn)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new bu(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new bu(n.field,0))}for(const n of this.en)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new bu(n.field,"asc"===n.dir?0:1)));return new vu(vu.UNKNOWN_ID,this.collectionId,t,Iu.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function qp(e){var t,n;if(Hl(e instanceof Sh||e instanceof Th),e instanceof Sh){if(e instanceof Vh){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((t=>Sh.create(e.field,"==",t))))||[];return Th.create(r,"or")}return e}const r=e.filters.map((e=>qp(e)));return Th.create(r,e.op)}function zp(e){if(0===e.getFilters().length)return[];const t=Wp(qp(e));return Hl($p(t)),jp(t)||Bp(t)?[t]:t.getFilters()}function jp(e){return e instanceof Sh}function Bp(e){return e instanceof Th&&xh(e)}function $p(e){return jp(e)||Bp(e)||function(e){if(e instanceof Th&&kh(e)){for(const t of e.getFilters())if(!jp(t)&&!Bp(t))return!1;return!0}return!1}(e)}function Wp(e){if(Hl(e instanceof Sh||e instanceof Th),e instanceof Sh)return e;if(1===e.filters.length)return Wp(e.filters[0]);const t=e.filters.map((e=>Wp(e)));let n=Th.create(t,e.op);return n=Gp(n),$p(n)?n:(Hl(n instanceof Th),Hl(Ch(n)),Hl(n.filters.length>1),n.filters.reduce(((e,t)=>Kp(e,t))))}function Kp(e,t){let n;return Hl(e instanceof Sh||e instanceof Th),Hl(t instanceof Sh||t instanceof Th),n=e instanceof Sh?t instanceof Sh?function(e,t){return Th.create([e,t],"and")}(e,t):Hp(e,t):t instanceof Sh?Hp(t,e):function(e,t){if(Hl(e.filters.length>0&&t.filters.length>0),Ch(e)&&Ch(t))return Rh(e,t.getFilters());const n=kh(e)?e:t,r=kh(e)?t:e,i=n.filters.map((e=>Kp(e,r)));return Th.create(i,"or")}(e,t),Gp(n)}function Hp(e,t){if(Ch(t))return Rh(t,e.getFilters());{const n=t.filters.map((t=>Kp(e,t)));return Th.create(n,"or")}}function Gp(e){if(Hl(e instanceof Sh||e instanceof Th),e instanceof Sh)return e;const t=e.getFilters();if(1===t.length)return Gp(t[0]);if(Nh(e))return e;const n=t.map((e=>Gp(e))),r=[];return n.forEach((t=>{t instanceof Sh?r.push(t):t instanceof Th&&(t.op===e.op?r.push(...t.filters):r.push(t))})),1===r.length?r[0]:Th.create(r,e.op)}class Qp{constructor(){this.un=new Yp}addToCollectionParentIndex(e,t){return this.un.add(t),Pu.resolve()}getCollectionParents(e,t){return Pu.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return Pu.resolve()}deleteFieldIndex(e,t){return Pu.resolve()}deleteAllFieldIndexes(e){return Pu.resolve()}createTargetIndexes(e,t){return Pu.resolve()}getDocumentsMatchingTarget(e,t){return Pu.resolve(null)}getIndexType(e,t){return Pu.resolve(0)}getFieldIndexes(e,t){return Pu.resolve([])}getNextCollectionGroupToUpdate(e){return Pu.resolve(null)}getMinOffset(e,t){return Pu.resolve(Tu.min())}getMinOffsetFromCollectionGroup(e,t){return Pu.resolve(Tu.min())}updateCollectionGroup(e,t,n){return Pu.resolve()}updateIndexEntries(e,t){return Pu.resolve()}}class Yp{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Pc(pu.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Pc(pu.comparator)).toArray()}}const Jp=new Uint8Array(0);class Xp{constructor(e,t){this.databaseId=t,this.cn=new Yp,this.ln=new fd((e=>$h(e)),((e,t)=>Wh(e,t))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.cn.add(t)}));const i={collectionId:n,parent:Hu(r)};return Zp(e).put(i)}return Pu.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[cu(t),""],!1,!0);return Zp(e).U(r).next((e=>{for(const r of e){if(r.collectionId!==t)break;n.push(Yu(r.parent))}return n}))}addFieldIndex(e,t){const n=tm(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((e=>[e.fieldPath.canonicalString(),e.kind]))}}(t);delete r.indexId;const i=n.add(r);if(t.indexState){const n=nm(e);return i.next((e=>{n.put(Ip(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return i.next()}deleteFieldIndex(e,t){const n=tm(e),r=nm(e),i=em(e);return n.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=tm(e),n=em(e),r=nm(e);return t.j().next((()=>n.j())).next((()=>r.j()))}createTargetIndexes(e,t){return Pu.forEach(this.hn(t),(t=>this.getIndexType(e,t).next((n=>{if(0===n||1===n){const n=new Vp(t).an();if(null!=n)return this.addFieldIndex(e,n)}}))))}getDocumentsMatchingTarget(e,t){const n=em(e);let r=!0;const i=new Map;return Pu.forEach(this.hn(t),(t=>this.Pn(e,t).next((e=>{r&&(r=!!e),i.set(t,e)})))).next((()=>{if(r){let e=Sd();const r=[];return Pu.forEach(i,((i,s)=>{jl("IndexedDbIndexManager",`Using index ${function(e){return`id=${e.indexId}|cg=${e.collectionGroup}|f=${e.fields.map((e=>`${e.fieldPath}:${e.kind}`)).join(",")}`}(i)} to execute ${$h(t)}`);const o=function(e,t){const n=_u(t);if(void 0===n)return null;for(const r of Hh(e,n.fieldPath))switch(r.op){case"array-contains-any":return r.value.arrayValue.values||[];case"array-contains":return[r.value]}return null}(s,i),a=function(e,t){const n=new Map;for(const r of wu(t))for(const t of Hh(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(s,i),l=function(e,t){const n=[];let r=!0;for(const i of wu(t)){const t=0===i.kind?Gh(e,i.fieldPath,e.startAt):Qh(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new vh(n,r)}(s,i),u=function(e,t){const n=[];let r=!0;for(const i of wu(t)){const t=0===i.kind?Qh(e,i.fieldPath,e.endAt):Gh(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new vh(n,r)}(s,i),c=this.In(i,s,l),h=this.In(i,s,u),d=this.Tn(i,s,a),f=this.En(i.indexId,o,c,l.inclusive,h,u.inclusive,d);return Pu.forEach(f,(i=>n.G(i,t.limit).next((t=>{t.forEach((t=>{const n=yu.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))}))}))))})).next((()=>r))}return Pu.resolve(null)}))}hn(e){let t=this.ln.get(e);return t||(t=0===e.filters.length?[e]:zp(Th.create(e.filters,"and")).map((t=>Bh(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt))),this.ln.set(e,t),t)}En(e,t,n,r,i,s,o){const a=(null!=t?t.length:1)*Math.max(n.length,i.length),l=a/(null!=t?t.length:1),u=[];for(let c=0;c<a;++c){const a=t?this.dn(t[c/l]):Jp,h=this.An(e,a,n[c%l],r),d=this.Rn(e,a,i[c%l],s),f=o.map((t=>this.An(e,a,t,!0)));u.push(...this.createRange(h,d,f))}return u}An(e,t,n,r){const i=new Mp(e,yu.empty(),t,n);return r?i:i.Zt()}Rn(e,t,n,r){const i=new Mp(e,yu.empty(),t,n);return r?i.Zt():i}Pn(e,t){const n=new Vp(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((e=>{let t=null;for(const r of e)n.rn(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t}))}getIndexType(e,t){let n=2;const r=this.hn(t);return Pu.forEach(r,(t=>this.Pn(e,t).next((e=>{e?0!==n&&e.fields.length<function(e){let t=new Pc(gu.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})))).next((()=>function(e){return null!==e.limit}(t)&&r.length>1&&2===n?1:n))}Vn(e,t){const n=new Lp;for(const r of wu(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const i=n.Yt(r.kind);Np.vt.It(e,i)}return n.zt()}dn(e){const t=new Lp;return Np.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const n=new Lp;return Np.vt.It(th(this.databaseId,t),n.Yt(function(e){const t=wu(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.zt()}Tn(e,t,n){if(null===n)return[];let r=[];r.push(new Lp);let i=0;for(const s of wu(e)){const e=n[i++];for(const n of r)if(this.fn(t,s.fieldPath)&&rh(e))r=this.gn(r,s,e);else{const t=n.Yt(s.kind);Np.vt.It(e,t)}}return this.pn(r)}In(e,t,n){return this.Tn(e,t,n.position)}pn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].zt();return t}gn(e,t,n){const r=[...e],i=[];for(const s of n.arrayValue.values||[])for(const e of r){const n=new Lp;n.seed(e.zt()),Np.vt.It(s,n.Yt(t.kind)),i.push(n)}return i}fn(e,t){return!!e.filters.find((e=>e instanceof Sh&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)))}getFieldIndexes(e,t){const n=tm(e),r=nm(e);return(t?n.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.U()).next((e=>{const t=[];return Pu.forEach(e,(e=>r.get([e.indexId,this.uid]).next((n=>{t.push(function(e,t){const n=t?new Iu(t.sequenceNumber,new Tu(mp(t.readTime),new yu(Yu(t.documentKey)),t.largestBatchId)):Iu.empty(),r=e.fields.map((e=>{let[t,n]=e;return new bu(gu.fromServerFormat(t),n)}));return new vu(e.indexId,e.collectionGroup,r,n)}(e,n))})))).next((()=>t))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((e=>0===e.length?null:(e.sort(((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:lu(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)))}updateCollectionGroup(e,t,n){const r=tm(e),i=nm(e);return this.yn(e).next((e=>r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((t=>Pu.forEach(t,(t=>i.put(Ip(t.indexId,this.uid,e,n))))))))}updateIndexEntries(e,t){const n=new Map;return Pu.forEach(t,((t,r)=>{const i=n.get(t.collectionGroup);return(i?Pu.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next((i=>(n.set(t.collectionGroup,i),Pu.forEach(i,(n=>this.wn(e,t,n).next((t=>{const i=this.Sn(r,n);return t.isEqual(i)?Pu.resolve():this.bn(e,r,n,t,i)})))))))}))}Dn(e,t,n,r){return em(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.mn(n,t.key),documentKey:t.key.path.toArray()})}vn(e,t,n,r){return em(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.mn(n,t.key),t.key.path.toArray()])}wn(e,t,n){const r=em(e);let i=new Pc(Fp);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,t)])},((e,r)=>{i=i.add(new Mp(n.indexId,t,r.arrayValue,r.directionalValue))})).next((()=>i))}Sn(e,t){let n=new Pc(Fp);const r=this.Vn(t,e);if(null==r)return n;const i=_u(t);if(null!=i){const s=e.data.field(i.fieldPath);if(rh(s))for(const i of s.arrayValue.values||[])n=n.add(new Mp(t.indexId,e.key,this.dn(i),r))}else n=n.add(new Mp(t.indexId,e.key,Jp,r));return n}bn(e,t,n,r,i){jl("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const s=[];return function(e,t,n,r,i){const s=e.getIterator(),o=t.getIterator();let a=Rc(s),l=Rc(o);for(;a||l;){let e=!1,t=!1;if(a&&l){const r=n(a,l);r<0?t=!0:r>0&&(e=!0)}else null!=a?t=!0:e=!0;e?(r(l),l=Rc(o)):t?(i(a),a=Rc(s)):(a=Rc(s),l=Rc(o))}}(r,i,Fp,(r=>{s.push(this.Dn(e,t,n,r))}),(r=>{s.push(this.vn(e,t,n,r))})),Pu.waitFor(s)}yn(e){let t=1;return nm(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((e,n,r)=>{r.done(),t=n.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((e,t)=>Fp(e,t))).filter(((e,t,n)=>!t||0!==Fp(e,n[t-1])));const r=[];r.push(e);for(const s of n){const n=Fp(s,e),i=Fp(s,t);if(0===n)r[0]=e.Zt();else if(n>0&&i<0)r.push(s),r.push(s.Zt());else if(i>0)break}r.push(t);const i=[];for(let s=0;s<r.length;s+=2){if(this.Cn(r[s],r[s+1]))return[];const e=[r[s].indexId,this.uid,r[s].arrayValue,r[s].directionalValue,Jp,[]],t=[r[s+1].indexId,this.uid,r[s+1].arrayValue,r[s+1].directionalValue,Jp,[]];i.push(IDBKeyRange.bound(e,t))}return i}Cn(e,t){return Fp(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(rm)}getMinOffset(e,t){return Pu.mapArray(this.hn(t),(t=>this.Pn(e,t).next((e=>e||Kl())))).next(rm)}}function Zp(e){return Ec(e,"collectionParents")}function em(e){return Ec(e,"indexEntries")}function tm(e){return Ec(e,"indexConfiguration")}function nm(e){return Ec(e,"indexState")}function rm(e){Hl(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const i=e[r].indexState.offset;Cu(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Tu(t.readTime,t.documentKey,n)}const im={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class sm{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new sm(e,sm.DEFAULT_COLLECTION_PERCENTILE,sm.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function om(e,t,n){const r=e.store("mutations"),i=e.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.J({range:o},((e,t,n)=>(a++,n.delete())));s.push(l.next((()=>{Hl(1===a)})));const u=[];for(const c of n.mutations){const e=Zu(t,c.key.path,n.batchId);s.push(i.delete(e)),u.push(c.key)}return Pu.waitFor(s).next((()=>u))}function am(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw Kl();t=e.noDocument}return JSON.stringify(t).length}sm.DEFAULT_COLLECTION_PERCENTILE=10,sm.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,sm.DEFAULT=new sm(41943040,sm.DEFAULT_COLLECTION_PERCENTILE,sm.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),sm.DISABLED=new sm(-1,0,0);class lm{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Fn={}}static lt(e,t,n,r){Hl(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new lm(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return cm(e).J({index:"userMutationsIndex",range:n},((e,n,r)=>{t=!1,r.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const i=hm(e),s=cm(e);return s.add({}).next((o=>{Hl("number"==typeof o);const a=new of(o,t,n,r),l=function(e,t,n){const r=n.baseMutations.map((t=>Yf(e.ct,t))),i=n.mutations.map((t=>Yf(e.ct,t)));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.serializer,this.userId,a),u=[];let c=new Pc(((e,t)=>lu(e.canonicalString(),t.canonicalString())));for(const e of r){const t=Zu(this.userId,e.key.path,o);c=c.add(e.key.path.popLast()),u.push(s.put(l)),u.push(i.put(t,ec))}return c.forEach((t=>{u.push(this.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.Fn[o]=a.keys()})),Pu.waitFor(u).next((()=>a))}))}lookupMutationBatch(e,t){return cm(e).get(t).next((e=>e?(Hl(e.userId===this.userId),gp(this.serializer,e)):null))}Mn(e,t){return this.Fn[t]?Pu.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.Fn[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return cm(e).J({index:"userMutationsIndex",range:r},((e,t,r)=>{t.userId===this.userId&&(Hl(t.batchId>=n),i=gp(this.serializer,t)),r.done()})).next((()=>i))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return cm(e).J({index:"userMutationsIndex",range:t,reverse:!0},((e,t,r)=>{n=t.batchId,r.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return cm(e).U("userMutationsIndex",t).next((e=>e.map((e=>gp(this.serializer,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Xu(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return hm(e).J({range:r},((n,r,s)=>{const[o,a,l]=n,u=Yu(a);if(o===this.userId&&t.path.isEqual(u))return cm(e).get(l).next((e=>{if(!e)throw Kl();Hl(e.userId===this.userId),i.push(gp(this.serializer,e))}));s.done()})).next((()=>i))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Pc(lu);const r=[];return t.forEach((t=>{const i=Xu(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=hm(e).J({range:s},((e,r,i)=>{const[s,o,a]=e,l=Yu(o);s===this.userId&&t.path.isEqual(l)?n=n.add(a):i.done()}));r.push(o)})),Pu.waitFor(r).next((()=>this.xn(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=Xu(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new Pc(lu);return hm(e).J({range:s},((e,t,i)=>{const[s,a,l]=e,u=Yu(a);s===this.userId&&n.isPrefixOf(u)?u.length===r&&(o=o.add(l)):i.done()})).next((()=>this.xn(e,o)))}xn(e,t){const n=[],r=[];return t.forEach((t=>{r.push(cm(e).get(t).next((e=>{if(null===e)throw Kl();Hl(e.userId===this.userId),n.push(gp(this.serializer,e))})))})),Pu.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return om(e._e,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.On(t.batchId)})),Pu.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Pu.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),r=[];return hm(e).J({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=Yu(e[1]);r.push(t)}else n.done()})).next((()=>{Hl(0===r.length)}))}))}containsKey(e,t){return um(e,this.userId,t)}Nn(e){return dm(e).get(this.userId).next((e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}))}}function um(e,t,n){const r=Xu(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return hm(e).J({range:s,H:!0},((e,n,r)=>{const[s,a,l]=e;s===t&&a===i&&(o=!0),r.done()})).next((()=>o))}function cm(e){return Ec(e,"mutations")}function hm(e){return Ec(e,"documentMutations")}function dm(e){return Ec(e,"mutationQueues")}class fm{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new fm(0)}static kn(){return new fm(-1)}}class pm{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next((t=>{const n=new fm(t.highestTargetId);return t.highestTargetId=n.next(),this.Qn(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.qn(e).next((e=>du.fromTimestamp(new hu(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.qn(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.qn(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Qn(e,r))))}addTargetData(e,t){return this.Kn(e,t).next((()=>this.qn(e).next((n=>(n.targetCount+=1,this.$n(t,n),this.Qn(e,n))))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>mm(e).delete(t.targetId))).next((()=>this.qn(e))).next((t=>(Hl(t.targetCount>0),t.targetCount-=1,this.Qn(e,t))))}removeTargets(e,t,n){let r=0;const i=[];return mm(e).J(((s,o)=>{const a=yp(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))})).next((()=>Pu.waitFor(i))).next((()=>r))}forEachTarget(e,t){return mm(e).J(((e,n)=>{const r=yp(n);t(r)}))}qn(e){return gm(e).get("targetGlobalKey").next((e=>(Hl(null!==e),e)))}Qn(e,t){return gm(e).put("targetGlobalKey",t)}Kn(e,t){return mm(e).put(vp(this.serializer,t))}$n(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.qn(e).next((e=>e.targetCount))}getTargetData(e,t){const n=$h(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return mm(e).J({range:r,index:"queryTargetsIndex"},((e,n,r)=>{const s=yp(n);Wh(t,s.target)&&(i=s,r.done())})).next((()=>i))}addMatchingKeys(e,t,n){const r=[],i=ym(e);return t.forEach((t=>{const s=Hu(t.path);r.push(i.put({targetId:n,path:s})),r.push(this.referenceDelegate.addReference(e,n,t))})),Pu.waitFor(r)}removeMatchingKeys(e,t,n){const r=ym(e);return Pu.forEach(t,(t=>{const i=Hu(t.path);return Pu.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=ym(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=ym(e);let i=Sd();return r.J({range:n,H:!0},((e,t,n)=>{const r=Yu(e[1]),s=new yu(r);i=i.add(s)})).next((()=>i))}containsKey(e,t){const n=Hu(t.path),r=IDBKeyRange.bound([n],[cu(n)],!1,!0);let i=0;return ym(e).J({index:"documentTargetsIndex",H:!0,range:r},((e,t,n)=>{let[r,s]=e;0!==r&&(i++,n.done())})).next((()=>i>0))}ot(e,t){return mm(e).get(t).next((e=>e?yp(e):null))}}function mm(e){return Ec(e,"targets")}function gm(e){return Ec(e,"targetGlobal")}function ym(e){return Ec(e,"targetDocuments")}function vm(e,t){let[n,r]=e,[i,s]=t;const o=lu(n,i);return 0===o?lu(r,s):o}class _m{constructor(e){this.Un=e,this.buffer=new Pc(vm),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();vm(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class wm{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.jn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return null!==this.jn}Hn(e){jl("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Mu(e)?jl("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await Nu(e)}await this.Hn(3e5)}))}}class bm{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return Pu.resolve(Bu.oe);const n=new _m(t);return this.Jn.forEachTarget(e,(e=>n.zn(e.sequenceNumber))).next((()=>this.Jn.Zn(e,(e=>n.zn(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.Jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(jl("LruGarbageCollector","Garbage collection skipped; disabled"),Pu.resolve(im)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(jl("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),im):this.Xn(e,t)))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let n,r,i,s,o,a,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(jl("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,o=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,a=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(l=Date.now(),zl()<=xt.DEBUG&&jl("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-u}ms\n\tDetermined least recently used ${r} in `+(o-s)+"ms\n"+`\tRemoved ${i} targets in `+(a-o)+"ms\n"+`\tRemoved ${e} documents in `+(l-a)+"ms\n"+`Total Duration: ${l-u}ms`),Pu.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}}function Im(e,t){return new bm(e,t)}class Em{constructor(e,t){this.db=e,this.garbageCollector=Im(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}er(e){let t=0;return this.Zn(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,((e,n)=>t(n)))}addReference(e,t,n){return Sm(e,n)}removeReference(e,t,n){return Sm(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Sm(e,t)}nr(e,t){return function(e,t){let n=!1;return dm(e).Y((r=>um(e,r,t).next((e=>(e&&(n=!0),Pu.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.tr(e,((s,o)=>{if(o<=t){const t=this.nr(e,s).next((t=>{if(!t)return i++,n.getEntry(e,s).next((()=>(n.removeEntry(s,du.min()),ym(e).delete(function(e){return[0,Hu(e.path)]}(s)))))}));r.push(t)}})).next((()=>Pu.waitFor(r))).next((()=>n.apply(e))).next((()=>i))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Sm(e,t)}tr(e,t){const n=ym(e);let r,i=Bu.oe;return n.J({index:"documentTargetsIndex"},((e,n)=>{let[s,o]=e,{path:a,sequenceNumber:l}=n;0===s?(i!==Bu.oe&&t(new yu(Yu(r)),i),i=l,r=a):i=Bu.oe})).next((()=>{i!==Bu.oe&&t(new yu(Yu(r)),i)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Sm(e,t){return ym(e).put(function(e,t){return{targetId:0,path:Hu(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class Tm{constructor(){this.changes=new fd((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,yh.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Pu.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Cm{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Pm(e).put(n)}removeEntry(e,t,n){return Pm(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],fp(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.rr(e,n))))}getEntry(e,t){let n=yh.newInvalidDocument(t);return Pm(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Am(t))},((e,r)=>{n=this.ir(t,r)})).next((()=>n))}sr(e,t){let n={size:0,document:yh.newInvalidDocument(t)};return Pm(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Am(t))},((e,r)=>{n={document:this.ir(t,r),size:am(r)}})).next((()=>n))}getEntries(e,t){let n=md();return this._r(e,t,((e,t)=>{const r=this.ir(e,t);n=n.insert(e,r)})).next((()=>n))}ar(e,t){let n=md(),r=new kc(yu.comparator);return this._r(e,t,((e,t)=>{const i=this.ir(e,t);n=n.insert(e,i),r=r.insert(e,am(t))})).next((()=>({documents:n,ur:r})))}_r(e,t,n){if(t.isEmpty())return Pu.resolve();let r=new Pc(Dm);t.forEach((e=>r=r.add(e)));const i=IDBKeyRange.bound(Am(r.first()),Am(r.last())),s=r.getIterator();let o=s.getNext();return Pm(e).J({index:"documentKeyIndex",range:i},((e,t,r)=>{const i=yu.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;o&&Dm(o,i)<0;)n(o,null),o=s.getNext();o&&o.isEqual(i)&&(n(o,t),o=s.hasNext()?s.getNext():null),o?r.$(Am(o)):r.done()})).next((()=>{for(;o;)n(o,null),o=s.hasNext()?s.getNext():null}))}getDocumentsMatchingQuery(e,t,n,r,i){const s=t.path,o=[s.popLast().toArray(),s.lastSegment(),fp(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Pm(e).U(IDBKeyRange.bound(o,a,!0)).next((e=>{null==i||i.incrementDocumentReadCount(e.length);let n=md();for(const i of e){const e=this.ir(yu.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(ud(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n}))}getAllFromCollectionGroup(e,t,n,r){let i=md();const s=Rm(t,n),o=Rm(t,Tu.max());return Pm(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,o,!0)},((e,t,n)=>{const s=this.ir(yu.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);i=i.insert(s.key,s),i.size===r&&n.done()})).next((()=>i))}newChangeBuffer(e){return new xm(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return Nm(e).get("remoteDocumentGlobalKey").next((e=>(Hl(!!e),e)))}rr(e,t){return Nm(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const e=function(e,t){let n;if(t.document)n=Qf(e.ct,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=yu.fromSegments(t.noDocument.path),r=mp(t.noDocument.readTime);n=yh.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return Kl();{const e=yu.fromSegments(t.unknownDocument.path),r=mp(t.unknownDocument.version);n=yh.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new hu(e[0],e[1]);return du.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(du.min()))return e}return yh.newInvalidDocument(e)}}function km(e){return new Cm(e)}class xm extends Tm{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new fd((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,r=new Pc(((e,t)=>lu(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((i,s)=>{const o=this.lr.get(i);if(t.push(this.cr.removeEntry(e,i,o.readTime)),s.isValidDocument()){const a=dp(this.cr.serializer,s);r=r.add(i.path.popLast());const l=am(a);n+=l-o.size,t.push(this.cr.addEntry(e,i,a))}else if(n-=o.size,this.trackRemovals){const n=dp(this.cr.serializer,s.convertToNoDocument(du.min()));t.push(this.cr.addEntry(e,i,n))}})),r.forEach((n=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,n))})),t.push(this.cr.updateMetadata(e,n)),Pu.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next((e=>(this.lr.set(t,{size:e.size,readTime:e.document.readTime}),e.document)))}getAllFromCache(e,t){return this.cr.ar(e,t).next((e=>{let{documents:t,ur:n}=e;return n.forEach(((e,n)=>{this.lr.set(e,{size:n,readTime:t.get(e).readTime})})),t}))}}function Nm(e){return Ec(e,"remoteDocumentGlobal")}function Pm(e){return Ec(e,"remoteDocumentsV14")}function Am(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Rm(e,t){const n=t.documentKey.path.toArray();return[e,fp(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Dm(e,t){const n=e.path.toArray(),r=t.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=lu(n[s],r[s]),i)return i;return i=lu(n.length,r.length),i||(i=lu(n[n.length-2],r[r.length-2]),i||lu(n[n.length-1],r[r.length-1]))}class Om{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Lm{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&Qd(n.mutation,e,Dc.empty(),hu.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,Sd()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Sd();const r=_d();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=yd();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=_d();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Sd())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=md();const s=bd(),o=bd();return t.forEach(((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Zd)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),Qd(o.mutation,t,o.mutation.getFieldMask(),hu.now())):s.set(t.key,Dc.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new Om(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=bd();let r=new kc(((e,t)=>e-t)),i=Sd();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||Dc.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||Sd()).add(e);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,l=r.value,u=wd();l.forEach((e=>{if(!i.has(e)){const r=Hd(t.get(e),n.get(e));null!==r&&u.set(e,r),i=i.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,u))}return Pu.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return yu.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ed(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):Pu.resolve(_d());let o=-1,a=i;return s.next((t=>Pu.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?Pu.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,a,t,Sd()))).next((e=>({batchId:o,changes:vd(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new yu(t)).next((e=>{let t=yd();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=yd();return this.indexManager.getCollectionParents(e,i).next((o=>Pu.forEach(o,(o=>{const a=function(e,t){return new Yh(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next((e=>{e.forEach(((e,t)=>{s=s.insert(e,t)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,yh.newInvalidDocument(r)))}));let n=yd();return e.forEach(((e,r)=>{const s=i.get(e);void 0!==s&&Qd(s.mutation,r,Dc.empty(),hu.now()),ud(t,r)&&(n=n.insert(e,r))})),n}))}}class Mm{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return Pu.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Uf(e.createTime)}}(t)),Pu.resolve()}getNamedQuery(e,t){return Pu.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(e){return{name:e.name,query:_p(e.bundledQuery),readTime:Uf(e.readTime)}}(t)),Pu.resolve()}}class Fm{constructor(){this.overlays=new kc(yu.comparator),this.Ir=new Map}getOverlay(e,t){return Pu.resolve(this.overlays.get(t))}getOverlays(e,t){const n=_d();return Pu.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.ht(e,t,r)})),Pu.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Ir.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.Ir.delete(n)),Pu.resolve()}getOverlaysForCollection(e,t,n){const r=_d(),i=t.length+1,s=new yu(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Pu.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new kc(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=_d(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=_d(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return Pu.resolve(o)}ht(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Ir.get(r.largestBatchId).delete(n.key);this.Ir.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new lf(t,n));let i=this.Ir.get(t);void 0===i&&(i=Sd(),this.Ir.set(t,i)),this.Ir.set(t,i.add(n.key))}}class Um{constructor(){this.sessionToken=Lc.EMPTY_BYTE_STRING}getSessionToken(e){return Pu.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Pu.resolve()}}class Vm{constructor(){this.Tr=new Pc(qm.Er),this.dr=new Pc(qm.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new qm(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Vr(new qm(e,t))}mr(e,t){e.forEach((e=>this.removeReference(e,t)))}gr(e){const t=new yu(new pu([])),n=new qm(t,e),r=new qm(t,e+1),i=[];return this.dr.forEachInRange([n,r],(e=>{this.Vr(e),i.push(e.key)})),i}pr(){this.Tr.forEach((e=>this.Vr(e)))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new yu(new pu([])),n=new qm(t,e),r=new qm(t,e+1);let i=Sd();return this.dr.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new qm(e,0),n=this.Tr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class qm{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return yu.comparator(e.key,t.key)||lu(e.wr,t.wr)}static Ar(e,t){return lu(e.wr,t.wr)||yu.comparator(e.key,t.key)}}class zm{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Pc(qm.Er)}checkEmpty(e){return Pu.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new of(i,t,n,r);this.mutationQueue.push(s);for(const o of r)this.br=this.br.add(new qm(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Pu.resolve(s)}lookupMutationBatch(e,t){return Pu.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.vr(n),i=r<0?0:r;return Pu.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Pu.resolve(0===this.mutationQueue.length?-1:this.Sr-1)}getAllMutationBatches(e){return Pu.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new qm(t,0),r=new qm(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,r],(e=>{const t=this.Dr(e.wr);i.push(t)})),Pu.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Pc(lu);return t.forEach((e=>{const t=new qm(e,0),r=new qm(e,Number.POSITIVE_INFINITY);this.br.forEachInRange([t,r],(e=>{n=n.add(e.wr)}))})),Pu.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;yu.isDocumentKey(i)||(i=i.child(""));const s=new qm(new yu(i),0);let o=new Pc(lu);return this.br.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.wr)),!0)}),s),Pu.resolve(this.Cr(o))}Cr(e){const t=[];return e.forEach((e=>{const n=this.Dr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Hl(0===this.Fr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.br;return Pu.forEach(t.mutations,(r=>{const i=new qm(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.br=n}))}On(e){}containsKey(e,t){const n=new qm(t,0),r=this.br.firstAfterOrEqual(n);return Pu.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Pu.resolve()}Fr(e,t){return this.vr(e)}vr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class jm{constructor(e){this.Mr=e,this.docs=new kc(yu.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Pu.resolve(n?n.document.mutableCopy():yh.newInvalidDocument(t))}getEntries(e,t){let n=md();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():yh.newInvalidDocument(e))})),Pu.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=md();const s=t.path,o=new yu(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||Cu(Su(o),n)<=0||(r.has(o.key)||ud(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return Pu.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Kl()}Or(e,t){return Pu.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new Bm(this)}getSize(e){return Pu.resolve(this.size)}}class Bm extends Tm{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.cr.addEntry(e,r)):this.cr.removeEntry(n)})),Pu.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}class $m{constructor(e){this.persistence=e,this.Nr=new fd((e=>$h(e)),Wh),this.lastRemoteSnapshotVersion=du.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Vm,this.targetCount=0,this.kr=fm.Bn()}forEachTarget(e,t){return this.Nr.forEach(((e,n)=>t(n))),Pu.resolve()}getLastRemoteSnapshotVersion(e){return Pu.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Pu.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Pu.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),Pu.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new fm(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,Pu.resolve()}updateTargetData(e,t){return this.Kn(t),Pu.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,Pu.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Nr.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Nr.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),Pu.waitFor(i).next((()=>r))}getTargetCount(e){return Pu.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return Pu.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),Pu.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),Pu.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),Pu.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return Pu.resolve(n)}containsKey(e,t){return Pu.resolve(this.Br.containsKey(t))}}class Wm{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Bu(0),this.Kr=!1,this.Kr=!0,this.$r=new Um,this.referenceDelegate=e(this),this.Ur=new $m(this),this.indexManager=new Qp,this.remoteDocumentCache=function(e){return new jm(e)}((e=>this.referenceDelegate.Wr(e))),this.serializer=new hp(t),this.Gr=new Mm(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Fm,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new zm(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){jl("MemoryPersistence","Starting transaction:",e);const r=new Km(this.Qr.next());return this.referenceDelegate.zr(),n(r).next((e=>this.referenceDelegate.jr(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Hr(e,t){return Pu.or(Object.values(this.qr).map((n=>()=>n.containsKey(e,t))))}}class Km extends xu{constructor(e){super(),this.currentSequenceNumber=e}}class Hm{constructor(e){this.persistence=e,this.Jr=new Vm,this.Yr=null}static Zr(e){return new Hm(e)}get Xr(){if(this.Yr)return this.Yr;throw Kl()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),Pu.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),Pu.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),Pu.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach((e=>this.Xr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Xr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Pu.forEach(this.Xr,(n=>{const r=yu.fromPath(n);return this.ei(e,r).next((e=>{e||t.removeEntry(r,du.min())}))})).next((()=>(this.Yr=null,t.apply(e))))}updateLimboDocument(e,t){return this.ei(e,t).next((e=>{e?this.Xr.delete(t.toString()):this.Xr.add(t.toString())}))}Wr(e){return 0}ei(e,t){return Pu.or([()=>Pu.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class Gm{constructor(e){this.serializer=e}O(e,t,n,r){const i=new Au("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Ju,{unique:!0}),e.createObjectStore("documentMutations")}(e),Qm(e),function(e){e.createObjectStore("remoteDocuments")}(e));let s=Pu.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),Qm(e)),s=s.next((()=>function(e){const t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:du.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(i)))),n<4&&r>=4&&(0!==n&&(s=s.next((()=>function(e,t){return t.store("mutations").U().next((n=>{e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Ju,{unique:!0});const r=t.store("mutations"),i=n.map((e=>r.put(e)));return Pu.waitFor(i)}))}(e,i)))),s=s.next((()=>{!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(s=s.next((()=>this.ni(i)))),n<6&&r>=6&&(s=s.next((()=>(function(e){e.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i))))),n<7&&r>=7&&(s=s.next((()=>this.ii(i)))),n<8&&r>=8&&(s=s.next((()=>this.si(e,i)))),n<9&&r>=9&&(s=s.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(s=s.next((()=>this.oi(i)))),n<11&&r>=11&&(s=s.next((()=>{!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(s=s.next((()=>{!function(e){const t=e.createObjectStore("documentOverlays",{keyPath:dc});t.createIndex("collectionPathOverlayIndex",fc,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",pc,{unique:!1})}(e)}))),n<13&&r>=13&&(s=s.next((()=>function(e){const t=e.createObjectStore("remoteDocumentsV14",{keyPath:tc});t.createIndex("documentKeyIndex",nc),t.createIndex("collectionGroupIndex",rc)}(e))).next((()=>this._i(e,i))).next((()=>e.deleteObjectStore("remoteDocuments")))),n<14&&r>=14&&(s=s.next((()=>this.ai(e,i)))),n<15&&r>=15&&(s=s.next((()=>function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:lc}).createIndex("sequenceNumberIndex",uc,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:cc}).createIndex("documentKeyIndex",hc,{unique:!1})}(e)))),n<16&&r>=16&&(s=s.next((()=>{t.objectStore("indexState").clear()})).next((()=>{t.objectStore("indexEntries").clear()}))),n<17&&r>=17&&(s=s.next((()=>{!function(e){e.createObjectStore("globals",{keyPath:"name"})}(e)}))),s}ri(e){let t=0;return e.store("remoteDocuments").J(((e,n)=>{t+=am(n)})).next((()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}ni(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.U().next((t=>Pu.forEach(t,(t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",r).next((n=>Pu.forEach(n,(n=>{Hl(n.userId===t.userId);const r=gp(this.serializer,n);return om(e,t.userId,r).next((()=>{}))}))))}))))}ii(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((e=>{const r=[];return n.J(((n,i)=>{const s=new pu(n),o=function(e){return[0,Hu(e)]}(s);r.push(t.get(o).next((n=>n?Pu.resolve():(n=>t.put({targetId:0,path:Hu(n),sequenceNumber:e.highestListenSequenceNumber}))(s))))})).next((()=>Pu.waitFor(r)))}))}si(e,t){e.createObjectStore("collectionParents",{keyPath:ac});const n=t.store("collectionParents"),r=new Yp,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:Hu(r)})}};return t.store("remoteDocuments").J({H:!0},((e,t)=>{const n=new pu(e);return i(n.popLast())})).next((()=>t.store("documentMutations").J({H:!0},((e,t)=>{let[n,r,s]=e;const o=Yu(r);return i(o.popLast())}))))}oi(e){const t=e.store("targets");return t.J(((e,n)=>{const r=yp(n),i=vp(this.serializer,r);return t.put(i)}))}_i(e,t){const n=t.store("remoteDocuments"),r=[];return n.J(((e,n)=>{const i=t.store("remoteDocumentsV14"),s=function(e){return e.document?new yu(pu.fromString(e.document.name).popFirst(5)):e.noDocument?yu.fromSegments(e.noDocument.path):e.unknownDocument?yu.fromSegments(e.unknownDocument.path):Kl()}(n).path.toArray(),o={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(o))})).next((()=>Pu.waitFor(r)))}ai(e,t){const n=t.store("mutations"),r=km(this.serializer),i=new Wm(Hm.Zr,this.serializer.ct);return n.U().next((e=>{const n=new Map;return e.forEach((e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:Sd();gp(this.serializer,e).keys().forEach((e=>r=r.add(e))),n.set(e.userId,r)})),Pu.forEach(n,((e,n)=>{const s=new Ul(n),o=Cp.lt(this.serializer,s),a=i.getIndexManager(s),l=lm.lt(s,this.serializer,a,i.referenceDelegate);return new Lm(r,l,o,a).recalculateAndSaveOverlaysForDocumentKeys(new Ic(t,Bu.oe),e).next()}))}))}}function Qm(e){e.createObjectStore("targetDocuments",{keyPath:sc}).createIndex("documentTargetsIndex",oc,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",ic,{unique:!0}),e.createObjectStore("targetGlobal")}const Ym="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Jm{constructor(e,t,n,r,i,s,o,a,l,u){let c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:17;if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.ui=i,this.window=s,this.document=o,this.ci=l,this.li=u,this.hi=c,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=e=>Promise.resolve(),!Jm.D())throw new Yl(Ql.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Em(this,r),this.Ai=t+"main",this.serializer=new hp(a),this.Ri=new Ru(this.Ai,this.hi,new Gm(this.serializer)),this.$r=new xp,this.Ur=new pm(this.referenceDelegate,this.serializer),this.remoteDocumentCache=km(this.serializer),this.Gr=new Ep,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,!1===u&&Bl("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Yl(Ql.FAILED_PRECONDITION,Ym);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Ur.getHighestSequenceNumber(e)))})).then((e=>{this.Qr=new Bu(e,this.ci)})).then((()=>{this.Kr=!0})).catch((e=>(this.Ri&&this.Ri.close(),Promise.reject(e))))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget((async()=>{this.started&&await this.mi()})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Zm(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.wi(e).next((e=>{e||(this.isPrimary=!1,this.ui.enqueueRetryable((()=>this.di(!1))))}))})).next((()=>this.Si(e))).next((t=>this.isPrimary&&!t?this.bi(e).next((()=>!1)):!!t&&this.Di(e).next((()=>!0)))))).catch((e=>{if(Mu(e))return jl("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return jl("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.ui.enqueueRetryable((()=>this.di(e))),this.isPrimary=e}))}wi(e){return Xm(e).get("owner").next((e=>Pu.resolve(this.vi(e))))}Ci(e){return Zm(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=Ec(e,"clientMetadata");return t.U().next((e=>{const n=this.xi(e,18e5),r=e.filter((e=>-1===n.indexOf(e)));return Pu.forEach(r,(e=>t.delete(e.clientId))).next((()=>r))}))})).catch((()=>[]));if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.mi().then((()=>this.Fi())).then((()=>this.pi()))))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?Pu.resolve(!0):Xm(e).get("owner").next((t=>{if(null!==t&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new Yl(Ql.FAILED_PRECONDITION,Ym);return!1}}return!(!this.networkEnabled||!this.inForeground)||Zm(e).U().next((e=>void 0===this.xi(e,5e3).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&jl("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(e=>{const t=new Ic(e,Bu.oe);return this.bi(t).next((()=>this.Ci(t)))})),this.Ri.close(),this.qi()}xi(e,t){return e.filter((e=>this.Mi(e.updateTimeMs,t)&&!this.Ni(e.clientId)))}Qi(){return this.runTransaction("getActiveClients","readonly",(e=>Zm(e).U().next((e=>this.xi(e,18e5).map((e=>e.clientId))))))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return lm.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Xp(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Cp.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,n){jl("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",i=function(e){return 17===e?bc:16===e?wc:15===e?_c:14===e?vc:13===e?yc:12===e?gc:11===e?mc:void Kl()}(this.hi);let s;return this.Ri.runTransaction(e,r,i,(r=>(s=new Ic(r,this.Qr?this.Qr.next():Bu.oe),"readwrite-primary"===t?this.wi(s).next((e=>!!e||this.Si(s))).next((t=>{if(!t)throw Bl(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable((()=>this.di(!1))),new Yl(Ql.FAILED_PRECONDITION,ku);return n(s)})).next((e=>this.Di(s).next((()=>e)))):this.Ki(s).next((()=>n(s)))))).then((e=>(s.raiseOnCommittedEvent(),e)))}Ki(e){return Xm(e).get("owner").next((e=>{if(null!==e&&this.Mi(e.leaseTimestampMs,5e3)&&!this.Ni(e.ownerId)&&!this.vi(e)&&!(this.li||this.allowTabSynchronization&&e.allowTabSynchronization))throw new Yl(Ql.FAILED_PRECONDITION,Ym)}))}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Xm(e).put("owner",t)}static D(){return Ru.D()}bi(e){const t=Xm(e);return t.get("owner").next((e=>this.vi(e)?(jl("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):Pu.resolve()))}Mi(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(Bl(`Detected an update time that is in the future: ${e} > ${n}`),!1))}fi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ii=()=>{this.ui.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.mi())))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground="visible"===this.document.visibilityState)}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Pi=()=>{this.Li();const e=/(?:Version|Mobile)\/1[456]/;Ye()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const n=null!==(null===(t=this.Vi)||void 0===t?void 0:t.getItem(this.Oi(e)));return jl("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return Bl("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(cx){Bl("Failed to set zombie client id.",cx)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch(cx){}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Xm(e){return Ec(e,"owner")}function Zm(e){return Ec(e,"clientMetadata")}function eg(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class tg{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=r}static Wi(e,t){let n=Sd(),r=Sd();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new tg(e,t.fromCache,n,r)}}class ng{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class rg{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=Ye()?8:Du(je())>0?6:4}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.Yi(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.Zi(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;const n=new ng;return this.Xi(e,t,n).next((r=>{if(i.result=r,this.zi)return this.es(e,t,n,r.size)}))})).next((()=>i.result))}es(e,t,n,r){return n.documentReadCount<this.ji?(zl()<=xt.DEBUG&&jl("QueryEngine","SDK will not create cache indexes for query:",ld(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Pu.resolve()):(zl()<=xt.DEBUG&&jl("QueryEngine","Query:",ld(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Hi*r?(zl()<=xt.DEBUG&&jl("QueryEngine","The SDK decides to create cache indexes for query:",ld(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,nd(t))):Pu.resolve())}Yi(e,t){if(Zh(t))return Pu.resolve(null);let n=nd(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=sd(t,null,"F"),n=nd(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=Sd(...r);return this.Ji.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.ts(t,r);return this.ns(t,s,i,n.readTime)?this.Yi(e,sd(t,null,"F")):this.rs(e,s,t,n)}))))})))))}Zi(e,t,n,r){return Zh(t)||r.isEqual(du.min())?Pu.resolve(null):this.Ji.getDocuments(e,n).next((i=>{const s=this.ts(t,i);return this.ns(t,s,n,r)?Pu.resolve(null):(zl()<=xt.DEBUG&&jl("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ld(t)),this.rs(e,s,t,Eu(r,-1)).next((e=>e)))}))}ts(e,t){let n=new Pc(hd(e));return t.forEach(((t,r)=>{ud(e,r)&&(n=n.add(r))})),n}ns(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Xi(e,t,n){return zl()<=xt.DEBUG&&jl("QueryEngine","Using full collection scan to execute query:",ld(t)),this.Ji.getDocumentsMatchingQuery(e,t,Tu.min(),n)}rs(e,t,n,r){return this.Ji.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class ig{constructor(e,t,n,r){this.persistence=e,this.ss=t,this.serializer=r,this.os=new kc(lu),this._s=new fd((e=>$h(e)),Wh),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Lm(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.os)))}}function sg(e,t,n,r){return new ig(e,t,n,r)}async function og(e,t){const n=Gl(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.ls(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],s=[];let o=Sd();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({hs:e,removedBatchIds:i,addedBatchIds:s})))}))}))}function ag(e){const t=Gl(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Ur.getLastRemoteSnapshotVersion(e)))}function lg(e,t,n){let r=Sd(),i=Sd();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=md();return n.forEach(((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(du.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):jl("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{Ps:r,Is:i}}))}function ug(e,t){const n=Gl(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function cg(e,t){const n=Gl(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Ur.getTargetData(e,t).next((i=>i?(r=i,Pu.resolve(r)):n.Ur.allocateTargetId(e).next((i=>(r=new cp(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Ur.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.os.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.os=n.os.insert(e.targetId,e),n._s.set(t,e.targetId)),e}))}async function hg(e,t,n){const r=Gl(e),i=r.os.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!Mu(e))throw e;jl("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.os=r.os.remove(t),r._s.delete(i.target)}function dg(e,t,n){const r=Gl(e);let i=du.min(),s=Sd();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=Gl(e),i=r._s.get(n);return void 0!==i?Pu.resolve(r.os.get(i)):r.Ur.getTargetData(t,n)}(r,e,nd(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.ss.getDocumentsMatchingQuery(e,t,n?i:du.min(),n?s:Sd()))).next((e=>(mg(r,cd(t),e),{documents:e,Ts:s})))))}function fg(e,t){const n=Gl(e),r=Gl(n.Ur),i=n.os.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(e=>r.ot(e,t).next((e=>e?e.target:null))))}function pg(e,t){const n=Gl(e),r=n.us.get(t)||du.min();return n.persistence.runTransaction("Get new document changes","readonly",(e=>n.cs.getAllFromCollectionGroup(e,t,Eu(r,-1),Number.MAX_SAFE_INTEGER))).then((e=>(mg(n,t,e),e)))}function mg(e,t,n){let r=e.us.get(t)||du.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.us.set(t,r)}async function gg(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Sd();const r=await cg(e,nd(_p(t.bundledQuery))),i=Gl(e);return i.persistence.runTransaction("Save named query","readwrite",(e=>{const s=Uf(t.readTime);if(r.snapshotVersion.compareTo(s)>=0)return i.Gr.saveNamedQuery(e,t);const o=r.withResumeToken(Lc.EMPTY_BYTE_STRING,s);return i.os=i.os.insert(o.targetId,o),i.Ur.updateTargetData(e,o).next((()=>i.Ur.removeMatchingKeysForTargetId(e,r.targetId))).next((()=>i.Ur.addMatchingKeys(e,n,r.targetId))).next((()=>i.Gr.saveNamedQuery(e,t)))}))}function yg(e,t){return`firestore_clients_${e}_${t}`}function vg(e,t,n){let r=`firestore_mutations_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}function _g(e,t){return`firestore_targets_${e}_${t}`}class wg{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static Rs(e,t,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new Yl(r.error.code,r.error.message))),s?new wg(e,t,r.state,i):(Bl("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class bg{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Rs(e,t){const n=JSON.parse(t);let r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code,i&&(r=new Yl(n.error.code,n.error.message))),i?new bg(e,n.state,r):(Bl("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ig{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Cd();for(let s=0;r&&s<n.activeTargetIds.length;++s)r=Ku(n.activeTargetIds[s]),i=i.add(n.activeTargetIds[s]);return r?new Ig(e,i):(Bl("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Eg{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Eg(t.clientId,t.onlineState):(Bl("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Sg{constructor(){this.activeTargetIds=Cd()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Tg{constructor(e,t,n,r,i){this.window=e,this.ui=t,this.persistenceKey=n,this.ps=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new kc(lu),this.started=!1,this.bs=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ds=yg(this.persistenceKey,this.ps),this.vs=function(e){return`firestore_sequence_number_${e}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new Sg),this.Cs=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.xs=function(e){return`firestore_online_state_${e}`}(this.persistenceKey),this.Os=function(e){return`firestore_bundle_loaded_v2_${e}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const n of e){if(n===this.ps)continue;const e=this.getItem(yg(this.persistenceKey,n));if(e){const t=Ig.Rs(n,e);t&&(this.Ss=this.Ss.insert(t.clientId,t))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const e=this.Ls(t);e&&this.Bs(e)}for(const n of this.bs)this.ws(n);this.bs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach(((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,n){this.qs(e,t,n),this.Qs(e)}addLocalQueryTarget(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="not-current";if(this.isActiveQueryTarget(e)){const t=this.storage.getItem(_g(this.persistenceKey,e));if(t){const r=bg.Rs(e,t);r&&(n=r.state)}}return t&&this.Ks.fs(e),this.Ns(),n}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(_g(this.persistenceKey,e))}updateQueryState(e,t,n){this.$s(e,t,n)}handleUserChange(e,t,n){t.forEach((e=>{this.Qs(e)})),this.currentUser=e,n.forEach((e=>{this.addPendingMutation(e)}))}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return jl("SharedClientState","READ",e,t),t}setItem(e,t){jl("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){jl("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(jl("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void Bl("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable((async()=>{if(this.started){if(null!==t.key)if(this.Cs.test(t.key)){if(null==t.newValue){const e=this.Gs(t.key);return this.zs(e,null)}{const e=this.js(t.key,t.newValue);if(e)return this.zs(e.clientId,e)}}else if(this.Fs.test(t.key)){if(null!==t.newValue){const e=this.Hs(t.key,t.newValue);if(e)return this.Js(e)}}else if(this.Ms.test(t.key)){if(null!==t.newValue){const e=this.Ys(t.key,t.newValue);if(e)return this.Zs(e)}}else if(t.key===this.xs){if(null!==t.newValue){const e=this.Ls(t.newValue);if(e)return this.Bs(e)}}else if(t.key===this.vs){const e=function(e){let t=Bu.oe;if(null!=e)try{const n=JSON.parse(e);Hl("number"==typeof n),t=n}catch(e){Bl("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(t.newValue);e!==Bu.oe&&this.sequenceNumberHandler(e)}else if(t.key===this.Os){const e=this.Xs(t.newValue);await Promise.all(e.map((e=>this.syncEngine.eo(e))))}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,n){const r=new wg(this.currentUser,e,t,n),i=vg(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Vs())}Qs(e){const t=vg(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,n){const r=_g(this.persistenceKey,e),i=new bg(e,t,n);this.setItem(r,i.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const n=this.Gs(e);return Ig.Rs(n,t)}Hs(e,t){const n=this.Fs.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return wg.Rs(new Ul(i),r,t)}Ys(e,t){const n=this.Ms.exec(e),r=Number(n[1]);return bg.Rs(r,t)}Ls(e){return Eg.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);jl("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const n=t?this.Ss.insert(e,t):this.Ss.remove(e),r=this.ks(this.Ss),i=this.ks(n),s=[],o=[];return i.forEach((e=>{r.has(e)||s.push(e)})),r.forEach((e=>{i.has(e)||o.push(e)})),this.syncEngine.io(s,o).then((()=>{this.Ss=n}))}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=Cd();return e.forEach(((e,n)=>{t=t.unionWith(n.activeTargetIds)})),t}}class Cg{constructor(){this.so=new Sg,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Sg,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class kg{_o(e){}shutdown(){}}class xg{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){jl("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){jl("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Ng=null;function Pg(){return null===Ng?Ng=268435456+Math.round(2147483648*Math.random()):Ng++,"0x"+Ng.toString(16)}const Ag={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Rg{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}const Dg="WebChannelConnection";class Og extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Do=t+"://"+e.host,this.vo=`projects/${n}/databases/${r}`,this.Co="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${r}`}get Fo(){return!1}Mo(e,t,n,r,i){const s=Pg(),o=this.xo(e,t.toUriEncodedString());jl("RestConnection",`Sending RPC '${e}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(a,r,i),this.No(e,o,a,n).then((t=>(jl("RestConnection",`Received RPC '${e}' ${s}: `,t),t)),(t=>{throw $l("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t}))}Lo(e,t,n,r,i,s){return this.Mo(e,t,n,r,i)}Oo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Vl,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}xo(e,t){const n=Ag[e];return`${this.Do}/v1/${t}:${n}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,r){const i=Pg();return new Promise(((s,o)=>{const a=new kl;a.setWithCredentials(!0),a.listenOnce(Nl.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case Pl.NO_ERROR:const t=a.getResponseJson();jl(Dg,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),s(t);break;case Pl.TIMEOUT:jl(Dg,`RPC '${e}' ${i} timed out`),o(new Yl(Ql.DEADLINE_EXCEEDED,"Request time out"));break;case Pl.HTTP_ERROR:const n=a.getStatus();if(jl(Dg,`RPC '${e}' ${i} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Ql).indexOf(t)>=0?t:Ql.UNKNOWN}(t.status);o(new Yl(e,t.message))}else o(new Yl(Ql.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Yl(Ql.UNAVAILABLE,"Connection failed."));break;default:Kl()}}finally{jl(Dg,`RPC '${e}' ${i} completed.`)}}));const l=JSON.stringify(r);jl(Dg,`RPC '${e}' ${i} sending request:`,r),a.send(t,"POST",l,n,15)}))}Bo(e,t,n){const r=Pg(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Ol(),o=Dl(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Oo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const u=i.join("");jl(Dg,`Creating RPC '${e}' stream ${r}: ${u}`,a);const c=s.createWebChannel(u,a);let h=!1,d=!1;const f=new Rg({Io:t=>{d?jl(Dg,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(h||(jl(Dg,`Opening RPC '${e}' stream ${r} transport.`),c.open(),h=!0),jl(Dg,`RPC '${e}' stream ${r} sending:`,t),c.send(t))},To:()=>c.close()}),p=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return p(c,xl.EventType.OPEN,(()=>{d||(jl(Dg,`RPC '${e}' stream ${r} transport opened.`),f.yo())})),p(c,xl.EventType.CLOSE,(()=>{d||(d=!0,jl(Dg,`RPC '${e}' stream ${r} transport closed`),f.So())})),p(c,xl.EventType.ERROR,(t=>{d||(d=!0,$l(Dg,`RPC '${e}' stream ${r} transport errored:`,t),f.So(new Yl(Ql.UNAVAILABLE,"The operation could not be completed")))})),p(c,xl.EventType.MESSAGE,(t=>{var n;if(!d){const i=t.data[0];Hl(!!i);const s=i,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){jl(Dg,`RPC '${e}' stream ${r} received error:`,o);const t=o.status;let n=function(e){const t=cf[e];if(void 0!==t)return ff(t)}(t),i=o.message;void 0===n&&(n=Ql.INTERNAL,i="Unknown error status: "+t+" with message "+o.message),d=!0,f.So(new Yl(n,i)),c.close()}else jl(Dg,`RPC '${e}' stream ${r} received:`,i),f.bo(i)}})),p(o,Rl.STAT_EVENT,(t=>{t.stat===Al.PROXY?jl(Dg,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===Al.NOPROXY&&jl(Dg,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{f.wo()}),0),f}}function Lg(){return"undefined"!=typeof window?window:null}function Mg(){return"undefined"!=typeof document?document:null}function Fg(e){return new Df(e,!0)}class Ug{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ui=e,this.timerId=t,this.ko=n,this.qo=r,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-n);r>0&&jl("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,(()=>(this.Uo=Date.now(),e()))),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){null!==this.$o&&(this.$o.skipDelay(),this.$o=null)}cancel(){null!==this.$o&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}class Vg{constructor(e,t,n,r,i,s,o,a){this.ui=e,this.Ho=n,this.Jo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Ug(e,t)}n_(){return 1===this.state||5===this.state||this.r_()}r_(){return 2===this.state||3===this.state}start(){this.e_=0,4!==this.state?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&null===this.Zo&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,(()=>this.__())))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,4!==e?this.t_.reset():t&&t.code===Ql.RESOURCE_EXHAUSTED?(Bl(t.toString()),Bl("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===Ql.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,r]=e;this.Yo===t&&this.P_(n,r)}),(t=>{e((()=>{const e=new Yl(Ql.UNKNOWN,"Fetching auth token failed: "+t.message);return this.I_(e)}))}))}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo((()=>{n((()=>this.listener.Eo()))})),this.stream.Ro((()=>{n((()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,(()=>(this.r_()&&(this.state=3),Promise.resolve()))),this.listener.Ro())))})),this.stream.mo((e=>{n((()=>this.I_(e)))})),this.stream.onMessage((e=>{n((()=>1==++this.e_?this.E_(e):this.onNext(e)))}))}i_(){this.state=5,this.t_.Go((async()=>{this.state=0,this.start()}))}I_(e){return jl("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget((()=>this.Yo===e?t():(jl("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class qg extends Vg{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Kl()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(Hl(void 0===t||"string"==typeof t),Lc.fromBase64String(t||"")):(Hl(void 0===t||t instanceof Buffer||t instanceof Uint8Array),Lc.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?Ql.UNKNOWN:ff(e.code);return new Yl(t,e.message||"")}(o);n=new Tf(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=Bf(e,r.document.name),s=Uf(r.document.updateTime),o=r.document.createTime?Uf(r.document.createTime):du.min(),a=new mh({mapValue:{fields:r.document.fields}}),l=yh.newFoundDocument(i,s,o,a),u=r.targetIds||[],c=r.removedTargetIds||[];n=new Ef(u,c,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=Bf(e,r.document),s=r.readTime?Uf(r.readTime):du.min(),o=yh.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Ef([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=Bf(e,r.document),s=r.removedTargetIds||[];n=new Ef([],s,i,null)}else{if(!("filter"in t))return Kl();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new uf(r,i),o=e.targetId;n=new Sf(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return du.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?du.min():t.readTime?Uf(t.readTime):du.min()}(e);return this.listener.d_(t,n)}A_(e){const t={};t.database=Kf(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Kh(r)?{documents:Xf(e,r)}:{query:Zf(e,r)._t},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Mf(e,t.resumeToken);const r=Of(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(du.min())>0){n.readTime=Lf(e,t.snapshotVersion.toTimestamp());const r=Of(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Kl()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){const t={};t.database=Kf(this.serializer),t.removeTarget=e,this.a_(t)}}class zg extends Vg{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Hl(!!e.streamToken),this.lastStreamToken=e.streamToken,Hl(!e.writeResults||0===e.writeResults.length),this.listener.f_()}onNext(e){Hl(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=function(e,t){return e&&e.length>0?(Hl(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?Uf(e.updateTime):Uf(t);return n.isEqual(du.min())&&(n=Uf(t)),new Bd(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=Uf(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=Kf(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Yf(this.serializer,e)))};this.a_(t)}}class jg extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new Yl(Ql.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((i=>{let[s,o]=i;return this.connection.Mo(e,qf(t,n),r,s,o)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Ql.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Yl(Ql.UNKNOWN,e.toString())}))}Lo(e,t,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((s=>{let[o,a]=s;return this.connection.Lo(e,qf(t,n),r,o,a,i)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Ql.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Yl(Ql.UNKNOWN,e.toString())}))}terminate(){this.y_=!0,this.connection.terminate()}}class Bg{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){0===this.S_&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve()))))}M_(e){"Online"===this.state?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,"Online"===e&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Bl(t),this.D_=!1):jl("OnlineStateTracker",t)}x_(){null!==this.b_&&(this.b_.cancel(),this.b_=null)}}class $g{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o((e=>{n.enqueueAndForget((async()=>{Zg(this)&&(jl("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Gl(e);t.L_.add(4),await Kg(t),t.q_.set("Unknown"),t.L_.delete(4),await Wg(t)}(this))}))})),this.q_=new Bg(n,r)}}async function Wg(e){if(Zg(e))for(const t of e.B_)await t(!0)}async function Kg(e){for(const t of e.B_)await t(!1)}function Hg(e,t){const n=Gl(e);n.N_.has(t.targetId)||(n.N_.set(t.targetId,t),Xg(n)?Jg(n):vy(n).r_()&&Qg(n,t))}function Gg(e,t){const n=Gl(e),r=vy(n);n.N_.delete(t),r.r_()&&Yg(n,t),0===n.N_.size&&(r.r_()?r.o_():Zg(n)&&n.q_.set("Unknown"))}function Qg(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(du.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}vy(e).A_(t)}function Yg(e,t){e.Q_.xe(t),vy(e).R_(t)}function Jg(e){e.Q_=new kf({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),vy(e).start(),e.q_.v_()}function Xg(e){return Zg(e)&&!vy(e).n_()&&e.N_.size>0}function Zg(e){return 0===Gl(e).L_.size}function ey(e){e.Q_=void 0}async function ty(e){e.q_.set("Online")}async function ny(e){e.N_.forEach(((t,n)=>{Qg(e,t)}))}async function ry(e,t){ey(e),Xg(e)?(e.q_.M_(t),Jg(e)):e.q_.set("Unknown")}async function iy(e,t,n){if(e.q_.set("Online"),t instanceof Tf&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.N_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.N_.delete(r),e.Q_.removeTarget(r))}(e,t)}catch(n){jl("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await sy(e,n)}else if(t instanceof Ef?e.Q_.Ke(t):t instanceof Sf?e.Q_.He(t):e.Q_.We(t),!n.isEqual(du.min()))try{const t=await ag(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Q_.rt(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.N_.get(r);i&&e.N_.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.N_.get(t);if(!r)return;e.N_.set(t,r.withResumeToken(Lc.EMPTY_BYTE_STRING,r.snapshotVersion)),Yg(e,t);const i=new cp(r.target,t,n,r.sequenceNumber);Qg(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){jl("RemoteStore","Failed to raise snapshot:",t),await sy(e,t)}}async function sy(e,t,n){if(!Mu(t))throw t;e.L_.add(1),await Kg(e),e.q_.set("Offline"),n||(n=()=>ag(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{jl("RemoteStore","Retrying IndexedDB access"),await n(),e.L_.delete(1),await Wg(e)}))}function oy(e,t){return t().catch((n=>sy(e,n,t)))}async function ay(e){const t=Gl(e),n=_y(t);let r=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;ly(t);)try{const e=await ug(t.localStore,r);if(null===e){0===t.O_.length&&n.o_();break}r=e.batchId,uy(t,e)}catch(e){await sy(t,e)}cy(t)&&hy(t)}function ly(e){return Zg(e)&&e.O_.length<10}function uy(e,t){e.O_.push(t);const n=_y(e);n.r_()&&n.V_&&n.m_(t.mutations)}function cy(e){return Zg(e)&&!_y(e).n_()&&e.O_.length>0}function hy(e){_y(e).start()}async function dy(e){_y(e).p_()}async function fy(e){const t=_y(e);for(const n of e.O_)t.m_(n.mutations)}async function py(e,t,n){const r=e.O_.shift(),i=af.from(r,t,n);await oy(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await ay(e)}async function my(e,t){t&&_y(e).V_&&await async function(e,t){if(function(e){return df(e)&&e!==Ql.ABORTED}(t.code)){const n=e.O_.shift();_y(e).s_(),await oy(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await ay(e)}}(e,t),cy(e)&&hy(e)}async function gy(e,t){const n=Gl(e);n.asyncQueue.verifyOperationInProgress(),jl("RemoteStore","RemoteStore received new credentials");const r=Zg(n);n.L_.add(3),await Kg(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.L_.delete(3),await Wg(n)}async function yy(e,t){const n=Gl(e);t?(n.L_.delete(2),await Wg(n)):t||(n.L_.add(2),await Kg(n),n.q_.set("Unknown"))}function vy(e){return e.K_||(e.K_=function(e,t,n){const r=Gl(e);return r.w_(),new qg(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:ty.bind(null,e),Ro:ny.bind(null,e),mo:ry.bind(null,e),d_:iy.bind(null,e)}),e.B_.push((async t=>{t?(e.K_.s_(),Xg(e)?Jg(e):e.q_.set("Unknown")):(await e.K_.stop(),ey(e))}))),e.K_}function _y(e){return e.U_||(e.U_=function(e,t,n){const r=Gl(e);return r.w_(),new zg(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:dy.bind(null,e),mo:my.bind(null,e),f_:fy.bind(null,e),g_:py.bind(null,e)}),e.B_.push((async t=>{t?(e.U_.s_(),await ay(e)):(await e.U_.stop(),e.O_.length>0&&(jl("RemoteStore",`Stopping write stream with ${e.O_.length} pending writes`),e.O_=[]))}))),e.U_}class wy{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Jl,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new wy(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Yl(Ql.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function by(e,t){if(Bl("AsyncQueue",`${t}: ${e}`),Mu(e))return new Yl(Ql.UNAVAILABLE,`${t}: ${e}`);throw e}class Iy{constructor(e){this.comparator=e?(t,n)=>e(t,n)||yu.comparator(t.key,n.key):(e,t)=>yu.comparator(e.key,t.key),this.keyedMap=yd(),this.sortedSet=new kc(this.comparator)}static emptySet(e){return new Iy(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Iy))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Iy;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Ey{constructor(){this.W_=new kc(yu.comparator)}track(e){const t=e.doc.key,n=this.W_.get(t);n?0!==e.type&&3===n.type?this.W_=this.W_.insert(t,e):3===e.type&&1!==n.type?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.W_=this.W_.remove(t):1===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Kl():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Sy{constructor(e,t,n,r,i,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach((e=>{s.push({type:0,doc:e})})),new Sy(e,t,Iy.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&od(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class Ty{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some((e=>e.J_()))}}class Cy{constructor(){this.queries=ky(),this.onlineState="Unknown",this.Y_=new Set}terminate(){!function(e,t){const n=Gl(e),r=n.queries;n.queries=ky(),r.forEach(((e,n)=>{for(const r of n.j_)r.onError(t)}))}(this,new Yl(Ql.ABORTED,"Firestore shutting down"))}}function ky(){return new fd((e=>ad(e)),od)}async function xy(e,t){const n=Gl(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.H_()&&t.J_()&&(r=2):(s=new Ty,r=t.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=by(e,`Initialization of query '${ld(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,s),s.j_.push(t),t.Z_(n.onlineState),s.z_&&t.X_(s.z_)&&Ry(n)}async function Ny(e,t){const n=Gl(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.j_.indexOf(t);e>=0&&(s.j_.splice(e,1),0===s.j_.length?i=t.J_()?0:1:!s.H_()&&t.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Py(e,t){const n=Gl(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.j_)e.X_(i)&&(r=!0);t.z_=i}}r&&Ry(n)}function Ay(e,t,n){const r=Gl(e),i=r.queries.get(t);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(t)}function Ry(e){e.Y_.forEach((e=>{e.next()}))}var Dy,Oy;(Oy=Dy||(Dy={})).ea="default",Oy.Cache="cache";class Ly{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Sy(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache)return!0;if(!this.J_())return!0;const n="Offline"!==t;return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}oa(e){e=Sy.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Dy.Cache}}class My{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}}class Fy{constructor(e){this.serializer=e}Es(e){return Bf(this.serializer,e)}ds(e){return e.metadata.exists?Qf(this.serializer,e.document,!1):yh.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return Uf(e)}}class Uy{constructor(e,t,n){this.ca=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Vy(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;const n=pu.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){const t=new Map,n=new Fy(this.serializer);for(const r of e)if(r.metadata.queries){const e=n.Es(r.metadata.name);for(const n of r.metadata.queries){const r=(t.get(n)||Sd()).add(e);t.set(n,r)}}return t}async complete(){const e=await async function(e,t,n,r){const i=Gl(e);let s=Sd(),o=md();for(const u of n){const e=t.Es(u.metadata.name);u.document&&(s=s.add(e));const n=t.ds(u);n.setReadTime(t.As(u.metadata.readTime)),o=o.insert(e,n)}const a=i.cs.newChangeBuffer({trackRemovals:!0}),l=await cg(i,function(e){return nd(Xh(pu.fromString(`__bundle__/docs/${e}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(e=>lg(e,a,o).next((t=>(a.apply(e),t))).next((t=>i.Ur.removeMatchingKeysForTargetId(e,l.targetId).next((()=>i.Ur.addMatchingKeys(e,s,l.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(e,t.Ps,t.Is))).next((()=>t.Ps))))))}(this.localStore,new Fy(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(const n of this.queries)await gg(this.localStore,n,t.get(n.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function Vy(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class qy{constructor(e){this.key=e}}class zy{constructor(e){this.key=e}}class jy{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Sd(),this.mutatedKeys=Sd(),this.Aa=hd(e),this.Ra=new Iy(this.Aa)}get Va(){return this.Ta}ma(e,t){const n=t?t.fa:new Ey,r=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const u=r.get(e),c=ud(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!c&&(c.hasLocalMutations||this.mutatedKeys.has(c.key)&&c.hasCommittedMutations);let f=!1;u&&c?u.data.isEqual(c.data)?h!==d&&(n.track({type:3,doc:c}),f=!0):this.ga(u,c)||(n.track({type:2,doc:c}),f=!0,(a&&this.Aa(c,a)>0||l&&this.Aa(c,l)<0)&&(o=!0)):!u&&c?(n.track({type:0,doc:c}),f=!0):u&&!c&&(n.track({type:1,doc:u}),f=!0,(a||l)&&(o=!0)),f&&(c?(s=s.add(c),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Ra:s,fa:n,ns:o,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const s=e.fa.G_();s.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Kl()}};return n(e)-n(t)}(e.type,t.type)||this.Aa(e.doc,t.doc))),this.pa(n),r=null!=r&&r;const o=t&&!r?this.ya():[],a=0===this.da.size&&this.current&&!r?1:0,l=a!==this.Ea;return this.Ea=a,0!==s.length||l?{snapshot:new Sy(this.query,e.Ra,i,s,e.mutatedKeys,0===a,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Ey,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach((e=>this.Ta=this.Ta.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Ta=this.Ta.delete(e))),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Sd(),this.Ra.forEach((e=>{this.Sa(e.key)&&(this.da=this.da.add(e.key))}));const t=[];return e.forEach((e=>{this.da.has(e)||t.push(new zy(e))})),this.da.forEach((n=>{e.has(n)||t.push(new qy(n))})),t}ba(e){this.Ta=e.Ts,this.da=Sd();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Sy.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,0===this.Ea,this.hasCachedResults)}}class By{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class $y{constructor(e){this.key=e,this.va=!1}}class Wy{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new fd((e=>ad(e)),od),this.Ma=new Map,this.xa=new Set,this.Oa=new kc(yu.comparator),this.Na=new Map,this.La=new Vm,this.Ba={},this.ka=new Map,this.qa=fm.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return!0===this.Qa}}async function Ky(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=bv(e);let i;const s=r.Fa.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await Gy(r,t,n,!0),i}async function Hy(e,t){const n=bv(e);await Gy(n,t,!0,!1)}async function Gy(e,t,n,r){const i=await cg(e.localStore,nd(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await Qy(e,t,s,"current"===o,i.resumeToken)),e.isPrimaryClient&&n&&Hg(e.remoteStore,i),a}async function Qy(e,t,n,r,i){e.Ka=(t,n,r)=>async function(e,t,n,r){let i=t.view.ma(n);i.ns&&(i=await dg(e.localStore,t.query,!1).then((e=>{let{documents:n}=e;return t.view.ma(n,i)})));const s=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s,o);return av(e,t.targetId,a.wa),a.snapshot}(e,t,n,r);const s=await dg(e.localStore,t,!0),o=new jy(t,s.Ts),a=o.ma(s.documents),l=If.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),u=o.applyChanges(a,e.isPrimaryClient,l);av(e,n,u.wa);const c=new By(t,n,o);return e.Fa.set(t,c),e.Ma.has(n)?e.Ma.get(n).push(t):e.Ma.set(n,[t]),u.snapshot}async function Yy(e,t,n){const r=Gl(e),i=r.Fa.get(t),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter((e=>!od(e,t)))),void r.Fa.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await hg(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Gg(r.remoteStore,i.targetId),sv(r,i.targetId)})).catch(Nu)):(sv(r,i.targetId),await hg(r.localStore,i.targetId,!0))}async function Jy(e,t){const n=Gl(e),r=n.Fa.get(t),i=n.Ma.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Gg(n.remoteStore,r.targetId))}async function Xy(e,t){const n=Gl(e);try{const e=await function(e,t){const n=Gl(e),r=t.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const o=[];t.targetChanges.forEach(((s,a)=>{const l=i.get(a);if(!l)return;o.push(n.Ur.removeMatchingKeys(e,s.removedDocuments,a).next((()=>n.Ur.addMatchingKeys(e,s.addedDocuments,a))));let u=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?u=u.withResumeToken(Lc.EMPTY_BYTE_STRING,du.min()).withLastLimboFreeSnapshotVersion(du.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,r)),i=i.insert(a,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,u,s)&&o.push(n.Ur.updateTargetData(e,u))}));let a=md(),l=Sd();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(lg(e,s,t.documentUpdates).next((e=>{a=e.Ps,l=e.Is}))),!r.isEqual(du.min())){const t=n.Ur.getLastRemoteSnapshotVersion(e).next((t=>n.Ur.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return Pu.waitFor(o).next((()=>s.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,l))).next((()=>a))})).then((e=>(n.os=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Na.get(t);r&&(Hl(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.va=!0:e.modifiedDocuments.size>0?Hl(r.va):e.removedDocuments.size>0&&(Hl(r.va),r.va=!1))})),await cv(n,e,t)}catch(e){await Nu(e)}}function Zy(e,t,n){const r=Gl(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Fa.forEach(((n,r)=>{const i=r.view.Z_(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=Gl(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const i of n.j_)i.Z_(t)&&(r=!0)})),r&&Ry(n)}(r.eventManager,t),e.length&&r.Ca.d_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function ev(e,t,n){const r=Gl(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Na.get(t),s=i&&i.key;if(s){let e=new kc(yu.comparator);e=e.insert(s,yh.newNoDocument(s,du.min()));const n=Sd().add(s),i=new bf(du.min(),new Map,new kc(lu),e,n);await Xy(r,i),r.Oa=r.Oa.remove(s),r.Na.delete(t),uv(r)}else await hg(r.localStore,t,!1).then((()=>sv(r,t,n))).catch(Nu)}async function tv(e,t){const n=Gl(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Gl(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=Pu.resolve();return s.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);Hl(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Sd();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);iv(n,r,null),rv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await cv(n,e)}catch(e){await Nu(e)}}async function nv(e,t,n){const r=Gl(e);try{const e=await function(e,t){const n=Gl(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(Hl(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);iv(r,t,n),rv(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await cv(r,e)}catch(n){await Nu(n)}}function rv(e,t){(e.ka.get(t)||[]).forEach((e=>{e.resolve()})),e.ka.delete(t)}function iv(e,t,n){const r=Gl(e);let i=r.Ba[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Ba[r.currentUser.toKey()]=i}}function sv(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Ma.get(t))e.Fa.delete(r),n&&e.Ca.$a(r,n);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach((t=>{e.La.containsKey(t)||ov(e,t)}))}function ov(e,t){e.xa.delete(t.path.canonicalString());const n=e.Oa.get(t);null!==n&&(Gg(e.remoteStore,n),e.Oa=e.Oa.remove(t),e.Na.delete(n),uv(e))}function av(e,t,n){for(const r of n)r instanceof qy?(e.La.addReference(r.key,t),lv(e,r)):r instanceof zy?(jl("SyncEngine","Document no longer in limbo: "+r.key),e.La.removeReference(r.key,t),e.La.containsKey(r.key)||ov(e,r.key)):Kl()}function lv(e,t){const n=t.key,r=n.path.canonicalString();e.Oa.get(n)||e.xa.has(r)||(jl("SyncEngine","New document in limbo: "+n),e.xa.add(r),uv(e))}function uv(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const n=new yu(pu.fromString(t)),r=e.qa.next();e.Na.set(r,new $y(n)),e.Oa=e.Oa.insert(n,r),Hg(e.remoteStore,new cp(nd(Xh(n.path)),r,"TargetPurposeLimboResolution",Bu.oe))}}async function cv(e,t,n){const r=Gl(e),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach(((e,a)=>{o.push(r.Ka(a,t,n).then((e=>{var t;if((e||n)&&r.isPrimaryClient){const i=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(a.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(a.targetId,i?"current":"not-current")}if(e){i.push(e);const t=tg.Wi(a.targetId,e);s.push(t)}})))})),await Promise.all(o),r.Ca.d_(i),await async function(e,t){const n=Gl(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>Pu.forEach(t,(t=>Pu.forEach(t.$i,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>Pu.forEach(t.Ui,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!Mu(e))throw e;jl("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.os.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.os=n.os.insert(e,i)}}}(r.localStore,s))}async function hv(e,t){const n=Gl(e);if(!n.currentUser.isEqual(t)){jl("SyncEngine","User change. New user:",t.toKey());const e=await og(n.localStore,t);n.currentUser=t,function(e,t){e.ka.forEach((e=>{e.forEach((e=>{e.reject(new Yl(Ql.CANCELLED,t))}))})),e.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await cv(n,e.hs)}}function dv(e,t){const n=Gl(e),r=n.Na.get(t);if(r&&r.va)return Sd().add(r.key);{let e=Sd();const r=n.Ma.get(t);if(!r)return e;for(const t of r){const r=n.Fa.get(t);e=e.unionWith(r.view.Va)}return e}}async function fv(e,t){const n=Gl(e),r=await dg(n.localStore,t.query,!0),i=t.view.ba(r);return n.isPrimaryClient&&av(n,t.targetId,i.wa),i}async function pv(e,t){const n=Gl(e);return pg(n.localStore,t).then((e=>cv(n,e)))}async function mv(e,t,n,r){const i=Gl(e),s=await function(e,t){const n=Gl(e),r=Gl(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",(e=>r.Mn(e,t).next((t=>t?n.localDocuments.getDocuments(e,t):Pu.resolve(null)))))}(i.localStore,t);null!==s?("pending"===n?await ay(i.remoteStore):"acknowledged"===n||"rejected"===n?(iv(i,t,r||null),rv(i,t),function(e,t){Gl(Gl(e).mutationQueue).On(t)}(i.localStore,t)):Kl(),await cv(i,s)):jl("SyncEngine","Cannot apply mutation batch with id: "+t)}async function gv(e,t,n){const r=Gl(e),i=[],s=[];for(const o of t){let e;const t=r.Ma.get(o);if(t&&0!==t.length){e=await cg(r.localStore,nd(t[0]));for(const e of t){const t=r.Fa.get(e),n=await fv(r,t);n.snapshot&&s.push(n.snapshot)}}else{const t=await fg(r.localStore,o);e=await cg(r.localStore,t),await Qy(r,yv(t),o,!1,e.resumeToken)}i.push(e)}return r.Ca.d_(s),i}function yv(e){return Jh(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function vv(e){return function(e){return Gl(Gl(e).persistence).Qi()}(Gl(e).localStore)}async function _v(e,t,n,r){const i=Gl(e);if(i.Qa)return void jl("SyncEngine","Ignoring unexpected query state notification.");const s=i.Ma.get(t);if(s&&s.length>0)switch(n){case"current":case"not-current":{const e=await pg(i.localStore,cd(s[0])),r=bf.createSynthesizedRemoteEventForCurrentChange(t,"current"===n,Lc.EMPTY_BYTE_STRING);await cv(i,e,r);break}case"rejected":await hg(i.localStore,t,!0),sv(i,t,r);break;default:Kl()}}async function wv(e,t,n){const r=bv(e);if(r.Qa){for(const e of t){if(r.Ma.has(e)&&r.sharedClientState.isActiveQueryTarget(e)){jl("SyncEngine","Adding an already active target "+e);continue}const t=await fg(r.localStore,e),n=await cg(r.localStore,t);await Qy(r,yv(t),n.targetId,!1,n.resumeToken),Hg(r.remoteStore,n)}for(const e of n)r.Ma.has(e)&&await hg(r.localStore,e,!1).then((()=>{Gg(r.remoteStore,e),sv(r,e)})).catch(Nu)}}function bv(e){const t=Gl(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Xy.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=dv.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=ev.bind(null,t),t.Ca.d_=Py.bind(null,t.eventManager),t.Ca.$a=Ay.bind(null,t.eventManager),t}function Iv(e){const t=Gl(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=tv.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=nv.bind(null,t),t}class Ev{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Fg(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return sg(this.persistence,new rg,e.initialUser,this.serializer)}Ga(e){return new Wm(Hm.Zr,this.serializer)}Wa(e){return new Cg}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ev.provider={build:()=>new Ev};class Sv extends Ev{constructor(e,t,n){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Iv(this.Ja.syncEngine),await ay(this.Ja.remoteStore),await this.persistence.yi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}za(e){return sg(this.persistence,new rg,e.initialUser,this.serializer)}ja(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new wm(n,e.asyncQueue,t)}Ha(e,t){const n=new ju(t,this.persistence);return new zu(e.asyncQueue,n)}Ga(e){const t=eg(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?sm.withCacheSize(this.cacheSizeBytes):sm.DEFAULT;return new Jm(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,Lg(),Mg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new Cg}}class Tv extends Sv{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof Tg&&(this.sharedClientState.syncEngine={no:mv.bind(null,t),ro:_v.bind(null,t),io:wv.bind(null,t),Qi:vv.bind(null,t),eo:pv.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi((async e=>{await async function(e,t){const n=Gl(e);if(bv(n),Iv(n),!0===t&&!0!==n.Qa){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await gv(n,e.toArray());n.Qa=!0,await yy(n.remoteStore,!0);for(const r of t)Hg(n.remoteStore,r)}else if(!1===t&&!1!==n.Qa){const e=[];let t=Promise.resolve();n.Ma.forEach(((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then((()=>(sv(n,i),hg(n.localStore,i,!0)))),Gg(n.remoteStore,i)})),await t,await gv(n,e),function(e){const t=Gl(e);t.Na.forEach(((e,n)=>{Gg(t.remoteStore,n)})),t.La.pr(),t.Na=new Map,t.Oa=new kc(yu.comparator)}(n),n.Qa=!1,await yy(n.remoteStore,!1)}}(this.Ja.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())}))}Wa(e){const t=Lg();if(!Tg.D(t))throw new Yl(Ql.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=eg(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Tg(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class Cv{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Zy(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=hv.bind(null,this.syncEngine),await yy(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Cy}createDatastore(e){const t=Fg(e.databaseInfo.databaseId),n=function(e){return new Og(e)}(e.databaseInfo);return function(e,t,n,r){return new jg(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new $g(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>Zy(this.syncEngine,e,0)),xg.D()?new xg:new kg)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new Wy(e,t,n,r,i,s);return o&&(a.Qa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=Gl(e);jl("RemoteStore","RemoteStore shutting down."),t.L_.add(5),await Kg(t),t.k_.shutdown(),t.q_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}function kv(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10240,n=0;return{async read(){if(n<e.byteLength){const r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}Cv.provider={build:()=>new Cv};class xv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Bl("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class Nv{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new Jl,this.buffer=new Uint8Array,this.eu=new TextDecoder("utf-8"),this.tu().then((e=>{e&&e.ua()?this.metadata.resolve(e.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==e?void 0:e.aa)}`))}),(e=>this.metadata.reject(e)))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(null===e)return null;const t=this.eu.decode(e),n=Number(t);isNaN(n)&&this.ru(`length string (${t}) is not valid number`);const r=await this.iu(n);return new My(JSON.parse(r),e.length+n)}su(){return this.buffer.findIndex((e=>e==="{".charCodeAt(0)))}async nu(){for(;this.su()<0&&!await this.ou(););if(0===this.buffer.length)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class Pv{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Yl(Ql.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(e,t){const n=Gl(e),r={documents:t.map((e=>jf(n.serializer,e)))},i=await n.Lo("BatchGetDocuments",n.serializer.databaseId,pu.emptyPath(),r,t.length),s=new Map;i.forEach((e=>{const t=function(e,t){return"found"in t?function(e,t){Hl(!!t.found),t.found.name,t.found.updateTime;const n=Bf(e,t.found.name),r=Uf(t.found.updateTime),i=t.found.createTime?Uf(t.found.createTime):du.min(),s=new mh({mapValue:{fields:t.found.fields}});return yh.newFoundDocument(n,r,i,s)}(e,t):"missing"in t?function(e,t){Hl(!!t.missing),Hl(!!t.readTime);const n=Bf(e,t.missing),r=Uf(t.readTime);return yh.newNoDocument(n,r)}(e,t):Kl()}(n.serializer,e);s.set(t.key.toString(),t)}));const o=[];return t.forEach((e=>{const t=s.get(e.toString());Hl(!!t),o.push(t)})),o}(this.datastore,e);return t.forEach((e=>this.recordVersion(e))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new rf(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((e,t)=>{const n=yu.fromPath(t);this.mutations.push(new sf(n,this.precondition(n)))})),await async function(e,t){const n=Gl(e),r={writes:t.map((e=>Yf(n.serializer,e)))};await n.Mo("Commit",n.serializer.databaseId,pu.emptyPath(),r)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Kl();t=du.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new Yl(Ql.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(du.min())?$d.exists(!1):$d.updateTime(t):$d.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(du.min()))throw new Yl(Ql.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return $d.updateTime(t)}return $d.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Av{constructor(e,t,n,r,i){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=i,this._u=n.maxAttempts,this.t_=new Ug(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go((async()=>{const e=new Pv(this.datastore),t=this.cu(e);t&&t.then((t=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(t)})).catch((e=>{this.lu(e)}))))})).catch((e=>{this.lu(e)}))}))}cu(e){try{const t=this.updateFunction(e);return!$u(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget((()=>(this.uu(),Promise.resolve())))):this.deferred.reject(e)}hu(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!df(t)}return!1}}class Rv{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Ul.UNAUTHENTICATED,this.clientId=au.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async e=>{jl("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(jl("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Jl;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=by(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Dv(e,t){e.asyncQueue.verifyOperationInProgress(),jl("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await og(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function Ov(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Lv(e);jl("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>gy(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>gy(t.remoteStore,n))),e._onlineComponents=t}async function Lv(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){jl("FirestoreClient","Using user provided OfflineComponentProvider");try{await Dv(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===Ql.FAILED_PRECONDITION||e.code===Ql.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;$l("Error using user provided cache. Falling back to memory cache: "+n),await Dv(e,new Ev)}}else jl("FirestoreClient","Using default OfflineComponentProvider"),await Dv(e,new Ev);return e._offlineComponents}async function Mv(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(jl("FirestoreClient","Using user provided OnlineComponentProvider"),await Ov(e,e._uninitializedComponentsProvider._online)):(jl("FirestoreClient","Using default OnlineComponentProvider"),await Ov(e,new Cv))),e._onlineComponents}function Fv(e){return Lv(e).then((e=>e.persistence))}function Uv(e){return Lv(e).then((e=>e.localStore))}function Vv(e){return Mv(e).then((e=>e.remoteStore))}function qv(e){return Mv(e).then((e=>e.syncEngine))}function zv(e){return Mv(e).then((e=>e.datastore))}async function jv(e){const t=await Mv(e),n=t.eventManager;return n.onListen=Ky.bind(null,t.syncEngine),n.onUnlisten=Yy.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Hy.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Jy.bind(null,t.syncEngine),n}function Bv(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Jl;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new xv({next:a=>{s.Za(),t.enqueueAndForget((()=>Ny(e,o)));const l=a.docs.has(n);!l&&a.fromCache?i.reject(new Yl(Ql.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&a.fromCache&&r&&"server"===r.source?i.reject(new Yl(Ql.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:e=>i.reject(e)}),o=new Ly(Xh(n.path),s,{includeMetadataChanges:!0,_a:!0});return xy(e,o)}(await jv(e),e.asyncQueue,t,n,r))),r.promise}function $v(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Jl;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new xv({next:n=>{s.Za(),t.enqueueAndForget((()=>Ny(e,o))),n.fromCache&&"server"===r.source?i.reject(new Yl(Ql.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new Ly(n,s,{includeMetadataChanges:!0,_a:!0});return xy(e,o)}(await jv(e),e.asyncQueue,t,n,r))),r.promise}function Wv(e,t,n,r){const i=function(e,t){let n;return n="string"==typeof e?mf().encode(e):e,function(e,t){return new Nv(e,t)}(function(e,t){if(e instanceof Uint8Array)return kv(e,t);if(e instanceof ArrayBuffer)return kv(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n),t)}(n,Fg(t));e.asyncQueue.enqueueAndForget((async()=>{!function(e,t,n){const r=Gl(e);(async function(e,t,n){try{const r=await t.getMetadata();if(await function(e,t){const n=Gl(e),r=Uf(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(e=>n.Gr.getBundleMetadata(e,t.id))).then((e=>!!e&&e.createTime.compareTo(r)>=0))}(e.localStore,r))return await t.close(),n._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(r)),Promise.resolve(new Set);n._updateProgress(Vy(r));const i=new Uy(r,e.localStore,t.serializer);let s=await t.Ua();for(;s;){const e=await i.la(s);e&&n._updateProgress(e),s=await t.Ua()}const o=await i.complete();return await cv(e,o.Ia,void 0),await function(e,t){const n=Gl(e);return n.persistence.runTransaction("Save bundle","readwrite",(e=>n.Gr.saveBundleMetadata(e,t)))}(e.localStore,r),n._completeWith(o.progress),Promise.resolve(o.Pa)}catch(e){return $l("SyncEngine",`Loading bundle failed with ${e}`),n._failWith(e),Promise.resolve(new Set)}})(r,t,n).then((e=>{r.sharedClientState.notifyBundleLoaded(e)}))}(await qv(e),i,r)}))}function Kv(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Hv=new Map;function Gv(e,t,n){if(!n)throw new Yl(Ql.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Qv(e,t,n,r){if(!0===t&&!0===r)throw new Yl(Ql.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Yv(e){if(!yu.isDocumentKey(e))throw new Yl(Ql.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Jv(e){if(yu.isDocumentKey(e))throw new Yl(Ql.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Xv(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Kl()}function Zv(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Yl(Ql.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Xv(e);throw new Yl(Ql.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function e_(e,t){if(t<=0)throw new Yl(Ql.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}class t_{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Yl(Ql.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Yl(Ql.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Qv("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Kv(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Yl(Ql.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Yl(Ql.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Yl(Ql.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class n_{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new t_({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Yl(Ql.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Yl(Ql.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new t_(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Zl;switch(e.type){case"firstParty":return new ru(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Yl(Ql.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Hv.get(e);t&&(jl("ComponentProvider","Removing Datastore"),Hv.delete(e),t.terminate())}(this),Promise.resolve()}}function r_(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const s=(e=Zv(e,n_))._getSettings(),o=`${t}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&$l("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Ul.MOCK_USER;else{t=ze(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Yl(Ql.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Ul(s)}e._authCredentials=new eu(new Xl(t,n))}}class i_{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new i_(this.firestore,e,this._query)}}class s_{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new o_(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new s_(this.firestore,e,this._key)}}class o_ extends i_{constructor(e,t,n){super(e,t,Xh(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new s_(this.firestore,null,new yu(e))}withConverter(e){return new o_(this.firestore,e,this._path)}}function a_(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=It(e),Gv("collection","path",t),e instanceof n_){const n=pu.fromString(t,...r);return Jv(n),new o_(e,null,n)}{if(!(e instanceof s_||e instanceof o_))throw new Yl(Ql.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(pu.fromString(t,...r));return Jv(n),new o_(e.firestore,null,n)}}function l_(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=It(e),1===arguments.length&&(t=au.newId()),Gv("doc","path",t),e instanceof n_){const n=pu.fromString(t,...r);return Yv(n),new s_(e,null,new yu(n))}{if(!(e instanceof s_||e instanceof o_))throw new Yl(Ql.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(pu.fromString(t,...r));return Yv(n),new s_(e.firestore,e instanceof o_?e.converter:null,new yu(n))}}function u_(e,t){return e=It(e),t=It(t),(e instanceof s_||e instanceof o_)&&(t instanceof s_||t instanceof o_)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function c_(e,t){return e=It(e),t=It(t),e instanceof i_&&t instanceof i_&&e.firestore===t.firestore&&od(e._query,t._query)&&e.converter===t.converter}class h_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Ug(this,"async_queue_retry"),this.Vu=()=>{const e=Mg();e&&jl("AsyncQueue","Visibility state changed to "+e.visibilityState),this.t_.jo()},this.mu=e;const t=Mg();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Mg();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise((()=>{}));const t=new Jl;return this.gu((()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Pu.push(e),this.pu())))}async pu(){if(0!==this.Pu.length){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(cx){if(!Mu(cx))throw cx;jl("AsyncQueue","Operation failed with retryable error: "+cx)}this.Pu.length>0&&this.t_.Go((()=>this.pu()))}}gu(e){const t=this.mu.then((()=>(this.du=!0,e().catch((e=>{this.Eu=e,this.du=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Bl("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.du=!1,e))))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const r=wy.createAndSchedule(this,e,t,n,(e=>this.yu(e)));return this.Tu.push(r),r}fu(){this.Eu&&Kl()}verifyOperationInProgress(){}async wu(){let e;do{e=this.mu,await e}while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then((()=>{this.Tu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.Tu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.wu()}))}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function d_(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class f_{constructor(){this._progressObserver={},this._taskCompletionResolver=new Jl,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class p_ extends n_{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new h_,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new h_(e),this._firestoreClient=void 0,await e}}}function m_(e){if(e._terminated)throw new Yl(Ql.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||g_(e),e._firestoreClient}function g_(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new Bc(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Kv(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new Rv(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}function y_(e,t,n){if((e=Zv(e,p_))._firestoreClient||e._terminated)throw new Yl(Ql.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new Yl(Ql.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:t,_offline:n},g_(e)}function v_(e){return function(e){const t=new Jl;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t){const n=Gl(e);Zg(n.remoteStore)||jl("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(e){const t=Gl(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(e=>t.mutationQueue.getHighestUnacknowledgedBatchId(e)))}(n.localStore);if(-1===e)return void t.resolve();const r=n.ka.get(e)||[];r.push(t),n.ka.set(e,r)}catch(e){const n=by(e,"Initialization of waitForPendingWrites() operation failed");t.reject(n)}}(await qv(e),t))),t.promise}(m_(e=Zv(e,p_)))}function __(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await Fv(e),n=await Vv(e);return t.setNetworkEnabled(!0),function(e){const t=Gl(e);return t.L_.delete(0),Wg(t)}(n)}))}(m_(e=Zv(e,p_)))}function w_(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await Fv(e),n=await Vv(e);return t.setNetworkEnabled(!1),async function(e){const t=Gl(e);t.L_.add(0),await Kg(t),t.q_.set("Offline")}(n)}))}(m_(e=Zv(e,p_)))}function b_(e,t){return function(e,t){return e.asyncQueue.enqueue((async()=>function(e,t){const n=Gl(e);return n.persistence.runTransaction("Get named query","readonly",(e=>n.Gr.getNamedQuery(e,t)))}(await Uv(e),t)))}(m_(e=Zv(e,p_)),t).then((t=>t?new i_(e,null,t.query):null))}class I_{constructor(e){this._byteString=e}static fromBase64String(e){try{return new I_(Lc.fromBase64String(e))}catch(e){throw new Yl(Ql.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new I_(Lc.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class E_{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new Yl(Ql.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gu(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class S_{constructor(e){this._methodName=e}}class T_{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Yl(Ql.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Yl(Ql.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return lu(this._lat,e._lat)||lu(this._long,e._long)}}class C_{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const k_=/^__.*__$/;class x_{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Zd(e,this.data,this.fieldMask,t,this.fieldTransforms):new Xd(e,this.data,t,this.fieldTransforms)}}class N_{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Zd(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function P_(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Kl()}}class A_{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new A_(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.Ou(e),r}Nu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return J_(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(0===e.length)throw this.Bu("Document fields must not be empty");if(P_(this.Cu)&&k_.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class R_{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Fg(e)}Qu(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new A_({Cu:e,methodName:t,qu:n,path:gu.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function D_(e){const t=e._freezeSettings(),n=Fg(e._databaseId);return new R_(e._databaseId,!!t.ignoreUndefinedProperties,n)}function O_(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=e.Qu(s.merge||s.mergeFields?2:0,t,n,i);H_("Data must be an object, but it was:",o,r);const a=W_(r,o);let l,u;if(s.merge)l=new Dc(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=G_(t,r,n);if(!o.contains(i))throw new Yl(Ql.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);X_(e,i)||e.push(i)}l=new Dc(e),u=o.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,u=o.fieldTransforms;return new x_(new mh(a),l,u)}class L_ extends S_{_toFieldTransform(e){if(2!==e.Cu)throw 1===e.Cu?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof L_}}function M_(e,t,n){return new A_({Cu:3,qu:t.settings.qu,methodName:e._methodName,xu:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class F_ extends S_{_toFieldTransform(e){return new jd(e.path,new Od)}isEqual(e){return e instanceof F_}}class U_ extends S_{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=M_(this,e,!0),n=this.Ku.map((e=>$_(e,t))),r=new Ld(n);return new jd(e.path,r)}isEqual(e){return e instanceof U_&&lt(this.Ku,e.Ku)}}class V_ extends S_{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=M_(this,e,!0),n=this.Ku.map((e=>$_(e,t))),r=new Fd(n);return new jd(e.path,r)}isEqual(e){return e instanceof V_&&lt(this.Ku,e.Ku)}}class q_ extends S_{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new Vd(e.serializer,Nd(e.serializer,this.$u));return new jd(e.path,t)}isEqual(e){return e instanceof q_&&this.$u===e.$u}}function z_(e,t,n,r){const i=e.Qu(1,t,n);H_("Data must be an object, but it was:",i,r);const s=[],o=mh.empty();Tc(r,((e,r)=>{const a=Y_(t,e,n);r=It(r);const l=i.Nu(a);if(r instanceof L_)s.push(a);else{const e=$_(r,l);null!=e&&(s.push(a),o.set(a,e))}}));const a=new Dc(s);return new N_(o,a,i.fieldTransforms)}function j_(e,t,n,r,i,s){const o=e.Qu(1,t,n),a=[G_(t,r,n)],l=[i];if(s.length%2!=0)throw new Yl(Ql.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(G_(t,s[d])),l.push(s[d+1]);const u=[],c=mh.empty();for(let d=a.length-1;d>=0;--d)if(!X_(u,a[d])){const e=a[d];let t=l[d];t=It(t);const n=o.Nu(e);if(t instanceof L_)u.push(e);else{const r=$_(t,n);null!=r&&(u.push(e),c.set(e,r))}}const h=new Dc(u);return new N_(c,h,o.fieldTransforms)}function B_(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return $_(n,e.Qu(r?4:3,t))}function $_(e,t){if(K_(e=It(e)))return H_("Unsupported field value:",t,e),W_(e,t);if(e instanceof S_)return function(e,t){if(!P_(t.Cu))throw t.Bu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Bu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&4!==t.Cu)throw t.Bu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=$_(i,t.Lu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=It(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Nd(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=hu.fromDate(e);return{timestampValue:Lf(t.serializer,n)}}if(e instanceof hu){const n=new hu(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Lf(t.serializer,n)}}if(e instanceof T_)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof I_)return{bytesValue:Mf(t.serializer,e._byteString)};if(e instanceof s_){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Bu(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Vf(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof C_)return function(e,t){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:e.toArray().map((e=>{if("number"!=typeof e)throw t.Bu("VectorValues must only contain numeric values.");return kd(t.serializer,e)}))}}}}}}(e,t);throw t.Bu(`Unsupported field value: ${Xv(e)}`)}(e,t)}function W_(e,t){const n={};return Cc(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Tc(e,((e,r)=>{const i=$_(r,t.Mu(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function K_(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof hu||e instanceof T_||e instanceof I_||e instanceof s_||e instanceof S_||e instanceof C_)}function H_(e,t,n){if(!K_(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Xv(n);throw"an object"===r?t.Bu(e+" a custom object"):t.Bu(e+" "+r)}}function G_(e,t,n){if((t=It(t))instanceof E_)return t._internalPath;if("string"==typeof t)return Y_(e,t);throw J_("Field path arguments must be of type string or ",e,!1,void 0,n)}const Q_=new RegExp("[~\\*/\\[\\]]");function Y_(e,t,n){if(t.search(Q_)>=0)throw J_(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new E_(...t.split("."))._internalPath}catch(r){throw J_(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function J_(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new Yl(Ql.INVALID_ARGUMENT,a+e+l)}function X_(e,t){return e.some((e=>e.isEqual(t)))}class Z_{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new s_(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new ew(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(tw("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class ew extends Z_{data(){return super.data()}}function tw(e,t){return"string"==typeof t?Y_(e,t):t instanceof E_?t._internalPath:t._delegate._internalPath}function nw(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Yl(Ql.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class rw{}class iw extends rw{}function sw(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t instanceof rw&&n.push(t),n=n.concat(i),function(e){const t=e.filter((e=>e instanceof aw)).length,n=e.filter((e=>e instanceof ow)).length;if(t>1||t>0&&n>0)throw new Yl(Ql.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)e=o._apply(e);return e}class ow extends iw{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new ow(e,t,n)}_apply(e){const t=this._parse(e);return mw(e._query,t),new i_(e.firestore,e.converter,id(e._query,t))}_parse(e){const t=D_(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new Yl(Ql.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){pw(o,s);const t=[];for(const n of o)t.push(fw(r,e,n));a={arrayValue:{values:t}}}else a=fw(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||pw(o,s),a=B_(n,t,o,"in"===s||"not-in"===s);return Sh.create(i,s,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class aw extends rw{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new aw(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:Th.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)mw(n,i),n=id(n,i)}(e._query,t),new i_(e.firestore,e.converter,id(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class lw extends iw{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new lw(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Yl(Ql.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Yl(Ql.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new bh(t,n)}(e._query,this._field,this._direction);return new i_(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Yh(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}class uw extends iw{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new uw(e,t,n)}_apply(e){return new i_(e.firestore,e.converter,sd(e._query,this._limit,this._limitType))}}class cw extends iw{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new cw(e,t,n)}_apply(e){const t=dw(e,this.type,this._docOrFields,this._inclusive);return new i_(e.firestore,e.converter,function(e,t){return new Yh(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}class hw extends iw{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new hw(e,t,n)}_apply(e){const t=dw(e,this.type,this._docOrFields,this._inclusive);return new i_(e.firestore,e.converter,function(e,t){return new Yh(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}function dw(e,t,n,r){if(n[0]=It(n[0]),n[0]instanceof Z_)return function(e,t,n,r,i){if(!r)throw new Yl(Ql.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const s=[];for(const o of td(e))if(o.field.isKeyField())s.push(th(t,r.key));else{const e=r.data.field(o.field);if(qc(e))throw new Yl(Ql.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=o.field.canonicalString();throw new Yl(Ql.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}s.push(e)}return new vh(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=D_(e.firestore);return function(e,t,n,r,i,s){const o=e.explicitOrderBy;if(i.length>o.length)throw new Yl(Ql.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let l=0;l<i.length;l++){const s=i[l];if(o[l].field.isKeyField()){if("string"!=typeof s)throw new Yl(Ql.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof s}`);if(!ed(e)&&-1!==s.indexOf("/"))throw new Yl(Ql.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${r}() must be a plain document ID, but '${s}' contains a slash.`);const n=e.path.child(pu.fromString(s));if(!yu.isDocumentKey(n))throw new Yl(Ql.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new yu(n);a.push(th(t,i))}else{const e=B_(n,r,s);a.push(e)}}return new vh(a,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}function fw(e,t,n){if("string"==typeof(n=It(n))){if(""===n)throw new Yl(Ql.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ed(t)&&-1!==n.indexOf("/"))throw new Yl(Ql.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(pu.fromString(n));if(!yu.isDocumentKey(r))throw new Yl(Ql.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return th(e,new yu(r))}if(n instanceof s_)return th(e,n._key);throw new Yl(Ql.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Xv(n)}.`)}function pw(e,t){if(!Array.isArray(e)||0===e.length)throw new Yl(Ql.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function mw(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Yl(Ql.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Yl(Ql.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class gw{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Hc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Uc(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Vc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Kl()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return Tc(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertVectorValue(e){var t,n,r;const i=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t.value.arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map((e=>Uc(e.doubleValue)));return new C_(i)}convertGeoPoint(e){return new T_(Uc(e.latitude),Uc(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=zc(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(jc(e));default:return null}}convertTimestamp(e){const t=Fc(e);return new hu(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=pu.fromString(e);Hl(up(n));const r=new $c(n.get(1),n.get(3)),i=new yu(n.popFirst(5));return r.isEqual(t)||Bl(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function yw(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class vw extends gw{constructor(e){super(),this.firestore=e}convertBytes(e){return new I_(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new s_(this.firestore,null,t)}}class _w{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ww extends Z_{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new bw(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(tw("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class bw extends ww{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Iw{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new _w(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new bw(this._firestore,this._userDataWriter,n.key,n,new _w(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Yl(Ql.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new bw(e._firestore,e._userDataWriter,n.doc.key,n.doc,new _w(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new bw(e._firestore,e._userDataWriter,t.doc.key,t.doc,new _w(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Ew(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Ew(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Kl()}}function Sw(e,t){return e instanceof ww&&t instanceof ww?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof Iw&&t instanceof Iw&&e._firestore===t._firestore&&c_(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}class Tw extends gw{constructor(e){super(),this.firestore=e}convertBytes(e){return new I_(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new s_(this.firestore,null,t)}}function Cw(e){e=Zv(e,s_);const t=Zv(e.firestore,p_),n=m_(t),r=new Tw(t);return function(e,t){const n=new Jl;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await function(e,t){const n=Gl(e);return n.persistence.runTransaction("read document","readonly",(e=>n.localDocuments.getDocument(e,t)))}(e,t);r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new Yl(Ql.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const r=by(e,`Failed to get document '${t} from cache`);n.reject(r)}}(await Uv(e),t,n))),n.promise}(n,e._key).then((n=>new ww(t,r,e._key,n,new _w(null!==n&&n.hasLocalMutations,!0),e.converter)))}function kw(e){e=Zv(e,i_);const t=Zv(e.firestore,p_),n=m_(t),r=new Tw(t);return function(e,t){const n=new Jl;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await dg(e,t,!0),i=new jy(t,r.Ts),s=i.ma(r.documents),o=i.applyChanges(s,!1);n.resolve(o.snapshot)}catch(e){const r=by(e,`Failed to execute query '${t} against cache`);n.reject(r)}}(await Uv(e),t,n))),n.promise}(n,e._query).then((n=>new Iw(t,r,e,n)))}function xw(e,t,n){e=Zv(e,s_);const r=Zv(e.firestore,p_),i=yw(e.converter,t,n);return Rw(r,[O_(D_(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,$d.none())])}function Nw(e,t,n){e=Zv(e,s_);const r=Zv(e.firestore,p_),i=D_(r);let s;for(var o=arguments.length,a=new Array(o>3?o-3:0),l=3;l<o;l++)a[l-3]=arguments[l];return s="string"==typeof(t=It(t))||t instanceof E_?j_(i,"updateDoc",e._key,t,n,a):z_(i,"updateDoc",e._key,t),Rw(r,[s.toMutation(e._key,$d.exists(!0))])}function Pw(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,s,o;e=It(e);let a={includeMetadataChanges:!1,source:"default"},l=0;"object"!=typeof n[l]||d_(n[l])||(a=n[l],l++);const u={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(d_(n[l])){const e=n[l];n[l]=null===(i=e.next)||void 0===i?void 0:i.bind(e),n[l+1]=null===(s=e.error)||void 0===s?void 0:s.bind(e),n[l+2]=null===(o=e.complete)||void 0===o?void 0:o.bind(e)}let c,h,d;if(e instanceof s_)h=Zv(e.firestore,p_),d=Xh(e._key.path),c={next:t=>{n[l]&&n[l](Dw(h,e,t))},error:n[l+1],complete:n[l+2]};else{const t=Zv(e,i_);h=Zv(t.firestore,p_),d=t._query;const r=new Tw(h);c={next:e=>{n[l]&&n[l](new Iw(h,r,t,e))},error:n[l+1],complete:n[l+2]},nw(e._query)}return function(e,t,n,r){const i=new xv(r),s=new Ly(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>xy(await jv(e),s))),()=>{i.Za(),e.asyncQueue.enqueueAndForget((async()=>Ny(await jv(e),s)))}}(m_(h),d,u,c)}function Aw(e,t){return function(e,t){const n=new xv(t);return e.asyncQueue.enqueueAndForget((async()=>function(e,t){Gl(e).Y_.add(t),t.next()}(await jv(e),n))),()=>{n.Za(),e.asyncQueue.enqueueAndForget((async()=>function(e,t){Gl(e).Y_.delete(t)}(await jv(e),n)))}}(m_(e=Zv(e,p_)),d_(t)?t:{next:t})}function Rw(e,t){return function(e,t){const n=new Jl;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=Iv(e);try{const e=await function(e,t){const n=Gl(e),r=hu.now(),i=t.reduce(((e,t)=>e.add(t.key)),Sd());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=md(),l=Sd();return n.cs.getEntries(e,i).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((i=>{s=i;const o=[];for(const e of t){const t=Yd(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new Zd(e.key,t,gh(t.value.mapValue),$d.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)})).next((t=>{o=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:vd(s)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Ba[e.currentUser.toKey()];r||(r=new kc(lu)),r=r.insert(t,n),e.Ba[e.currentUser.toKey()]=r}(r,e.batchId,n),await cv(r,e.changes),await ay(r.remoteStore)}catch(e){const t=by(e,"Failed to persist write");n.reject(t)}}(await qv(e),t,n))),n.promise}(m_(e),t)}function Dw(e,t,n){const r=n.docs.get(t._key),i=new Tw(e);return new ww(e,i,t._key,r,new _w(n.hasPendingWrites,n.fromCache),t.converter)}const Ow={maxAttempts:5};class Lw{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=D_(e)}set(e,t,n){this._verifyNotCommitted();const r=Mw(e,this._firestore),i=yw(r.converter,t,n),s=O_(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,$d.none())),this}update(e,t,n){this._verifyNotCommitted();const r=Mw(e,this._firestore);let i;for(var s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];return i="string"==typeof(t=It(t))||t instanceof E_?j_(this._dataReader,"WriteBatch.update",r._key,t,n,o):z_(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(i.toMutation(r._key,$d.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Mw(e,this._firestore);return this._mutations=this._mutations.concat(new rf(t._key,$d.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Yl(Ql.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Mw(e,t){if((e=It(e)).firestore!==t)throw new Yl(Ql.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class Fw extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=D_(e)}get(e){const t=Mw(e,this._firestore),n=new vw(this._firestore);return this._transaction.lookup([t._key]).then((e=>{if(!e||1!==e.length)return Kl();const r=e[0];if(r.isFoundDocument())return new Z_(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new Z_(this._firestore,n,t._key,null,t.converter);throw Kl()}))}set(e,t,n){const r=Mw(e,this._firestore),i=yw(r.converter,t,n),s=O_(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,s),this}update(e,t,n){const r=Mw(e,this._firestore);let i;for(var s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];return i="string"==typeof(t=It(t))||t instanceof E_?j_(this._dataReader,"Transaction.update",r._key,t,n,o):z_(this._dataReader,"Transaction.update",r._key,t),this._transaction.update(r._key,i),this}delete(e){const t=Mw(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Mw(e,this._firestore),n=new Tw(this._firestore);return super.get(e).then((e=>new ww(this._firestore,n,t._key,e._document,new _w(!1,!1),t.converter)))}}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){Vl=e}(Bn),On(new Et("firestore",((e,n)=>{let{instanceIdentifier:r,options:i}=n;const s=e.getProvider("app").getImmediate(),o=new p_(new tu(e.getProvider("auth-internal")),new su(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Yl(Ql.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $c(e.options.projectId,t)}(s,r),s);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),Qn(Fl,"4.7.3",e),Qn(Fl,"4.7.3","esm2017")}();function Uw(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new Yl("invalid-argument",`Invalid options passed to function ${e}(): You cannot specify both "merge" and "mergeFields".`);return t}function Vw(){if("undefined"===typeof Uint8Array)throw new Yl("unimplemented","Uint8Arrays are not available in this environment.")}function qw(){if("undefined"==typeof atob)throw new Yl("unimplemented","Blobs are unavailable in Firestore in this environment.")}class zw{constructor(e){this._delegate=e}static fromBase64String(e){return qw(),new zw(I_.fromBase64String(e))}static fromUint8Array(e){return Vw(),new zw(I_.fromUint8Array(e))}toBase64(){return qw(),this._delegate.toBase64()}toUint8Array(){return Vw(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function jw(e){return function(e,t){if("object"!==typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"===typeof n[r])return!0;return!1}(e,["next","error","complete"])}class Bw{enableIndexedDbPersistence(e,t){return function(e,t){$l("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings();return y_(e,Cv.provider,{build:e=>new Sv(e,n.cacheSizeBytes,null==t?void 0:t.forceOwnership)}),Promise.resolve()}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return async function(e){$l("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=e._freezeSettings();y_(e,Cv.provider,{build:e=>new Tv(e,t.cacheSizeBytes)})}(e._delegate)}clearIndexedDbPersistence(e){return function(e){if(e._initialized&&!e._terminated)throw new Yl(Ql.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new Jl;return e._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await async function(e){if(!Ru.D())return Promise.resolve();const t=e+"main";await Ru.delete(t)}(eg(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}})),t.promise}(e._delegate)}}class $w{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof $c||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();e.merge||t.host===e.host||$l("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r_(this._delegate,e,t,n)}enableNetwork(){return __(this._delegate)}disableNetwork(){return w_(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,Qv("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return v_(this._delegate)}onSnapshotsInSync(e){return Aw(this._delegate,e)}get app(){if(!this._appCompat)throw new Yl("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ib(this,a_(this._delegate,e))}catch(cx){throw Yw(cx,"collection()","Firestore.collection()")}}doc(e){try{return new Qw(this,l_(this._delegate,e))}catch(cx){throw Yw(cx,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new tb(this,function(e,t){if(e=Zv(e,n_),Gv("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new Yl(Ql.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new i_(e,null,function(e){return new Yh(pu.emptyPath(),e)}(t))}(this._delegate,e))}catch(cx){throw Yw(cx,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function(e,t,n){e=Zv(e,p_);const r=Object.assign(Object.assign({},Ow),n);return function(e){if(e.maxAttempts<1)throw new Yl(Ql.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){const r=new Jl;return e.asyncQueue.enqueueAndForget((async()=>{const i=await zv(e);new Av(e.asyncQueue,i,n,t,r).au()})),r.promise}(m_(e),(n=>t(new Fw(e,n))),r)}(this._delegate,(t=>e(new Kw(this,t))))}batch(){return m_(this._delegate),new Hw(new Lw(this._delegate,(e=>Rw(this._delegate,e))))}loadBundle(e){return function(e,t){const n=m_(e=Zv(e,p_)),r=new f_;return Wv(n,e._databaseId,t,r),r}(this._delegate,e)}namedQuery(e){return b_(this._delegate,e).then((e=>e?new tb(this,e):null))}}class Ww extends gw{constructor(e){super(),this.firestore=e}convertBytes(e){return new zw(new I_(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Qw.forKey(t,this.firestore,null)}}class Kw{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Ww(e)}get(e){const t=sb(e);return this._delegate.get(t).then((e=>new Zw(this._firestore,new ww(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,t.converter))))}set(e,t,n){const r=sb(e);return n?(Uw("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),s=3;s<r;s++)i[s-3]=arguments[s];const o=sb(e);return 2===arguments.length?this._delegate.update(o,t):this._delegate.update(o,t,n,...i),this}delete(e){const t=sb(e);return this._delegate.delete(t),this}}class Hw{constructor(e){this._delegate=e}set(e,t,n){const r=sb(e);return n?(Uw("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),s=3;s<r;s++)i[s-3]=arguments[s];const o=sb(e);return 2===arguments.length?this._delegate.update(o,t):this._delegate.update(o,t,n,...i),this}delete(e){const t=sb(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Gw{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){const n=new bw(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new eb(this._firestore,n),null!==t&&void 0!==t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const n=Gw.INSTANCES;let r=n.get(e);r||(r=new WeakMap,n.set(e,r));let i=r.get(t);return i||(i=new Gw(e,new Ww(e),t),r.set(t,i)),i}}Gw.INSTANCES=new WeakMap;class Qw{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Ww(e)}static forPath(e,t,n){if(e.length%2!==0)throw new Yl("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Qw(t,new s_(t._delegate,n,new yu(e)))}static forKey(e,t,n){return new Qw(t,new s_(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new ib(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ib(this.firestore,a_(this._delegate,e))}catch(cx){throw Yw(cx,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=It(e))instanceof s_&&u_(this._delegate,e)}set(e,t){t=Uw("DocumentReference.set",t);try{return t?xw(this._delegate,e,t):xw(this._delegate,e)}catch(cx){throw Yw(cx,"setDoc()","DocumentReference.set()")}}update(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];try{return 1===arguments.length?Nw(this._delegate,e):Nw(this._delegate,e,t,...r)}catch(cx){throw Yw(cx,"updateDoc()","DocumentReference.update()")}}delete(){return Rw(Zv((e=this._delegate).firestore,p_),[new rf(e._key,$d.none())]);var e}onSnapshot(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=Jw(t),i=Xw(t,(e=>new Zw(this.firestore,new ww(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter))));return Pw(this._delegate,r,i)}get(e){let t;return t="cache"===(null===e||void 0===e?void 0:e.source)?Cw(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?function(e){e=Zv(e,s_);const t=Zv(e.firestore,p_);return Bv(m_(t),e._key,{source:"server"}).then((n=>Dw(t,e,n)))}(this._delegate):function(e){e=Zv(e,s_);const t=Zv(e.firestore,p_);return Bv(m_(t),e._key).then((n=>Dw(t,e,n)))}(this._delegate),t.then((e=>new Zw(this.firestore,new ww(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter))))}withConverter(e){return new Qw(this.firestore,e?this._delegate.withConverter(Gw.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Yw(e,t,n){return e.message=e.message.replace(t,n),e}function Jw(e){for(const t of e)if("object"===typeof t&&!jw(t))return t;return{}}function Xw(e,t){var n,r;let i;return i=jw(e[0])?e[0]:jw(e[1])?e[1]:"function"===typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]},{next:e=>{i.next&&i.next(t(e))},error:null===(n=i.error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class Zw{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Qw(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Sw(this._delegate,e._delegate)}}class eb extends Zw{data(e){const t=this._delegate.data(e);return this._delegate._converter||void 0!==t||Kl(),t}}class tb{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Ww(e)}where(e,t,n){try{return new tb(this.firestore,sw(this._delegate,function(e,t,n){const r=t,i=tw("where",e);return ow._create(i,r,n)}(e,t,n)))}catch(cx){throw Yw(cx,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new tb(this.firestore,sw(this._delegate,function(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=tw("orderBy",e);return lw._create(n,t)}(e,t)))}catch(cx){throw Yw(cx,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new tb(this.firestore,sw(this._delegate,(e_("limit",t=e),uw._create("limit",t,"F"))))}catch(t){throw Yw(t,"limit()","Query.limit()")}var t}limitToLast(e){try{return new tb(this.firestore,sw(this._delegate,(e_("limitToLast",t=e),uw._create("limitToLast",t,"L"))))}catch(t){throw Yw(t,"limitToLast()","Query.limitToLast()")}var t}startAt(){try{return new tb(this.firestore,sw(this._delegate,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return cw._create("startAt",t,!0)}(...arguments)))}catch(cx){throw Yw(cx,"startAt()","Query.startAt()")}}startAfter(){try{return new tb(this.firestore,sw(this._delegate,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return cw._create("startAfter",t,!1)}(...arguments)))}catch(cx){throw Yw(cx,"startAfter()","Query.startAfter()")}}endBefore(){try{return new tb(this.firestore,sw(this._delegate,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return hw._create("endBefore",t,!1)}(...arguments)))}catch(cx){throw Yw(cx,"endBefore()","Query.endBefore()")}}endAt(){try{return new tb(this.firestore,sw(this._delegate,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return hw._create("endAt",t,!0)}(...arguments)))}catch(cx){throw Yw(cx,"endAt()","Query.endAt()")}}isEqual(e){return c_(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null===e||void 0===e?void 0:e.source)?kw(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?function(e){e=Zv(e,i_);const t=Zv(e.firestore,p_),n=m_(t),r=new Tw(t);return $v(n,e._query,{source:"server"}).then((n=>new Iw(t,r,e,n)))}(this._delegate):function(e){e=Zv(e,i_);const t=Zv(e.firestore,p_),n=m_(t),r=new Tw(t);return nw(e._query),$v(n,e._query).then((n=>new Iw(t,r,e,n)))}(this._delegate),t.then((e=>new rb(this.firestore,new Iw(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot))))}onSnapshot(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=Jw(t),i=Xw(t,(e=>new rb(this.firestore,new Iw(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot))));return Pw(this._delegate,r,i)}withConverter(e){return new tb(this.firestore,e?this._delegate.withConverter(Gw.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class nb{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new eb(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class rb{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new tb(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map((e=>new eb(this._firestore,e)))}docChanges(e){return this._delegate.docChanges(e).map((e=>new nb(this._firestore,e)))}forEach(e,t){this._delegate.forEach((n=>{e.call(t,new eb(this._firestore,n))}))}isEqual(e){return Sw(this._delegate,e._delegate)}}class ib extends tb{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Qw(this.firestore,e):null}doc(e){try{return new Qw(this.firestore,void 0===e?l_(this._delegate):l_(this._delegate,e))}catch(cx){throw Yw(cx,"doc()","CollectionReference.doc()")}}add(e){return function(e,t){const n=Zv(e.firestore,p_),r=l_(e),i=yw(e.converter,t);return Rw(n,[O_(D_(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,$d.exists(!1))]).then((()=>r))}(this._delegate,e).then((e=>new Qw(this.firestore,e)))}isEqual(e){return u_(this._delegate,e._delegate)}withConverter(e){return new ib(this.firestore,e?this._delegate.withConverter(Gw.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function sb(e){return Zv(e,s_)}class ob{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._delegate=new E_(...t)}static documentId(){return new ob(gu.keyField().canonicalString())}isEqual(e){return(e=It(e))instanceof E_&&this._delegate._internalPath.isEqual(e._internalPath)}}class ab{constructor(e){this._delegate=e}static serverTimestamp(){const e=new F_("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new ab(e)}static delete(){const e=new L_("deleteField");return e._methodName="FieldValue.delete",new ab(e)}static arrayUnion(){const e=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new U_("arrayUnion",t)}(...arguments);return e._methodName="FieldValue.arrayUnion",new ab(e)}static arrayRemove(){const e=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new V_("arrayRemove",t)}(...arguments);return e._methodName="FieldValue.arrayRemove",new ab(e)}static increment(e){const t=new q_("increment",e);return t._methodName="FieldValue.increment",new ab(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const lb={Firestore:$w,GeoPoint:T_,Timestamp:hu,Blob:zw,Transaction:Kw,WriteBatch:Hw,DocumentReference:Qw,DocumentSnapshot:Zw,Query:tb,QueryDocumentSnapshot:eb,QuerySnapshot:rb,CollectionReference:ib,FieldPath:ob,FieldValue:ab,setLogLevel:function(e){var t;t=e,ql.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};!function(e){!function(e,t){e.INTERNAL.registerComponent(new Et("firestore-compat",(e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(n,r)}),"PUBLIC").setServiceProps(Object.assign({},lb)))}(e,((e,t)=>new $w(e,t,new Bw))),e.registerVersion("@firebase/firestore-compat","0.3.38")}(dr);const ub="@firebase/database",cb="1.0.8";let hb="";function db(e){hb=e}class fb{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),nt(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:tt(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class pb{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return it(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const mb=function(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new fb(t)}}catch(cx){}return new pb},gb=mb("localStorage"),yb=mb("sessionStorage"),vb=new Dt("@firebase/database"),_b=function(){let e=1;return function(){return e++}}(),wb=function(e){const t=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i>=55296&&i<=56319){const t=i-55296;r++,xe(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(t<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new ft;n.update(t);const r=n.digest();return Ae.encodeByteArray(r)},bb=function(){let e="";for(let t=0;t<arguments.length;t++){const n=t<0||arguments.length<=t?void 0:arguments[t];Array.isArray(n)||n&&"object"===typeof n&&"number"===typeof n.length?e+=bb.apply(null,n):e+="object"===typeof n?nt(n):n,e+=" "}return e};let Ib=null,Eb=!0;const Sb=function(e,t){xe(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(vb.logLevel=xt.VERBOSE,Ib=vb.log.bind(vb),t&&yb.set("logging_enabled",!0)):"function"===typeof e?Ib=e:(Ib=null,yb.remove("logging_enabled"))},Tb=function(){if(!0===Eb&&(Eb=!1,null===Ib&&!0===yb.get("logging_enabled")&&Sb(!0)),Ib){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=bb.apply(null,t);Ib(r)}},Cb=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Tb(e,...n)}},kb=function(){const e="FIREBASE INTERNAL ERROR: "+bb(...arguments);vb.error(e)},xb=function(){const e=`FIREBASE FATAL ERROR: ${bb(...arguments)}`;throw vb.error(e),new Error(e)},Nb=function(){const e="FIREBASE WARNING: "+bb(...arguments);vb.warn(e)},Pb=function(e){return"number"===typeof e&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},Ab="[MIN_NAME]",Rb="[MAX_NAME]",Db=function(e,t){if(e===t)return 0;if(e===Ab||t===Rb)return-1;if(t===Ab||e===Rb)return 1;{const n=zb(e),r=zb(t);return null!==n?null!==r?n-r===0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},Ob=function(e,t){return e===t?0:e<t?-1:1},Lb=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+nt(t))},Mb=function(e){if("object"!==typeof e||null===e)return nt(e);const t=[];for(const r in e)t.push(r);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=nt(t[r]),n+=":",n+=Mb(e[t[r]]);return n+="}",n},Fb=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function Ub(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const Vb=function(e){xe(!Pb(e),"Invalid JSON number");const t=1023;let n,r,i,s,o;0===e?(r=0,i=0,n=1/e===-1/0?1:0):(n=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(s=Math.min(Math.floor(Math.log(e)/Math.LN2),t),r=s+t,i=Math.round(e*Math.pow(2,52-s)-Math.pow(2,52))):(r=0,i=Math.round(e/Math.pow(2,-1074))));const a=[];for(o=52;o;o-=1)a.push(i%2?1:0),i=Math.floor(i/2);for(o=11;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);a.push(n?1:0),a.reverse();const l=a.join("");let u="";for(o=0;o<64;o+=8){let e=parseInt(l.substr(o,8),2).toString(16);1===e.length&&(e="0"+e),u+=e}return u.toLowerCase()};const qb=new RegExp("^-?(0*)\\d{1,10}$"),zb=function(e){if(qb.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},jb=function(e){try{e()}catch(cx){setTimeout((()=>{const t=cx.stack||"";throw Nb("Exception was thrown by user callback.",t),cx}),Math.floor(0))}},Bb=function(e,t){const n=setTimeout(e,t);return"number"===typeof n&&"undefined"!==typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"===typeof n&&n.unref&&n.unref(),n};class $b{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null===t||void 0===t?void 0:t.getImmediate({optional:!0}),this.appCheck||null===t||void 0===t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){Nb(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class Wb{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(Tb("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Nb(e)}}class Kb{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Kb.OWNER="owner";const Hb="5",Gb=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Qb="ac",Yb="websocket",Jb="long_polling";class Xb{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=gb.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&gb.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function Zb(e,t,n){let r;if(xe("string"===typeof t,"typeof type must == string"),xe("object"===typeof n,"typeof params must == object"),t===Yb)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==Jb)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return Ub(n,((e,t)=>{i.push(e+"="+t)})),r+i.join("&")}class eI{constructor(){this.counters_={}}incrementCounter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;it(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Me(void 0,this.counters_)}}const tI={},nI={};function rI(e){const t=e.toString();return tI[t]||(tI[t]=new eI),tI[t]}class iI{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&jb((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const sI="start";class oI{constructor(e,t,n,r,i,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Cb(e),this.stats_=rI(t),this.urlFn=e=>(this.appCheckToken&&(e[Qb]=this.appCheckToken),Zb(t,Jb,e))}open(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new iI(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if(Qe()||"complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new aI((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[i,s,o,a,l]=t;if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===sI)n.id=s,n.password=o;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);s?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(s,(()=>{n.onClosed_()}))):n.onClosed_()}}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[i,s]=t;n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,s)}),(()=>{this.onClosed_()}),this.urlFn);const e={};e[sI]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=Hb,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[Qb]=this.appCheckToken),"undefined"!==typeof location&&location.hostname&&Gb.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){oI.forceAllow_=!0}static forceDisallow(){oI.forceDisallow_=!0}static isAvailable(){return!Qe()&&(!!oI.forceAllow_||!oI.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=nt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=De(t),r=Fb(n,1840);for(let i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(Qe())return;this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=nt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class aI{constructor(e,t,n,r){if(this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,Qe())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=_b(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=aI.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)){n='<script>document.domain="'+document.domain+'";<\/script>'}const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(cx){Tb("frame writing exception"),cx.stack&&Tb(cx.stack),Tb(cx)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Tb("No IE domain setting required")}catch(cx){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){Qe()?this.doNodeLongPoll(e,t):setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{Tb("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(cx){}}),Math.floor(1))}}let lI=null;"undefined"!==typeof MozWebSocket?lI=MozWebSocket:"undefined"!==typeof WebSocket&&(lI=WebSocket);class uI{constructor(e,t,n,r,i,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Cb(this.connId),this.stats_=rI(t),this.connURL=uI.connectionURL_(t,s,o,r,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r,i){const s={};return s.v=Hb,!Qe()&&"undefined"!==typeof location&&location.hostname&&Gb.test(location.hostname)&&(s.r="f"),t&&(s.s=t),n&&(s.ls=n),r&&(s[Qb]=r),i&&(s.p=i),Zb(e,Yb,s)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,gb.set("previous_websocket_failure",!0);try{let e;if(Qe()){const t=this.nodeAdmin?"AdminNode":"Node";e={headers:{"User-Agent":`Firebase/${Hb}/${hb}/${process.platform}/${t}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(e.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(e.headers["X-Firebase-AppCheck"]=this.appCheckToken);const n={NODE_ENV:"production",PUBLIC_URL:"/opensecurityroom",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0},r=0===this.connURL.indexOf("wss://")?n.HTTPS_PROXY||n.https_proxy:n.HTTP_PROXY||n.http_proxy;r&&(e.proxy={origin:r})}this.mySock=new lI(this.connURL,[],e)}catch(cx){this.log_("Error instantiating WebSocket.");const t=cx.message||cx.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){uI.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==lI&&!uI.forceDisallow_}static previouslyFailed(){return gb.isInMemoryStorage||!0===gb.get("previous_websocket_failure")}markConnectionHealthy(){gb.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=tt(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(xe(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=nt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Fb(t,16384);n.length>1&&this.sendString_(String(n.length));for(let r=0;r<n.length;r++)this.sendString_(n[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(cx){this.log_("Exception thrown from WebSocket.send():",cx.message||cx.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}uI.responsesRequiredToBeHealthy=2,uI.healthyTimeout=3e4;class cI{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[oI,uI]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=uI&&uI.isAvailable();let n=t&&!uI.previouslyFailed();if(e.webSocketOnly&&(t||Nb("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[uI];else{const e=this.transports_=[];for(const t of cI.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);cI.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}cI.globalTransportInitialized_=!1;class hI{constructor(e,t,n,r,i,s,o,a,l,u){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Cb("c:"+this.id+":"),this.transportManager_=new cI(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Bb((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Lb("t",e),n=Lb("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Lb("t",e),n=Lb("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Lb("t",e);if("d"in e){const n=e.d;if("h"===t){const e=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?kb("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):kb("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Hb!==n&&Nb("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),Bb((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Bb((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(gb.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class dI{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class fI{constructor(e){this.allowedEvents_=e,this.listeners_={},xe(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(let e=0;e<i.length;e++)i[e].callback.apply(i[e].context,n)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)}validateEventType_(e){xe(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class pI extends fI{constructor(){super(["online"]),this.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||Be()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new pI}getInitialEvent(e){return xe("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class mI{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function gI(){return new mI("")}function yI(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function vI(e){return e.pieces_.length-e.pieceNum_}function _I(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new mI(e.pieces_,t)}function wI(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function bI(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function II(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new mI(t,0)}function EI(e,t){const n=[];for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof mI)for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new mI(n,0)}function SI(e){return e.pieceNum_>=e.pieces_.length}function TI(e,t){const n=yI(e),r=yI(t);if(null===n)return t;if(n===r)return TI(_I(e),_I(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function CI(e,t){const n=bI(e,0),r=bI(t,0);for(let i=0;i<n.length&&i<r.length;i++){const e=Db(n[i],r[i]);if(0!==e)return e}return n.length===r.length?0:n.length<r.length?-1:1}function kI(e,t){if(vI(e)!==vI(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function xI(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(vI(e)>vI(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class NI{constructor(e,t){this.errorPrefix_=t,this.parts_=bI(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=bt(this.parts_[n]);PI(this)}}function PI(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+AI(e))}function AI(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class RI extends fI{constructor(){let e,t;super(["visible"]),"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(t="visibilitychange",e="hidden"):"undefined"!==typeof document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):"undefined"!==typeof document.msHidden?(t="msvisibilitychange",e="msHidden"):"undefined"!==typeof document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new RI}getInitialEvent(e){return xe("visible"===e,"Unknown event type: "+e),[this.visible_]}}const DI=1e3;class OI extends dI{constructor(e,t,n,r,i,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=OI.nextPersistentConnectionId_++,this.log_=Cb("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=DI,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!Qe())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");RI.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&pI.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(nt(i)),xe(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new qe,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,n,r){this.initConnection_();const i=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),xe(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),xe(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");const o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(s).set(i,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const s=i.d,o=i.s;OI.warnOnListenWarnings_(s,t);(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==o&&this.removeListen_(n,r),e.onComplete&&e.onComplete(o,s))}))}static warnOnListenWarnings_(e,t){if(e&&"object"===typeof e&&it(e,"w")){const n=st(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();Nb(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=rt(e).claims;return"object"===typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=rt(e).claims;return!!t&&"object"===typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"===typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),xe(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const s={p:t,d:n};void 0!==i&&(s.h=i),this.outstandingPuts_.push({action:e,request:s,onComplete:r}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+nt(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):kb("Unrecognized action received from server: "+nt(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){xe(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=DI,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=DI,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=DI),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+OI.nextConnectionId_++,i=this.lastSessionId;let s=!1,o=null;const a=function(){o?o.close():(s=!0,n())},l=function(e){xe(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)};this.realtime_={close:a,sendRequest:l};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,l]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);s?Tb("getToken() completed but was canceled"):(Tb("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=l&&l.token,o=new hI(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{Nb(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),i))}catch(kb){this.log_("Failed to get token: "+kb),s||(this.repoInfo_.nodeAdmin&&Nb(kb),a())}}}interrupt(e){Tb("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Tb("Resuming connection for reason: "+e),delete this.interruptReasons_[e],ot(this.interruptReasons_)&&(this.reconnectDelay_=DI,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>Mb(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new mI(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){Tb("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Tb("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";Qe()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+hb.replace(/\./g,"-")]=1,Be()?e["framework.cordova"]=1:He()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=pI.getInstance().currentlyOnline();return ot(this.interruptReasons_)&&e}}OI.nextPersistentConnectionId_=0,OI.nextConnectionId_=0;class LI{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new LI(e,t)}}class MI{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new LI(Ab,e),r=new LI(Ab,t);return 0!==this.compare(n,r)}minPost(){return LI.MIN}}let FI;class UI extends MI{static get __EMPTY_NODE(){return FI}static set __EMPTY_NODE(e){FI=e}compare(e,t){return Db(e.name,t.name)}isDefinedOn(e){throw Ne("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return LI.MIN}maxPost(){return new LI(Rb,FI)}makePost(e,t){return xe("string"===typeof e,"KeyIndex indexValue must always be a string."),new LI(e,FI)}toString(){return".key"}}const VI=new UI;class qI{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,r&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class zI{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:zI.RED,this.left=null!=r?r:jI.EMPTY_NODE,this.right=null!=i?i:jI.EMPTY_NODE}copy(e,t,n,r,i){return new zI(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return jI.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return jI.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,zI.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,zI.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}zI.RED=!0,zI.BLACK=!1;class jI{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jI.EMPTY_NODE;this.comparator_=e,this.root_=t}insert(e,t){return new jI(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,zI.BLACK,null,null))}remove(e){return new jI(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,zI.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new qI(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new qI(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new qI(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new qI(this.root_,null,this.comparator_,!0,e)}}function BI(e,t){return Db(e.name,t.name)}function $I(e,t){return Db(e,t)}let WI;jI.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new zI(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const KI=function(e){return"number"===typeof e?"number:"+Vb(e):"string:"+e},HI=function(e){if(e.isLeafNode()){const t=e.val();xe("string"===typeof t||"number"===typeof t||"object"===typeof t&&it(t,".sv"),"Priority must be a string or number.")}else xe(e===WI||e.isEmpty(),"priority of unexpected type.");xe(e===WI||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let GI,QI,YI;class JI{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:JI.__childrenNodeConstructor.EMPTY_NODE;this.value_=e,this.priorityNode_=t,this.lazyHash_=null,xe(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),HI(this.priorityNode_)}static set __childrenNodeConstructor(e){GI=e}static get __childrenNodeConstructor(){return GI}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new JI(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:JI.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return SI(e)?this:".priority"===yI(e)?this.priorityNode_:JI.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:JI.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=yI(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(xe(".priority"!==n||1===vI(e),".priority must be the last token in a path"),this.updateImmediateChild(n,JI.__childrenNodeConstructor.EMPTY_NODE.updateChild(_I(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+KI(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?Vb(this.value_):this.value_,this.lazyHash_=wb(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===JI.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof JI.__childrenNodeConstructor?-1:(xe(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=JI.VALUE_TYPE_ORDER.indexOf(t),i=JI.VALUE_TYPE_ORDER.indexOf(n);return xe(r>=0,"Unknown leaf type: "+t),xe(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}JI.VALUE_TYPE_ORDER=["object","boolean","number","string"];const XI=new class extends MI{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?Db(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return LI.MIN}maxPost(){return new LI(Rb,new JI("[PRIORITY-POST]",YI))}makePost(e,t){const n=QI(e);return new LI(t,new JI("[PRIORITY-POST]",n))}toString(){return".priority"}},ZI=Math.log(2);class eE{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/ZI,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const tE=function(e,t,n,r){e.sort(t);const i=function(t,r){const s=r-t;let o,a;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new zI(a,o.node,zI.BLACK,null,null);{const l=parseInt(s/2,10)+t,u=i(t,l),c=i(l+1,r);return o=e[l],a=n?n(o):o,new zI(a,o.node,zI.BLACK,u,c)}},s=function(t){let r=null,s=null,o=e.length;const a=function(t,r){const s=o-t,a=o;o-=t;const u=i(s+1,a),c=e[s],h=n?n(c):c;l(new zI(h,c.node,r,null,u))},l=function(e){r?(r.left=e,r=e):(s=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,zI.BLACK):(a(r,zI.BLACK),a(r,zI.RED))}return s}(new eE(e.length));return new jI(r||t,s)};let nE;const rE={};class iE{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return xe(rE&&XI,"ChildrenNode.ts has not been loaded"),nE=nE||new iE({".priority":rE},{".priority":XI}),nE}get(e){const t=st(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof jI?t:null}hasIndex(e){return it(this.indexSet_,e.toString())}addIndex(e,t){xe(e!==VI,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const i=t.getIterator(LI.Wrap);let s,o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),n.push(o),o=i.getNext();s=r?tE(n,e.getCompare()):rE;const a=e.toString(),l=Object.assign({},this.indexSet_);l[a]=e;const u=Object.assign({},this.indexes_);return u[a]=s,new iE(u,l)}addToIndexes(e,t){const n=at(this.indexes_,((n,r)=>{const i=st(this.indexSet_,r);if(xe(i,"Missing index implementation for "+r),n===rE){if(i.isDefinedOn(e.node)){const n=[],r=t.getIterator(LI.Wrap);let s=r.getNext();for(;s;)s.name!==e.name&&n.push(s),s=r.getNext();return n.push(e),tE(n,i.getCompare())}return rE}{const r=t.get(e.name);let i=n;return r&&(i=i.remove(new LI(e.name,r))),i.insert(e,e.node)}}));return new iE(n,this.indexSet_)}removeFromIndexes(e,t){const n=at(this.indexes_,(n=>{if(n===rE)return n;{const r=t.get(e.name);return r?n.remove(new LI(e.name,r)):n}}));return new iE(n,this.indexSet_)}}let sE;class oE{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&HI(this.priorityNode_),this.children_.isEmpty()&&xe(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return sE||(sE=new oE(new jI($I),null,iE.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||sE}updatePriority(e){return this.children_.isEmpty()?this:new oE(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?sE:t}}getChild(e){const t=yI(e);return null===t?this:this.getImmediateChild(t).getChild(_I(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(xe(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new LI(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_));const s=r.isEmpty()?sE:this.priorityNode_;return new oE(r,s,i)}}updateChild(e,t){const n=yI(e);if(null===n)return t;{xe(".priority"!==yI(e)||1===vI(e),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(_I(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,i=!0;if(this.forEachChild(XI,((s,o)=>{t[s]=o.val(e),n++,i&&oE.INTEGER_REGEXP_.test(s)?r=Math.max(r,Number(s)):i=!1})),!e&&i&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+KI(this.getPriority().val())+":"),this.forEachChild(XI,((t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":wb(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new LI(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new LI(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new LI(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,LI.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,LI.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===aE?-1:0}withIndex(e){if(e===VI||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new oE(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===VI||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(XI),n=t.getIterator(XI);let r=e.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(e){return e===VI?null:this.indexMap_.get(e.toString())}}oE.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const aE=new class extends oE{constructor(){super(new jI($I),oE.EMPTY_NODE,iE.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return oE.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(LI,{MIN:{value:new LI(Ab,oE.EMPTY_NODE)},MAX:{value:new LI(Rb,aE)}}),UI.__EMPTY_NODE=oE.EMPTY_NODE,JI.__childrenNodeConstructor=oE,WI=aE,function(e){YI=e}(aE);function lE(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return oE.EMPTY_NODE;if("object"===typeof e&&".priority"in e&&(t=e[".priority"]),xe(null===t||"string"===typeof t||"number"===typeof t||"object"===typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!==typeof e||".sv"in e){return new JI(e,lE(t))}if(e instanceof Array){let n=oE.EMPTY_NODE;return Ub(e,((t,r)=>{if(it(e,t)&&"."!==t.substring(0,1)){const e=lE(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(lE(t))}{const n=[];let r=!1;if(Ub(e,((e,t)=>{if("."!==e.substring(0,1)){const i=lE(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new LI(e,i)))}})),0===n.length)return oE.EMPTY_NODE;const i=tE(n,BI,(e=>e.name),$I);if(r){const e=tE(n,XI.getCompare());return new oE(i,lE(t),new iE({".priority":e},{".priority":XI}))}return new oE(i,lE(t),iE.Default)}}!function(e){QI=e}(lE);class uE extends MI{constructor(e){super(),this.indexPath_=e,xe(!SI(e)&&".priority"!==yI(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?Db(e.name,t.name):i}makePost(e,t){const n=lE(e),r=oE.EMPTY_NODE.updateChild(this.indexPath_,n);return new LI(t,r)}maxPost(){const e=oE.EMPTY_NODE.updateChild(this.indexPath_,aE);return new LI(Rb,e)}toString(){return bI(this.indexPath_,0).join("/")}}const cE=new class extends MI{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?Db(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return LI.MIN}maxPost(){return LI.MAX}makePost(e,t){const n=lE(e);return new LI(t,n)}toString(){return".value"}};function hE(e){return{type:"value",snapshotNode:e}}function dE(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function fE(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function pE(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class mE{constructor(e){this.index_=e}updateChild(e,t,n,r,i,s){xe(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=e.getImmediateChild(t);return o.getChild(r).equals(n.getChild(r))&&o.isEmpty()===n.isEmpty()?e:(null!=s&&(n.isEmpty()?e.hasChild(t)?s.trackChildChange(fE(t,o)):xe(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?s.trackChildChange(dE(t,n)):s.trackChildChange(pE(t,n,o))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(XI,((e,r)=>{t.hasChild(e)||n.trackChildChange(fE(e,r))})),t.isLeafNode()||t.forEachChild(XI,((t,r)=>{if(e.hasChild(t)){const i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(pE(t,r,i))}else n.trackChildChange(dE(t,r))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?oE.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class gE{constructor(e){this.indexedFilter_=new mE(e.getIndex()),this.index_=e.getIndex(),this.startPost_=gE.getStartPost_(e),this.endPost_=gE.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}updateChild(e,t,n,r,i,s){return this.matches(new LI(t,n))||(n=oE.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,s)}updateFullNode(e,t,n){t.isLeafNode()&&(t=oE.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(oE.EMPTY_NODE);const i=this;return t.forEachChild(XI,((e,t)=>{i.matches(new LI(e,t))||(r=r.updateImmediateChild(e,oE.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class yE{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{const t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new gE(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,n,r,i,s){return this.rangedFilter_.matches(new LI(t,n))||(n=oE.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,s):this.fullLimitUpdateChild_(e,t,n,i,s)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=oE.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=oE.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();if(this.withinDirectionalStart(t)){if(!this.withinDirectionalEnd(t))break;r=r.updateImmediateChild(t.name,t.node),n++}}}else{let e;r=t.withIndex(this.index_),r=r.updatePriority(oE.EMPTY_NODE),e=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);let n=0;for(;e.hasNext();){const t=e.getNext();n<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?n++:r=r.updateImmediateChild(t.name,oE.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,r,i){let s;if(this.reverse_){const e=this.index_.getCompare();s=(t,n)=>e(n,t)}else s=this.index_.getCompare();const o=e;xe(o.numChildren()===this.limit_,"");const a=new LI(t,n),l=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),u=this.rangedFilter_.matches(a);if(o.hasChild(t)){const e=o.getImmediateChild(t);let c=r.getChildAfterChild(this.index_,l,this.reverse_);for(;null!=c&&(c.name===t||o.hasChild(c.name));)c=r.getChildAfterChild(this.index_,c,this.reverse_);const h=null==c?1:s(c,a);if(u&&!n.isEmpty()&&h>=0)return null!=i&&i.trackChildChange(pE(t,n,e)),o.updateImmediateChild(t,n);{null!=i&&i.trackChildChange(fE(t,e));const n=o.updateImmediateChild(t,oE.EMPTY_NODE);return null!=c&&this.rangedFilter_.matches(c)?(null!=i&&i.trackChildChange(dE(c.name,c.node)),n.updateImmediateChild(c.name,c.node)):n}}return n.isEmpty()?e:u&&s(l,a)>=0?(null!=i&&(i.trackChildChange(fE(l.name,l.node)),i.trackChildChange(dE(t,n))),o.updateImmediateChild(t,n).updateImmediateChild(l.name,oE.EMPTY_NODE)):e}}class vE{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=XI}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return xe(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return xe(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ab}hasEnd(){return this.endSet_}getIndexEndValue(){return xe(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return xe(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Rb}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return xe(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===XI}copy(){const e=new vE;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function _E(e,t,n){const r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function wE(e,t,n){const r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function bE(e,t){const n=e.copy();return n.index_=t,n}function IE(e){const t={};if(e.isDefault())return t;let n;if(e.index_===XI?n="$priority":e.index_===cE?n="$value":e.index_===VI?n="$key":(xe(e.index_ instanceof uE,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=nt(n),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=nt(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+nt(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=nt(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+nt(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function EE(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==XI&&(t.i=e.index_.toString()),t}class SE extends dI{constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=Cb("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(xe(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const s=SE.getListenId_(e,n),o={};this.listens_[s]=o;const a=IE(e._queryParams);this.restRequest_(i+".json",a,((e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(i,a,!1,n),st(this.listens_,s)===o){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}}))}unlisten(e,t){const n=SE.getListenId_(e,t);delete this.listens_[n]}get(e){const t=IE(e._queryParams),n=e._path.toString(),r=new qe;return this.restRequest_(n+".json",t,((e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))})),r.promise}refreshAuthToken(e){}restRequest_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((r=>{let[i,s]=r;i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ct(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(n&&4===a.readyState){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let e=null;if(a.status>=200&&a.status<300){try{e=tt(a.responseText)}catch(cx){Nb("Failed to parse JSON response for "+o+": "+a.responseText)}n(null,e)}else 401!==a.status&&404!==a.status&&Nb("Got unsuccessful REST response for "+o+" Status: "+a.status),n(a.status);n=null}},a.open("GET",o,!0),a.send()}))}}class TE{constructor(){this.rootNode_=oE.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function CE(){return{value:null,children:new Map}}function kE(e,t,n){if(SI(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=yI(t);e.children.has(r)||e.children.set(r,CE());kE(e.children.get(r),t=_I(t),n)}}function xE(e,t){if(SI(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;{const n=e.value;return e.value=null,n.forEachChild(XI,((t,n)=>{kE(e,new mI(t),n)})),xE(e,t)}}if(e.children.size>0){const n=yI(t);if(t=_I(t),e.children.has(n)){xE(e.children.get(n),t)&&e.children.delete(n)}return 0===e.children.size}return!0}function NE(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}(e,((e,r)=>{NE(r,new mI(t.toString()+"/"+e),n)}))}class PE{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Ub(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}class AE{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new PE(e);const n=1e4+2e4*Math.random();Bb(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;Ub(e,((e,r)=>{r>0&&it(this.statsToReport_,e)&&(t[e]=r,n=!0)})),n&&this.server_.reportStats(t),Bb(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var RE;function DE(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(RE||(RE={}));class OE{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=RE.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(SI(this.path)){if(null!=this.affectedTree.value)return xe(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new mI(e));return new OE(gI(),t,this.revert)}}return xe(yI(this.path)===e,"operationForChild called for unrelated child."),new OE(_I(this.path),this.affectedTree,this.revert)}}class LE{constructor(e,t){this.source=e,this.path=t,this.type=RE.LISTEN_COMPLETE}operationForChild(e){return SI(this.path)?new LE(this.source,gI()):new LE(this.source,_I(this.path))}}class ME{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=RE.OVERWRITE}operationForChild(e){return SI(this.path)?new ME(this.source,gI(),this.snap.getImmediateChild(e)):new ME(this.source,_I(this.path),this.snap)}}class FE{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=RE.MERGE}operationForChild(e){if(SI(this.path)){const t=this.children.subtree(new mI(e));return t.isEmpty()?null:t.value?new ME(this.source,gI(),t.value):new FE(this.source,gI(),t)}return xe(yI(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new FE(this.source,_I(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class UE{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(SI(e))return this.isFullyInitialized()&&!this.filtered_;const t=yI(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class VE{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function qE(e,t,n,r,i,s){const o=r.filter((e=>e.type===n));o.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw Ne("Should only compare child_ events.");const r=new LI(t.childName,t.snapshotNode),i=new LI(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n))),o.forEach((n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,s);i.forEach((i=>{i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function zE(e,t){return{eventCache:e,serverCache:t}}function jE(e,t,n,r){return zE(new UE(t,n,r),e.serverCache)}function BE(e,t,n,r){return zE(e.eventCache,new UE(t,n,r))}function $E(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function WE(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let KE;class HE{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(KE||(KE=new jI(Ob)),KE);this.value=e,this.children=t}static fromObject(e){let t=new HE(null);return Ub(e,((e,n)=>{t=t.set(new mI(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:gI(),value:this.value};if(SI(e))return null;{const n=yI(e),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(_I(e),t);if(null!=i){return{path:EI(new mI(n),i.path),value:i.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(SI(e))return this;{const t=yI(e),n=this.children.get(t);return null!==n?n.subtree(_I(e)):new HE(null)}}set(e,t){if(SI(e))return new HE(t,this.children);{const n=yI(e),r=(this.children.get(n)||new HE(null)).set(_I(e),t),i=this.children.insert(n,r);return new HE(this.value,i)}}remove(e){if(SI(e))return this.children.isEmpty()?new HE(null):new HE(null,this.children);{const t=yI(e),n=this.children.get(t);if(n){const r=n.remove(_I(e));let i;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?new HE(null):new HE(this.value,i)}return this}}get(e){if(SI(e))return this.value;{const t=yI(e),n=this.children.get(t);return n?n.get(_I(e)):null}}setTree(e,t){if(SI(e))return t;{const n=yI(e),r=(this.children.get(n)||new HE(null)).setTree(_I(e),t);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new HE(this.value,i)}}fold(e){return this.fold_(gI(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((r,i)=>{n[r]=i.fold_(EI(e,r),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,gI(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(SI(e))return null;{const r=yI(e),i=this.children.get(r);return i?i.findOnPath_(_I(e),EI(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,gI(),t)}foreachOnPath_(e,t,n){if(SI(e))return this;{this.value&&n(t,this.value);const r=yI(e),i=this.children.get(r);return i?i.foreachOnPath_(_I(e),EI(t,r),n):new HE(null)}}foreach(e){this.foreach_(gI(),e)}foreach_(e,t){this.children.inorderTraversal(((n,r)=>{r.foreach_(EI(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}class GE{constructor(e){this.writeTree_=e}static empty(){return new GE(new HE(null))}}function QE(e,t,n){if(SI(t))return new GE(new HE(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let s=r.value;const o=TI(i,t);return s=s.updateChild(o,n),new GE(e.writeTree_.set(i,s))}{const r=new HE(n),i=e.writeTree_.setTree(t,r);return new GE(i)}}}function YE(e,t,n){let r=e;return Ub(n,((e,n)=>{r=QE(r,EI(t,e),n)})),r}function JE(e,t){if(SI(t))return GE.empty();{const n=e.writeTree_.setTree(t,new HE(null));return new GE(n)}}function XE(e,t){return null!=ZE(e,t)}function ZE(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(TI(n.path,t)):null}function eS(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(XI,((e,n)=>{t.push(new LI(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new LI(e,n.value))})),t}function tS(e,t){if(SI(t))return e;{const n=ZE(e,t);return new GE(null!=n?new HE(n):e.writeTree_.subtree(t))}}function nS(e){return e.writeTree_.isEmpty()}function rS(e,t){return iS(gI(),e.writeTree_,t)}function iS(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal(((t,i)=>{".priority"===t?(xe(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=iS(EI(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(EI(e,".priority"),r)),n}}function sS(e,t){return vS(t,e)}function oS(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));xe(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let i=r.visible,s=!1,o=e.allWrites.length-1;for(;i&&o>=0;){const t=e.allWrites[o];t.visible&&(o>=n&&aS(t,r.path)?i=!1:xI(r.path,t.path)&&(s=!0)),o--}if(i){if(s)return function(e){e.visibleWrites=uS(e.allWrites,lS,gI()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;if(r.snap)e.visibleWrites=JE(e.visibleWrites,r.path);else{Ub(r.children,(t=>{e.visibleWrites=JE(e.visibleWrites,EI(r.path,t))}))}return!0}return!1}function aS(e,t){if(e.snap)return xI(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&xI(EI(e.path,n),t))return!0;return!1}function lS(e){return e.visible}function uS(e,t,n){let r=GE.empty();for(let i=0;i<e.length;++i){const s=e[i];if(t(s)){const e=s.path;let t;if(s.snap)xI(n,e)?(t=TI(n,e),r=QE(r,t,s.snap)):xI(e,n)&&(t=TI(e,n),r=QE(r,gI(),s.snap.getChild(t)));else{if(!s.children)throw Ne("WriteRecord should have .snap or .children");if(xI(n,e))t=TI(n,e),r=YE(r,t,s.children);else if(xI(e,n))if(t=TI(e,n),SI(t))r=YE(r,gI(),s.children);else{const e=st(s.children,yI(t));if(e){const n=e.getChild(_I(t));r=QE(r,gI(),n)}}}}}return r}function cS(e,t,n,r,i){if(r||i){const s=tS(e.visibleWrites,t);if(!i&&nS(s))return n;if(i||null!=n||XE(s,gI())){const s=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(xI(e.path,t)||xI(t,e.path))};return rS(uS(e.allWrites,s,t),n||oE.EMPTY_NODE)}return null}{const r=ZE(e.visibleWrites,t);if(null!=r)return r;{const r=tS(e.visibleWrites,t);if(nS(r))return n;if(null!=n||XE(r,gI())){return rS(r,n||oE.EMPTY_NODE)}return null}}}function hS(e,t,n,r){return cS(e.writeTree,e.treePath,t,n,r)}function dS(e,t){return function(e,t,n){let r=oE.EMPTY_NODE;const i=ZE(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(XI,((e,t)=>{r=r.updateImmediateChild(e,t)})),r;if(n){const i=tS(e.visibleWrites,t);return n.forEachChild(XI,((e,t)=>{const n=rS(tS(i,new mI(e)),t);r=r.updateImmediateChild(e,n)})),eS(i).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}return eS(tS(e.visibleWrites,t)).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function fS(e,t,n,r){return function(e,t,n,r,i){xe(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=EI(t,n);if(XE(e.visibleWrites,s))return null;{const t=tS(e.visibleWrites,s);return nS(t)?i.getChild(n):rS(t,i.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function pS(e,t){return function(e,t){return ZE(e.visibleWrites,t)}(e.writeTree,EI(e.treePath,t))}function mS(e,t,n,r,i,s){return function(e,t,n,r,i,s,o){let a;const l=tS(e.visibleWrites,t),u=ZE(l,gI());if(null!=u)a=u;else{if(null==n)return[];a=rS(l,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let l=n.getNext();for(;l&&e.length<i;)0!==t(l,r)&&e.push(l),l=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,i,s)}function gS(e,t,n){return function(e,t,n,r){const i=EI(t,n),s=ZE(e.visibleWrites,i);if(null!=s)return s;if(r.isCompleteForChild(n))return rS(tS(e.visibleWrites,i),r.getNode().getImmediateChild(n));return null}(e.writeTree,e.treePath,t,n)}function yS(e,t){return vS(EI(e.treePath,t),e.writeTree)}function vS(e,t){return{treePath:e,writeTree:t}}class _S{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;xe("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),xe(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,pE(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,fE(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,dE(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw Ne("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,pE(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}const wS=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class bS{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new UE(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return gS(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:WE(this.viewCache_),i=mS(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}function IS(e,t,n,r,i){const s=new _S;let o,a;if(n.type===RE.OVERWRITE){const l=n;l.source.fromUser?o=TS(e,t,l.path,l.snap,r,i,s):(xe(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.serverCache.isFiltered()&&!SI(l.path),o=SS(e,t,l.path,l.snap,r,i,a,s))}else if(n.type===RE.MERGE){const l=n;l.source.fromUser?o=function(e,t,n,r,i,s,o){let a=t;return r.foreach(((r,l)=>{const u=EI(n,r);CS(t,yI(u))&&(a=TS(e,a,u,l,i,s,o))})),r.foreach(((r,l)=>{const u=EI(n,r);CS(t,yI(u))||(a=TS(e,a,u,l,i,s,o))})),a}(e,t,l.path,l.children,r,i,s):(xe(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.serverCache.isFiltered(),o=xS(e,t,l.path,l.children,r,i,a,s))}else if(n.type===RE.ACK_USER_WRITE){const a=n;o=a.revert?function(e,t,n,r,i,s){let o;if(null!=pS(r,n))return t;{const a=new bS(r,t,i),l=t.eventCache.getNode();let u;if(SI(n)||".priority"===yI(n)){let n;if(t.serverCache.isFullyInitialized())n=hS(r,WE(t));else{const e=t.serverCache.getNode();xe(e instanceof oE,"serverChildren would be complete if leaf node"),n=dS(r,e)}u=e.filter.updateFullNode(l,n,s)}else{const i=yI(n);let c=gS(r,i,t.serverCache);null==c&&t.serverCache.isCompleteForChild(i)&&(c=l.getImmediateChild(i)),u=null!=c?e.filter.updateChild(l,i,c,_I(n),a,s):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(l,i,oE.EMPTY_NODE,_I(n),a,s):l,u.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=hS(r,WE(t)),o.isLeafNode()&&(u=e.filter.updateFullNode(u,o,s)))}return o=t.serverCache.isFullyInitialized()||null!=pS(r,gI()),jE(t,u,o,e.filter.filtersNodes())}}(e,t,a.path,r,i,s):function(e,t,n,r,i,s,o){if(null!=pS(i,n))return t;const a=t.serverCache.isFiltered(),l=t.serverCache;if(null!=r.value){if(SI(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return SS(e,t,n,l.getNode().getChild(n),i,s,a,o);if(SI(n)){let r=new HE(null);return l.getNode().forEachChild(VI,((e,t)=>{r=r.set(new mI(e),t)})),xS(e,t,n,r,i,s,a,o)}return t}{let u=new HE(null);return r.foreach(((e,t)=>{const r=EI(n,e);l.isCompleteForPath(r)&&(u=u.set(e,l.getNode().getChild(r)))})),xS(e,t,n,u,i,s,a,o)}}(e,t,a.path,a.affectedTree,r,i,s)}else{if(n.type!==RE.LISTEN_COMPLETE)throw Ne("Unknown operation type: "+n.type);o=function(e,t,n,r,i){const s=t.serverCache,o=BE(t,s.getNode(),s.isFullyInitialized()||SI(n),s.isFiltered());return ES(e,o,n,r,wS,i)}(e,t,n.path,r,s)}const l=s.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=$E(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(hE($E(t)))}}(t,o,l),{viewCache:o,changes:l}}function ES(e,t,n,r,i,s){const o=t.eventCache;if(null!=pS(r,n))return t;{let a,l;if(SI(n))if(xe(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=WE(t),i=dS(r,n instanceof oE?n:oE.EMPTY_NODE);a=e.filter.updateFullNode(t.eventCache.getNode(),i,s)}else{const n=hS(r,WE(t));a=e.filter.updateFullNode(t.eventCache.getNode(),n,s)}else{const u=yI(n);if(".priority"===u){xe(1===vI(n),"Can't have a priority with additional path components");const i=o.getNode();l=t.serverCache.getNode();const s=fS(r,n,i,l);a=null!=s?e.filter.updatePriority(i,s):o.getNode()}else{const c=_I(n);let h;if(o.isCompleteForChild(u)){l=t.serverCache.getNode();const e=fS(r,n,o.getNode(),l);h=null!=e?o.getNode().getImmediateChild(u).updateChild(c,e):o.getNode().getImmediateChild(u)}else h=gS(r,u,t.serverCache);a=null!=h?e.filter.updateChild(o.getNode(),u,h,c,i,s):o.getNode()}}return jE(t,a,o.isFullyInitialized()||SI(n),e.filter.filtersNodes())}}function SS(e,t,n,r,i,s,o,a){const l=t.serverCache;let u;const c=o?e.filter:e.filter.getIndexedFilter();if(SI(n))u=c.updateFullNode(l.getNode(),r,null);else if(c.filtersNodes()&&!l.isFiltered()){const e=l.getNode().updateChild(n,r);u=c.updateFullNode(l.getNode(),e,null)}else{const e=yI(n);if(!l.isCompleteForPath(n)&&vI(n)>1)return t;const i=_I(n),s=l.getNode().getImmediateChild(e).updateChild(i,r);u=".priority"===e?c.updatePriority(l.getNode(),s):c.updateChild(l.getNode(),e,s,i,wS,null)}const h=BE(t,u,l.isFullyInitialized()||SI(n),c.filtersNodes());return ES(e,h,n,i,new bS(i,h,s),a)}function TS(e,t,n,r,i,s,o){const a=t.eventCache;let l,u;const c=new bS(i,t,s);if(SI(n))u=e.filter.updateFullNode(t.eventCache.getNode(),r,o),l=jE(t,u,!0,e.filter.filtersNodes());else{const i=yI(n);if(".priority"===i)u=e.filter.updatePriority(t.eventCache.getNode(),r),l=jE(t,u,a.isFullyInitialized(),a.isFiltered());else{const s=_I(n),u=a.getNode().getImmediateChild(i);let h;if(SI(s))h=r;else{const e=c.getCompleteChild(i);h=null!=e?".priority"===wI(s)&&e.getChild(II(s)).isEmpty()?e:e.updateChild(s,r):oE.EMPTY_NODE}if(u.equals(h))l=t;else{l=jE(t,e.filter.updateChild(a.getNode(),i,h,s,c,o),a.isFullyInitialized(),e.filter.filtersNodes())}}}return l}function CS(e,t){return e.eventCache.isCompleteForChild(t)}function kS(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function xS(e,t,n,r,i,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l,u=t;l=SI(n)?r:new HE(null).setTree(n,r);const c=t.serverCache.getNode();return l.children.inorderTraversal(((n,r)=>{if(c.hasChild(n)){const l=kS(0,t.serverCache.getNode().getImmediateChild(n),r);u=SS(e,u,new mI(n),l,i,s,o,a)}})),l.children.inorderTraversal(((n,r)=>{const l=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!c.hasChild(n)&&!l){const l=kS(0,t.serverCache.getNode().getImmediateChild(n),r);u=SS(e,u,new mI(n),l,i,s,o,a)}})),u}class NS{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new mE(n.getIndex()),i=(s=n).loadsAllData()?new mE(s.getIndex()):s.hasLimit()?new yE(s):new gE(s);var s;this.processor_=function(e){return{filter:e}}(i);const o=t.serverCache,a=t.eventCache,l=r.updateFullNode(oE.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(oE.EMPTY_NODE,a.getNode(),null),c=new UE(l,o.isFullyInitialized(),r.filtersNodes()),h=new UE(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=zE(h,c),this.eventGenerator_=new VE(this.query_)}get query(){return this.query_}}function PS(e,t){const n=WE(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!SI(t)&&!n.getImmediateChild(yI(t)).isEmpty())?n.getChild(t):null}function AS(e){return 0===e.eventRegistrations_.length}function RS(e,t,n){const r=[];if(n){xe(null==t,"A cancel should cancel all event registrations.");const i=e.query._path;e.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){let n=[];for(let r=0;r<e.eventRegistrations_.length;++r){const i=e.eventRegistrations_[r];if(i.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(r+1));break}}else n.push(i)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return r}function DS(e,t,n,r){t.type===RE.MERGE&&null!==t.source.queryId&&(xe(WE(e.viewCache_),"We should always have a full cache before handling merges"),xe($E(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,s=IS(e.processor_,i,t,n,r);var o,a;return o=e.processor_,a=s.viewCache,xe(a.eventCache.getNode().isIndexed(o.filter.getIndex()),"Event snap not indexed"),xe(a.serverCache.getNode().isIndexed(o.filter.getIndex()),"Server snap not indexed"),xe(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,OS(e,s.changes,s.viewCache.eventCache.getNode(),null)}function OS(e,t,n,r){const i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const i=[],s=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),qE(e,i,"child_removed",t,r,n),qE(e,i,"child_added",t,r,n),qE(e,i,"child_moved",s,r,n),qE(e,i,"child_changed",t,r,n),qE(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}let LS,MS;class FS{constructor(){this.views=new Map}}function US(e,t,n,r){const i=t.source.queryId;if(null!==i){const s=e.views.get(i);return xe(null!=s,"SyncTree gave us an op for an invalid query."),DS(s,t,n,r)}{let i=[];for(const s of e.views.values())i=i.concat(DS(s,t,n,r));return i}}function VS(e,t,n,r,i){const s=t._queryIdentifier,o=e.views.get(s);if(!o){let e=hS(n,i?r:null),s=!1;e?s=!0:r instanceof oE?(e=dS(n,r),s=!1):(e=oE.EMPTY_NODE,s=!1);const o=zE(new UE(e,s,!1),new UE(r,i,!1));return new NS(t,o)}return o}function qS(e,t,n,r,i,s){const o=VS(e,t,r,i,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){const n=e.viewCache_.eventCache,r=[];n.getNode().isLeafNode()||n.getNode().forEachChild(XI,((e,t)=>{r.push(dE(e,t))}));return n.isFullyInitialized()&&r.push(hE(n.getNode())),OS(e,r,n.getNode(),t)}(o,n)}function zS(e,t,n,r){const i=t._queryIdentifier,s=[];let o=[];const a=KS(e);if("default"===i)for(const[l,u]of e.views.entries())o=o.concat(RS(u,n,r)),AS(u)&&(e.views.delete(l),u.query._queryParams.loadsAllData()||s.push(u.query));else{const t=e.views.get(i);t&&(o=o.concat(RS(t,n,r)),AS(t)&&(e.views.delete(i),t.query._queryParams.loadsAllData()||s.push(t.query)))}return a&&!KS(e)&&s.push(new(xe(LS,"Reference.ts has not been loaded"),LS)(t._repo,t._path)),{removed:s,events:o}}function jS(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function BS(e,t){let n=null;for(const r of e.views.values())n=n||PS(r,t);return n}function $S(e,t){if(t._queryParams.loadsAllData())return HS(e);{const n=t._queryIdentifier;return e.views.get(n)}}function WS(e,t){return null!=$S(e,t)}function KS(e){return null!=HS(e)}function HS(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let GS=1;class QS{constructor(e){this.listenProvider_=e,this.syncPointTree_=new HE(null),this.pendingWriteTree_={visibleWrites:GE.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function YS(e,t,n,r,i){return function(e,t,n,r,i){xe(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=QE(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?sT(e,new ME({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function JS(e,t,n,r){!function(e,t,n,r){xe(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=YE(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);const i=HE.fromObject(n);return sT(e,new FE({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}function XS(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(oS(e.pendingWriteTree_,t)){let t=new HE(null);return null!=r.snap?t=t.set(gI(),!0):Ub(r.children,(e=>{t=t.set(new mI(e),!0)})),sT(e,new OE(r.path,t,n))}return[]}function ZS(e,t,n){return sT(e,new ME({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function eT(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=t._path,o=e.syncPointTree_.get(s);let a=[];if(o&&("default"===t._queryIdentifier||WS(o,t))){const l=zS(o,t,n,r);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(s));const u=l.removed;if(a=l.events,!i){const n=-1!==u.findIndex((e=>e._queryParams.loadsAllData())),i=e.syncPointTree_.findOnPath(s,((e,t)=>KS(t)));if(n&&!i){const t=e.syncPointTree_.subtree(s);if(!t.isEmpty()){const n=function(e){return e.fold(((e,t,n)=>{if(t&&KS(t)){return[HS(t)]}{let e=[];return t&&(e=jS(t)),Ub(n,((t,n)=>{e=e.concat(n)})),e}}))}(t);for(let t=0;t<n.length;++t){const r=n[t],i=r.query,s=lT(e,r);e.listenProvider_.startListening(pT(i),uT(e,i),s.hashFn,s.onComplete)}}}if(!i&&u.length>0&&!r)if(n){const n=null;e.listenProvider_.stopListening(pT(t),n)}else u.forEach((t=>{const n=e.queryToTagMap.get(cT(t));e.listenProvider_.stopListening(pT(t),n)}))}!function(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const t=cT(r),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,u)}return a}function tT(e,t,n,r){const i=hT(e,r);if(null!=i){const r=dT(i),s=r.path,o=r.queryId,a=TI(s,t);return fT(e,s,new ME(DE(o),a,n))}return[]}function nT(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=t._path;let s=null,o=!1;e.syncPointTree_.foreachOnPath(i,((e,t)=>{const n=TI(e,i);s=s||BS(t,n),o=o||KS(t)}));let a,l=e.syncPointTree_.get(i);if(l?(o=o||KS(l),s=s||BS(l,gI())):(l=new FS,e.syncPointTree_=e.syncPointTree_.set(i,l)),null!=s)a=!0;else{a=!1,s=oE.EMPTY_NODE;e.syncPointTree_.subtree(i).foreachChild(((e,t)=>{const n=BS(t,gI());n&&(s=s.updateImmediateChild(e,n))}))}const u=WS(l,t);if(!u&&!t._queryParams.loadsAllData()){const n=cT(t);xe(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const r=GS++;e.queryToTagMap.set(n,r),e.tagToQueryMap.set(r,n)}let c=qS(l,t,n,sS(e.pendingWriteTree_,i),s,a);if(!u&&!o&&!r){const n=$S(l,t);c=c.concat(function(e,t,n){const r=t._path,i=uT(e,t),s=lT(e,n),o=e.listenProvider_.startListening(pT(t),i,s.hashFn,s.onComplete),a=e.syncPointTree_.subtree(r);if(i)xe(!KS(a.value),"If we're adding a query, it shouldn't be shadowed");else{const t=a.fold(((e,t,n)=>{if(!SI(e)&&t&&KS(t))return[HS(t).query];{let e=[];return t&&(e=e.concat(jS(t).map((e=>e.query)))),Ub(n,((t,n)=>{e=e.concat(n)})),e}}));for(let n=0;n<t.length;++n){const r=t[n];e.listenProvider_.stopListening(pT(r),uT(e,r))}}return o}(e,t,n))}return c}function rT(e,t,n){const r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,((e,n)=>{const r=BS(n,TI(e,t));if(r)return r}));return cS(r,t,i,n,!0)}function iT(e,t){const n=t._path;let r=null;e.syncPointTree_.foreachOnPath(n,((e,t)=>{const i=TI(e,n);r=r||BS(t,i)}));let i=e.syncPointTree_.get(n);i?r=r||BS(i,gI()):(i=new FS,e.syncPointTree_=e.syncPointTree_.set(n,i));const s=null!=r,o=s?new UE(r,!0,!1):null;return function(e){return $E(e.viewCache_)}(VS(i,t,sS(e.pendingWriteTree_,t._path),s?o.getNode():oE.EMPTY_NODE,s))}function sT(e,t){return oT(t,e.syncPointTree_,null,sS(e.pendingWriteTree_,gI()))}function oT(e,t,n,r){if(SI(e.path))return aT(e,t,n,r);{const i=t.get(gI());null==n&&null!=i&&(n=BS(i,gI()));let s=[];const o=yI(e.path),a=e.operationForChild(o),l=t.children.get(o);if(l&&a){const e=n?n.getImmediateChild(o):null,t=yS(r,o);s=s.concat(oT(a,l,e,t))}return i&&(s=s.concat(US(i,e,r,n))),s}}function aT(e,t,n,r){const i=t.get(gI());null==n&&null!=i&&(n=BS(i,gI()));let s=[];return t.children.inorderTraversal(((t,i)=>{const o=n?n.getImmediateChild(t):null,a=yS(r,t),l=e.operationForChild(t);l&&(s=s.concat(aT(l,i,o,a)))})),i&&(s=s.concat(US(i,e,r,n))),s}function lT(e,t){const n=t.query,r=uT(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||oE.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return r?function(e,t,n){const r=hT(e,n);if(r){const n=dT(r),i=n.path,s=n.queryId,o=TI(i,t);return fT(e,i,new LE(DE(s),o))}return[]}(e,n._path,r):function(e,t){return sT(e,new LE({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const r=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return eT(e,n,null,r)}}}}function uT(e,t){const n=cT(t);return e.queryToTagMap.get(n)}function cT(e){return e._path.toString()+"$"+e._queryIdentifier}function hT(e,t){return e.tagToQueryMap.get(t)}function dT(e){const t=e.indexOf("$");return xe(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new mI(e.substr(0,t))}}function fT(e,t,n){const r=e.syncPointTree_.get(t);xe(r,"Missing sync point for query tag that we're tracking");return US(r,n,sS(e.pendingWriteTree_,t),null)}function pT(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(xe(MS,"Reference.ts has not been loaded"),MS)(e._repo,e._path):e}class mT{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new mT(t)}node(){return this.node_}}class gT{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=EI(this.path_,e);return new gT(this.syncTree_,t)}node(){return rT(this.syncTree_,this.path_)}}const yT=function(e,t,n){return e&&"object"===typeof e?(xe(".sv"in e,"Unexpected leaf node or priority contents"),"string"===typeof e[".sv"]?vT(e[".sv"],t,n):"object"===typeof e[".sv"]?_T(e[".sv"],t):void xe(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},vT=function(e,t,n){if("timestamp"===e)return n.timestamp;xe(!1,"Unexpected server value: "+e)},_T=function(e,t,n){e.hasOwnProperty("increment")||xe(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!==typeof r&&xe(!1,"Unexpected increment value: "+r);const i=t.node();if(xe(null!==i&&"undefined"!==typeof i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const s=i.getValue();return"number"!==typeof s?r:s+r},wT=function(e,t,n,r){return IT(t,new gT(n,e),r)},bT=function(e,t,n){return IT(e,new mT(t),n)};function IT(e,t,n){const r=e.getPriority().val(),i=yT(r,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const r=e,s=yT(r.getValue(),t,n);return s!==r.getValue()||i!==r.getPriority().val()?new JI(s,lE(i)):e}{const r=e;return s=r,i!==r.getPriority().val()&&(s=s.updatePriority(new JI(i))),r.forEachChild(XI,((e,r)=>{const i=IT(r,t.getImmediateChild(e),n);i!==r&&(s=s.updateImmediateChild(e,i))})),s}}class ET{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};this.name=e,this.parent=t,this.node=n}}function ST(e,t){let n=t instanceof mI?t:new mI(t),r=e,i=yI(n);for(;null!==i;){const e=st(r.node.children,i)||{children:{},childCount:0};r=new ET(i,r,e),n=_I(n),i=yI(n)}return r}function TT(e){return e.node.value}function CT(e,t){e.node.value=t,AT(e)}function kT(e){return e.node.childCount>0}function xT(e,t){Ub(e.node.children,((n,r)=>{t(new ET(n,e,r))}))}function NT(e,t,n,r){n&&!r&&t(e),xT(e,(e=>{NT(e,t,!0,r)})),n&&r&&t(e)}function PT(e){return new mI(null===e.parent?e.name:PT(e.parent)+"/"+e.name)}function AT(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===TT(e)&&!kT(e)}(n),i=it(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,AT(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,AT(e))}(e.parent,e.name,e)}const RT=/[\[\].#$\/\u0000-\u001F\u007F]/,DT=/[\[\].#$\u0000-\u001F\u007F]/,OT=10485760,LT=function(e){return"string"===typeof e&&0!==e.length&&!RT.test(e)},MT=function(e){return"string"===typeof e&&0!==e.length&&!DT.test(e)},FT=function(e){return null===e||"string"===typeof e||"number"===typeof e&&!Pb(e)||e&&"object"===typeof e&&it(e,".sv")},UT=function(e,t,n,r){r&&void 0===t||VT(vt(e,"value"),t,n)},VT=function(e,t,n){const r=n instanceof mI?new NI(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+AI(r));if("function"===typeof t)throw new Error(e+"contains a function "+AI(r)+" with contents = "+t.toString());if(Pb(t))throw new Error(e+"contains "+t.toString()+" "+AI(r));if("string"===typeof t&&t.length>OT/3&&bt(t)>OT)throw new Error(e+"contains a string greater than "+OT+" utf8 bytes "+AI(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"===typeof t){let n=!1,i=!1;if(Ub(t,((t,s)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!LT(t)))throw new Error(e+" contains an invalid key ("+t+") "+AI(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=bt(t),PI(e)}(r,t),VT(e,s,r),function(e){const t=e.parts_.pop();e.byteLength_-=bt(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),n&&i)throw new Error(e+' contains ".value" child '+AI(r)+" in addition to actual children.")}},qT=function(e,t,n,r){if(r&&void 0===t)return;const i=vt(e,"values");if(!t||"object"!==typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");const s=[];Ub(t,((e,t)=>{const r=new mI(e);if(VT(i,t,EI(n,r)),".priority"===wI(r)&&!FT(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(r)})),function(e,t){let n,r;for(n=0;n<t.length;n++){r=t[n];const i=bI(r);for(let t=0;t<i.length;t++)if(".priority"===i[t]&&t===i.length-1);else if(!LT(i[t]))throw new Error(e+"contains an invalid key ("+i[t]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(CI);let i=null;for(n=0;n<t.length;n++){if(r=t[n],null!==i&&xI(i,r))throw new Error(e+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,s)},zT=function(e,t,n){if(!n||void 0!==t){if(Pb(t))throw new Error(vt(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!FT(t))throw new Error(vt(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},jT=function(e,t,n,r){if((!r||void 0!==n)&&!LT(n))throw new Error(vt(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},BT=function(e,t,n,r){if((!r||void 0!==n)&&!MT(n))throw new Error(vt(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},$T=function(e,t){if(".info"===yI(t))throw new Error(e+" failed = Can't modify data under /.info/")},WT=function(e,t){const n=t.path.toString();if("string"!==typeof t.repoInfo.host||0===t.repoInfo.host.length||!LT(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),MT(e)}(n))throw new Error(vt(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class KT{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function HT(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],s=i.getPath();null===n||kI(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(i)}n&&e.eventLists_.push(n)}function GT(e,t,n){HT(e,n),YT(e,(e=>kI(e,t)))}function QT(e,t,n){HT(e,n),YT(e,(e=>xI(e,t)||xI(t,e)))}function YT(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];if(i){t(i.path)?(JT(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function JT(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();Ib&&Tb("event: "+n.toString()),jb(r)}}}const XT="repo_interrupt";class ZT{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new KT,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=CE(),this.transactionQueueTree_=new ET,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function eC(e,t,n){if(e.stats_=rI(e.repoInfo_),e.forceRestClient_||("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new SE(e.repoInfo_,((t,n,r,i)=>{rC(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>iC(e,!0)),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{nt(n)}catch(cx){throw new Error("Invalid authOverride provided: "+cx)}}e.persistentConnection_=new OI(e.repoInfo_,t,((t,n,r,i)=>{rC(e,t,n,r,i)}),(t=>{iC(e,t)}),(t=>{!function(e,t){Ub(t,((t,n)=>{sC(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){const n=e.toString();return nI[n]||(nI[n]=t()),nI[n]}(e.repoInfo_,(()=>new AE(e.stats_,e.server_))),e.infoData_=new TE,e.infoSyncTree_=new QS({startListening:(t,n,r,i)=>{let s=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=ZS(e.infoSyncTree_,t._path,o),setTimeout((()=>{i("ok")}),0)),s},stopListening:()=>{}}),sC(e,"connected",!1),e.serverSyncTree_=new QS({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,((n,r)=>{const s=i(n,r);QT(e.eventQueue_,t._path,s)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function tC(e){const t=e.infoData_.getNode(new mI(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function nC(e){return(t=(t={timestamp:tC(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function rC(e,t,n,r,i){e.dataUpdateCount++;const s=new mI(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(i)if(r){const t=at(n,(e=>lE(e)));o=function(e,t,n,r){const i=hT(e,r);if(i){const r=dT(i),s=r.path,o=r.queryId,a=TI(s,t),l=HE.fromObject(n);return fT(e,s,new FE(DE(o),a,l))}return[]}(e.serverSyncTree_,s,t,i)}else{const t=lE(n);o=tT(e.serverSyncTree_,s,t,i)}else if(r){const t=at(n,(e=>lE(e)));o=function(e,t,n){const r=HE.fromObject(n);return sT(e,new FE({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,s,t)}else{const t=lE(n);o=ZS(e.serverSyncTree_,s,t)}let a=s;o.length>0&&(a=gC(e,s)),QT(e.eventQueue_,a,o)}function iC(e,t){sC(e,"connected",t),!1===t&&function(e){dC(e,"onDisconnectEvents");const t=nC(e),n=CE();NE(e.onDisconnect_,gI(),((r,i)=>{const s=wT(r,i,e.serverSyncTree_,t);kE(n,r,s)}));let r=[];NE(n,gI(),((t,n)=>{r=r.concat(ZS(e.serverSyncTree_,t,n));const i=bC(e,t);gC(e,i)})),e.onDisconnect_=CE(),QT(e.eventQueue_,gI(),r)}(e)}function sC(e,t,n){const r=new mI("/.info/"+t),i=lE(n);e.infoData_.updateSnapshot(r,i);const s=ZS(e.infoSyncTree_,r,i);QT(e.eventQueue_,r,s)}function oC(e){return e.nextWriteId_++}function aC(e,t,n,r,i){dC(e,"set",{path:t.toString(),value:n,priority:r});const s=nC(e),o=lE(n,r),a=rT(e.serverSyncTree_,t),l=bT(o,a,s),u=oC(e),c=YS(e.serverSyncTree_,t,l,u,!0);HT(e.eventQueue_,c),e.server_.put(t.toString(),o.val(!0),((n,r)=>{const s="ok"===n;s||Nb("set at "+t+" failed: "+n);const o=XS(e.serverSyncTree_,u,!s);QT(e.eventQueue_,t,o),fC(e,i,n,r)}));const h=bC(e,t);gC(e,h),QT(e.eventQueue_,h,[])}function lC(e,t,n){e.server_.onDisconnectCancel(t.toString(),((r,i)=>{"ok"===r&&xE(e.onDisconnect_,t),fC(e,n,r,i)}))}function uC(e,t,n,r){const i=lE(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),((n,s)=>{"ok"===n&&kE(e.onDisconnect_,t,i),fC(e,r,n,s)}))}function cC(e,t,n){let r;r=".info"===yI(t._path)?eT(e.infoSyncTree_,t,n):eT(e.serverSyncTree_,t,n),GT(e.eventQueue_,t._path,r)}function hC(e){e.persistentConnection_&&e.persistentConnection_.interrupt(XT)}function dC(e){let t="";e.persistentConnection_&&(t=e.persistentConnection_.id+":");for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];Tb(t,...r)}function fC(e,t,n,r){t&&jb((()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let i=e;r&&(i+=": "+r);const s=new Error(i);s.code=e,t(s)}}))}function pC(e,t,n){return rT(e.serverSyncTree_,t,n)||oE.EMPTY_NODE}function mC(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||wC(e,t),TT(t)){const n=vC(e,t);xe(n.length>0,"Sending zero length transaction queue");n.every((e=>0===e.status))&&function(e,t,n){const r=n.map((e=>e.currentWriteId)),i=pC(e,t,r);let s=i;const o=i.hash();for(let u=0;u<n.length;u++){const e=n[u];xe(0===e.status,"tryToSendTransactionQueue_: items in queue should all be run."),e.status=1,e.retryCount++;const r=TI(t,e.path);s=s.updateChild(r,e.currentOutputSnapshotRaw)}const a=s.val(!0),l=t;e.server_.put(l.toString(),a,(r=>{dC(e,"transaction put response",{path:l.toString(),status:r});let i=[];if("ok"===r){const r=[];for(let t=0;t<n.length;t++)n[t].status=2,i=i.concat(XS(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();wC(e,ST(e.transactionQueueTree_,t)),mC(e,e.transactionQueueTree_),QT(e.eventQueue_,t,i);for(let e=0;e<r.length;e++)jb(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{Nb("transaction at "+l.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}gC(e,t)}}),o)}(e,PT(t),n)}else kT(t)&&xT(t,(t=>{mC(e,t)}))}function gC(e,t){const n=yC(e,t),r=PT(n);return function(e,t,n){if(0===t.length)return;const r=[];let i=[];const s=t.filter((e=>0===e.status)),o=s.map((e=>e.currentWriteId));for(let l=0;l<t.length;l++){const s=t[l],u=TI(n,s.path);let c,h=!1;if(xe(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===s.status)h=!0,c=s.abortReason,i=i.concat(XS(e.serverSyncTree_,s.currentWriteId,!0));else if(0===s.status)if(s.retryCount>=25)h=!0,c="maxretry",i=i.concat(XS(e.serverSyncTree_,s.currentWriteId,!0));else{const n=pC(e,s.path,o);s.currentInputSnapshot=n;const r=t[l].update(n.val());if(void 0!==r){VT("transaction failed: Data returned ",r,s.path);let t=lE(r);"object"===typeof r&&null!=r&&it(r,".priority")||(t=t.updatePriority(n.getPriority()));const a=s.currentWriteId,l=nC(e),u=bT(t,n,l);s.currentOutputSnapshotRaw=t,s.currentOutputSnapshotResolved=u,s.currentWriteId=oC(e),o.splice(o.indexOf(a),1),i=i.concat(YS(e.serverSyncTree_,s.path,u,s.currentWriteId,s.applyLocally)),i=i.concat(XS(e.serverSyncTree_,a,!0))}else h=!0,c="nodata",i=i.concat(XS(e.serverSyncTree_,s.currentWriteId,!0))}QT(e.eventQueue_,n,i),i=[],h&&(t[l].status=2,a=t[l].unwatcher,setTimeout(a,Math.floor(0)),t[l].onComplete&&("nodata"===c?r.push((()=>t[l].onComplete(null,!1,t[l].currentInputSnapshot))):r.push((()=>t[l].onComplete(new Error(c),!1,null)))))}var a;wC(e,e.transactionQueueTree_);for(let l=0;l<r.length;l++)jb(r[l]);mC(e,e.transactionQueueTree_)}(e,vC(e,n),r),r}function yC(e,t){let n,r=e.transactionQueueTree_;for(n=yI(t);null!==n&&void 0===TT(r);)r=ST(r,n),n=yI(t=_I(t));return r}function vC(e,t){const n=[];return _C(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function _C(e,t,n){const r=TT(t);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);xT(t,(t=>{_C(e,t,n)}))}function wC(e,t){const n=TT(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,CT(t,n.length>0?n:void 0)}xT(t,(t=>{wC(e,t)}))}function bC(e,t){const n=PT(yC(e,t)),r=ST(e.transactionQueueTree_,t);return function(e,t,n){let r=n?e:e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,(t=>{IC(e,t)})),IC(e,r),NT(r,(t=>{IC(e,t)})),n}function IC(e,t){const n=TT(t);if(n){const r=[];let i=[],s=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(xe(s===t-1,"All SENT items should be at beginning of queue."),s=t,n[t].status=3,n[t].abortReason="set"):(xe(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),i=i.concat(XS(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===s?CT(t,void 0):n.length=s+1,QT(e.eventQueue_,PT(t),i);for(let e=0;e<r.length;e++)jb(r[e])}}const EC=function(e,t){const n=SC(e),r=n.namespace;"firebase.com"===n.domain&&xb(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||xb("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Nb("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Xb(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new mI(n.pathString)}},SC=function(e){let t="",n="",r="",i="",s="",o=!0,a="https",l=443;if("string"===typeof e){let u=e.indexOf("//");u>=0&&(a=e.substring(0,u-1),e=e.substring(u+2));let c=e.indexOf("/");-1===c&&(c=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(c,h)),c<h&&(i=function(e){let t="";const n=e.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let e=n[r];try{e=decodeURIComponent(e.replace(/\+/g," "))}catch(cx){}t+="/"+e}return t}(e.substring(c,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Nb(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,h)));u=t.indexOf(":"),u>=0?(o="https"===a||"wss"===a,l=parseInt(t.substring(u+1),10)):u=t.length;const f=t.slice(0,u);if("localhost"===f.toLowerCase())n="localhost";else if(f.split(".").length<=2)n=f;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=r}"ns"in d&&(s=d.ns)}return{host:t,port:l,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}},TC="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",CC=function(){let e=0;const t=[];return function(n){const r=n===e;let i;e=n;const s=new Array(8);for(i=7;i>=0;i--)s[i]=TC.charAt(n%64),n=Math.floor(n/64);xe(0===n,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&63===t[i];i--)t[i]=0;t[i]++}else for(i=0;i<12;i++)t[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)o+=TC.charAt(t[i]);return xe(20===o.length,"nextPushId: Length should be 20."),o}}();class kC{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+nt(this.snapshot.exportVal())}}class xC{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class NC{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return xe(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class PC{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new qe;return lC(this._repo,this._path,e.wrapCallback((()=>{}))),e.promise}remove(){$T("OnDisconnect.remove",this._path);const e=new qe;return uC(this._repo,this._path,null,e.wrapCallback((()=>{}))),e.promise}set(e){$T("OnDisconnect.set",this._path),UT("OnDisconnect.set",e,this._path,!1);const t=new qe;return uC(this._repo,this._path,e,t.wrapCallback((()=>{}))),t.promise}setWithPriority(e,t){$T("OnDisconnect.setWithPriority",this._path),UT("OnDisconnect.setWithPriority",e,this._path,!1),zT("OnDisconnect.setWithPriority",t,!1);const n=new qe;return function(e,t,n,r,i){const s=lE(n,r);e.server_.onDisconnectPut(t.toString(),s.val(!0),((n,r)=>{"ok"===n&&kE(e.onDisconnect_,t,s),fC(0,i,n,r)}))}(this._repo,this._path,e,t,n.wrapCallback((()=>{}))),n.promise}update(e){$T("OnDisconnect.update",this._path),qT("OnDisconnect.update",e,this._path,!1);const t=new qe;return function(e,t,n,r){if(ot(n))return Tb("onDisconnect().update() called with empty data.  Don't do anything."),void fC(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,((i,s)=>{"ok"===i&&Ub(n,((n,r)=>{const i=lE(r);kE(e.onDisconnect_,EI(t,n),i)})),fC(0,r,i,s)}))}(this._repo,this._path,e,t.wrapCallback((()=>{}))),t.promise}}class AC{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return SI(this._path)?null:wI(this._path)}get ref(){return new LC(this._repo,this._path)}get _queryIdentifier(){const e=EE(this._queryParams),t=Mb(e);return"{}"===t?"default":t}get _queryObject(){return EE(this._queryParams)}isEqual(e){if(!((e=It(e))instanceof AC))return!1;const t=this._repo===e._repo,n=kI(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}function RC(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function DC(e){let t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===VI){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==Ab)throw new Error(r);if("string"!==typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==Rb)throw new Error(r);if("string"!==typeof n)throw new Error(i)}}else if(e.getIndex()===XI){if(null!=t&&!FT(t)||null!=n&&!FT(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(xe(e.getIndex()instanceof uE||e.getIndex()===cE,"unknown index type."),null!=t&&"object"===typeof t||null!=n&&"object"===typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function OC(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class LC extends AC{constructor(e,t){super(e,t,new vE,!1)}get parent(){const e=II(this._path);return null===e?null:new LC(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class MC{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new mI(e),n=VC(this.ref,e);return new MC(this._node.getChild(t),n,XI)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,((t,n)=>e(new MC(n,VC(this.ref,t),XI))))}hasChild(e){const t=new mI(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function FC(e,t){return(e=It(e))._checkNotDeleted("ref"),void 0!==t?VC(e._root,t):e._root}function UC(e,t){(e=It(e))._checkNotDeleted("refFromURL");const n=EC(t,e._repo.repoInfo_.nodeAdmin);WT("refFromURL",n);const r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||xb("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),FC(e,n.path.toString())}function VC(e,t){var n,r,i,s;return null===yI((e=It(e))._path)?(n="child",r="path",s=!1,(i=t)&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),BT(n,r,i,s)):BT("child","path",t,!1),new LC(e._repo,EI(e._path,t))}function qC(e,t){e=It(e),$T("set",e._path),UT("set",t,e._path,!1);const n=new qe;return aC(e._repo,e._path,t,null,n.wrapCallback((()=>{}))),n.promise}function zC(e,t){qT("update",t,e._path,!1);const n=new qe;return function(e,t,n,r){dC(e,"update",{path:t.toString(),value:n});let i=!0;const s=nC(e),o={};if(Ub(n,((n,r)=>{i=!1,o[n]=wT(EI(t,n),lE(r),e.serverSyncTree_,s)})),i)Tb("update() called with empty data.  Don't do anything."),fC(0,r,"ok",void 0);else{const i=oC(e),s=JS(e.serverSyncTree_,t,o,i);HT(e.eventQueue_,s),e.server_.merge(t.toString(),n,((n,s)=>{const o="ok"===n;o||Nb("update at "+t+" failed: "+n);const a=XS(e.serverSyncTree_,i,!o),l=a.length>0?gC(e,t):t;QT(e.eventQueue_,l,a),fC(0,r,n,s)})),Ub(n,(n=>{const r=bC(e,EI(t,n));gC(e,r)})),QT(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((()=>{}))),n.promise}function jC(e){e=It(e);const t=new NC((()=>{})),n=new BC(t);return function(e,t,n){const r=iT(e.serverSyncTree_,t);return null!=r?Promise.resolve(r):e.server_.get(t).then((r=>{const i=lE(r).withIndex(t._queryParams.getIndex());let s;if(nT(e.serverSyncTree_,t,n,!0),t._queryParams.loadsAllData())s=ZS(e.serverSyncTree_,t._path,i);else{const n=uT(e.serverSyncTree_,t);s=tT(e.serverSyncTree_,t._path,i,n)}return QT(e.eventQueue_,t._path,s),eT(e.serverSyncTree_,t,n,null,!0),i}),(n=>(dC(e,"get for query "+nt(t)+" failed: "+n),Promise.reject(new Error(n)))))}(e._repo,e,n).then((t=>new MC(t,new LC(e._repo,e._path),e._queryParams.getIndex())))}class BC{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new kC("value",this,new MC(e.snapshotNode,new LC(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new xC(this,e,t):null}matches(e){return e instanceof BC&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class $C{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new xC(this,e,t):null}createEvent(e,t){xe(null!=e.childName,"Child events should have a childName.");const n=VC(new LC(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new kC(e.type,this,new MC(e.snapshotNode,n,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof $C&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))}hasAnyCallback(){return!!this.callbackContext}}function WC(e,t,n,r,i){let s;if("object"===typeof r&&(s=void 0,i=r),"function"===typeof r&&(s=r),i&&i.onlyOnce){const t=n,r=(n,r)=>{cC(e._repo,e,a),t(n,r)};r.userCallback=n.userCallback,r.context=n.context,n=r}const o=new NC(n,s||void 0),a="value"===t?new BC(o):new $C(t,o);return function(e,t,n){let r;r=".info"===yI(t._path)?nT(e.infoSyncTree_,t,n):nT(e.serverSyncTree_,t,n),GT(e.eventQueue_,t._path,r)}(e._repo,e,a),()=>cC(e._repo,e,a)}function KC(e,t,n,r){return WC(e,"value",t,n,r)}function HC(e,t,n,r){return WC(e,"child_added",t,n,r)}function GC(e,t,n,r){return WC(e,"child_changed",t,n,r)}function QC(e,t,n,r){return WC(e,"child_moved",t,n,r)}function YC(e,t,n,r){return WC(e,"child_removed",t,n,r)}function JC(e,t,n){let r=null;const i=n?new NC(n):null;"value"===t?r=new BC(i):t&&(r=new $C(t,i)),cC(e._repo,e,r)}class XC{}class ZC extends XC{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){UT("endAt",this._value,e._path,!0);const t=wE(e._queryParams,this._value,this._key);if(OC(t),DC(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new AC(e._repo,e._path,t,e._orderByCalled)}}class ek extends XC{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){UT("endBefore",this._value,e._path,!1);const t=function(e,t,n){let r;return r=e.index_===VI||n?wE(e,t,n):wE(e,t,Ab),r.endBeforeSet_=!0,r}(e._queryParams,this._value,this._key);if(OC(t),DC(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new AC(e._repo,e._path,t,e._orderByCalled)}}class tk extends XC{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){UT("startAt",this._value,e._path,!0);const t=_E(e._queryParams,this._value,this._key);if(OC(t),DC(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new AC(e._repo,e._path,t,e._orderByCalled)}}class nk extends XC{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){UT("startAfter",this._value,e._path,!1);const t=function(e,t,n){let r;return r=e.index_===VI||n?_E(e,t,n):_E(e,t,Rb),r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(OC(t),DC(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new AC(e._repo,e._path,t,e._orderByCalled)}}class rk extends XC{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new AC(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="l",n}(e._queryParams,this._limit),e._orderByCalled)}}class ik extends XC{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new AC(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="r",n}(e._queryParams,this._limit),e._orderByCalled)}}class sk extends XC{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){RC(e,"orderByChild");const t=new mI(this._path);if(SI(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const n=new uE(t),r=bE(e._queryParams,n);return DC(r),new AC(e._repo,e._path,r,!0)}}class ok extends XC{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){RC(e,"orderByKey");const t=bE(e._queryParams,VI);return DC(t),new AC(e._repo,e._path,t,!0)}}class ak extends XC{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){RC(e,"orderByPriority");const t=bE(e._queryParams,XI);return DC(t),new AC(e._repo,e._path,t,!0)}}class lk extends XC{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){RC(e,"orderByValue");const t=bE(e._queryParams,cE);return DC(t),new AC(e._repo,e._path,t,!0)}}class uk extends XC{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(UT("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new ZC(this._value,this._key)._apply(new tk(this._value,this._key)._apply(e))}}function ck(e){let t=It(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(const s of r)t=s._apply(t);return t}!function(e){xe(!LS,"__referenceConstructor has already been defined"),LS=e}(LC),function(e){xe(!MS,"__referenceConstructor has already been defined"),MS=e}(LC);const hk={};let dk=!1;function fk(e,t,n,r,i){let s=r||e.options.databaseURL;void 0===s&&(e.options.projectId||xb("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Tb("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o,a,l=EC(s,i),u=l.repoInfo;"undefined"!==typeof process&&(a={NODE_ENV:"production",PUBLIC_URL:"/opensecurityroom",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.FIREBASE_DATABASE_EMULATOR_HOST),a?(o=!0,s=`http://${a}?ns=${u.namespace}`,l=EC(s,i),u=l.repoInfo):o=!l.repoInfo.secure;const c=i&&o?new Kb(Kb.OWNER):new Wb(e.name,e.options,t);WT("Invalid Firebase Database URL",l),SI(l.path)||xb("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(e,t,n,r){let i=hk[t.name];i||(i={},hk[t.name]=i);let s=i[e.toURLString()];s&&xb("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return s=new ZT(e,dk,n,r),i[e.toURLString()]=s,s}(u,e,c,new $b(e.name,n));return new pk(h,e)}class pk{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(eC(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new LC(this._repo,gI())),this._rootInternal}_delete(){return null!==this._rootInternal&&(!function(e,t){const n=hk[t];n&&n[e.key]===e||xb(`Database ${t}(${e.repoInfo_}) has already been deleted.`),hC(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&xb("Cannot call "+e+" on a deleted database.")}}function mk(){cI.IS_TRANSPORT_INITIALIZED&&Nb("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function gk(){mk(),oI.forceDisallow()}function yk(){mk(),uI.forceDisallow(),oI.forceAllow()}function vk(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(e=It(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&xb("Cannot call useEmulator() after instance has already been initialized.");const i=e._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&xb('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Kb(Kb.OWNER);else if(r.mockUserToken){const t="string"===typeof r.mockUserToken?r.mockUserToken:ze(r.mockUserToken,e.app.options.projectId);s=new Kb(t)}!function(e,t,n,r){e.repoInfo_=new Xb(`${t}:${n}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),r&&(e.authTokenProvider_=r)}(i,t,n,s)}function _k(e){var t;(e=It(e))._checkNotDeleted("goOnline"),(t=e._repo).persistentConnection_&&t.persistentConnection_.resume(XT)}function wk(e,t){Sb(e,t)}const bk={".sv":"timestamp"};class Ik{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function Ek(e,t,n){var r;if(e=It(e),$T("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";const i=null===(r=null===n||void 0===n?void 0:n.applyLocally)||void 0===r||r,s=new qe,o=KC(e,(()=>{}));return function(e,t,n,r,i,s){dC(e,"transaction on "+t);const o={path:t,update:n,onComplete:r,status:null,order:_b(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=pC(e,t,void 0);o.currentInputSnapshot=a;const l=o.update(a.val());if(void 0===l)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{VT("transaction failed: Data returned ",l,o.path),o.status=0;const n=ST(e.transactionQueueTree_,t),r=TT(n)||[];let i;r.push(o),CT(n,r),"object"===typeof l&&null!==l&&it(l,".priority")?(i=st(l,".priority"),xe(FT(i),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):i=(rT(e.serverSyncTree_,t)||oE.EMPTY_NODE).getPriority().val();const s=nC(e),u=lE(l,i),c=bT(u,a,s);o.currentOutputSnapshotRaw=u,o.currentOutputSnapshotResolved=c,o.currentWriteId=oC(e);const h=YS(e.serverSyncTree_,t,c,o.currentWriteId,o.applyLocally);QT(e.eventQueue_,t,h),mC(e,e.transactionQueueTree_)}}(e._repo,e._path,t,((t,n,r)=>{let i=null;t?s.reject(t):(i=new MC(r,new LC(e._repo,e._path),XI),s.resolve(new Ik(n,i)))}),o,i),s.promise}OI.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},OI.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};!function(e){db(Bn),On(new Et("database",((e,t)=>{let{instanceIdentifier:n}=t;return fk(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)}),"PUBLIC").setMultipleInstances(!0)),Qn(ub,cb,e),Qn(ub,cb,"esm2017")}();const Sk=new Dt("@firebase/database-compat"),Tk=function(e){const t="FIREBASE WARNING: "+e;Sk.warn(t)};class Ck{constructor(e){this._delegate=e}cancel(e){yt("OnDisconnect.cancel",0,1,arguments.length),_t("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then((()=>e(null)),(t=>e(t))),t}remove(e){yt("OnDisconnect.remove",0,1,arguments.length),_t("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then((()=>e(null)),(t=>e(t))),t}set(e,t){yt("OnDisconnect.set",1,2,arguments.length),_t("OnDisconnect.set","onComplete",t,!0);const n=this._delegate.set(e);return t&&n.then((()=>t(null)),(e=>t(e))),n}setWithPriority(e,t,n){yt("OnDisconnect.setWithPriority",2,3,arguments.length),_t("OnDisconnect.setWithPriority","onComplete",n,!0);const r=this._delegate.setWithPriority(e,t);return n&&r.then((()=>n(null)),(e=>n(e))),r}update(e,t){if(yt("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const t={};for(let n=0;n<e.length;++n)t[""+n]=e[n];e=t,Tk("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}_t("OnDisconnect.update","onComplete",t,!0);const n=this._delegate.update(e);return t&&n.then((()=>t(null)),(e=>t(e))),n}}class kk{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return yt("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class xk{constructor(e,t){this._database=e,this._delegate=t}val(){return yt("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return yt("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return yt("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return yt("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return yt("DataSnapshot.child",0,1,arguments.length),e=String(e),BT("DataSnapshot.child","path",e,!1),new xk(this._database,this._delegate.child(e))}hasChild(e){return yt("DataSnapshot.hasChild",1,1,arguments.length),BT("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return yt("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return yt("DataSnapshot.forEach",1,1,arguments.length),_t("DataSnapshot.forEach","action",e,!1),this._delegate.forEach((t=>e(new xk(this._database,t))))}hasChildren(){return yt("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return yt("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return yt("DataSnapshot.ref",0,0,arguments.length),new Pk(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Nk{constructor(e,t){this.database=e,this._delegate=t}on(e,t,n,r){var i;yt("Query.on",2,4,arguments.length),_t("Query.on","callback",t,!1);const s=Nk.getCancelAndContextArgs_("Query.on",n,r),o=(e,n)=>{t.call(s.context,new xk(this.database,e),n)};o.userCallback=t,o.context=s.context;const a=null===(i=s.cancel)||void 0===i?void 0:i.bind(s.context);switch(e){case"value":return KC(this._delegate,o,a),t;case"child_added":return HC(this._delegate,o,a),t;case"child_removed":return YC(this._delegate,o,a),t;case"child_changed":return GC(this._delegate,o,a),t;case"child_moved":return QC(this._delegate,o,a),t;default:throw new Error(vt("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,n){if(yt("Query.off",0,3,arguments.length),function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(vt(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}("Query.off",e,!0),_t("Query.off","callback",t,!0),wt("Query.off","context",n,!0),t){const r=()=>{};r.userCallback=t,r.context=n,JC(this._delegate,e,r)}else JC(this._delegate,e)}get(){return jC(this._delegate).then((e=>new xk(this.database,e)))}once(e,t,n,r){yt("Query.once",1,4,arguments.length),_t("Query.once","callback",t,!0);const i=Nk.getCancelAndContextArgs_("Query.once",n,r),s=new qe,o=(e,n)=>{const r=new xk(this.database,e);t&&t.call(i.context,r,n),s.resolve(r)};o.userCallback=t,o.context=i.context;const a=e=>{i.cancel&&i.cancel.call(i.context,e),s.reject(e)};switch(e){case"value":KC(this._delegate,o,a,{onlyOnce:!0});break;case"child_added":HC(this._delegate,o,a,{onlyOnce:!0});break;case"child_removed":YC(this._delegate,o,a,{onlyOnce:!0});break;case"child_changed":GC(this._delegate,o,a,{onlyOnce:!0});break;case"child_moved":QC(this._delegate,o,a,{onlyOnce:!0});break;default:throw new Error(vt("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return s.promise}limitToFirst(e){return yt("Query.limitToFirst",1,1,arguments.length),new Nk(this.database,ck(this._delegate,function(e){if("number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new rk(e)}(e)))}limitToLast(e){return yt("Query.limitToLast",1,1,arguments.length),new Nk(this.database,ck(this._delegate,function(e){if("number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new ik(e)}(e)))}orderByChild(e){return yt("Query.orderByChild",1,1,arguments.length),new Nk(this.database,ck(this._delegate,function(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return BT("orderByChild","path",e,!1),new sk(e)}(e)))}orderByKey(){return yt("Query.orderByKey",0,0,arguments.length),new Nk(this.database,ck(this._delegate,new ok))}orderByPriority(){return yt("Query.orderByPriority",0,0,arguments.length),new Nk(this.database,ck(this._delegate,new ak))}orderByValue(){return yt("Query.orderByValue",0,0,arguments.length),new Nk(this.database,ck(this._delegate,new lk))}startAt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return yt("Query.startAt",0,2,arguments.length),new Nk(this.database,ck(this._delegate,function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return jT("startAt","key",t,!0),new tk(e,t)}(e,t)))}startAfter(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return yt("Query.startAfter",0,2,arguments.length),new Nk(this.database,ck(this._delegate,function(e,t){return jT("startAfter","key",t,!0),new nk(e,t)}(e,t)))}endAt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return yt("Query.endAt",0,2,arguments.length),new Nk(this.database,ck(this._delegate,function(e,t){return jT("endAt","key",t,!0),new ZC(e,t)}(e,t)))}endBefore(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return yt("Query.endBefore",0,2,arguments.length),new Nk(this.database,ck(this._delegate,function(e,t){return jT("endBefore","key",t,!0),new ek(e,t)}(e,t)))}equalTo(e,t){return yt("Query.equalTo",1,2,arguments.length),new Nk(this.database,ck(this._delegate,function(e,t){return jT("equalTo","key",t,!0),new uk(e,t)}(e,t)))}toString(){return yt("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return yt("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(yt("Query.isEqual",1,1,arguments.length),!(e instanceof Nk)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,n){const r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,_t(e,"cancel",r.cancel,!0),r.context=n,wt(e,"context",r.context,!0);else if(t)if("object"===typeof t&&null!==t)r.context=t;else{if("function"!==typeof t)throw new Error(vt(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r}get ref(){return new Pk(this.database,new LC(this._delegate._repo,this._delegate._path))}}class Pk extends Nk{constructor(e,t){super(e,new AC(t._repo,t._path,new vE,!1)),this.database=e,this._delegate=t}getKey(){return yt("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return yt("Reference.child",1,1,arguments.length),"number"===typeof e&&(e=String(e)),new Pk(this.database,VC(this._delegate,e))}getParent(){yt("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new Pk(this.database,e):null}getRoot(){return yt("Reference.root",0,0,arguments.length),new Pk(this.database,this._delegate.root)}set(e,t){yt("Reference.set",1,2,arguments.length),_t("Reference.set","onComplete",t,!0);const n=qC(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}update(e,t){if(yt("Reference.update",1,2,arguments.length),Array.isArray(e)){const t={};for(let n=0;n<e.length;++n)t[""+n]=e[n];e=t,Tk("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}$T("Reference.update",this._delegate._path),_t("Reference.update","onComplete",t,!0);const n=zC(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}setWithPriority(e,t,n){yt("Reference.setWithPriority",2,3,arguments.length),_t("Reference.setWithPriority","onComplete",n,!0);const r=function(e,t,n){if($T("setWithPriority",e._path),UT("setWithPriority",t,e._path,!1),zT("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";const r=new qe;return aC(e._repo,e._path,t,n,r.wrapCallback((()=>{}))),r.promise}(this._delegate,e,t);return n&&r.then((()=>n(null)),(e=>n(e))),r}remove(e){yt("Reference.remove",0,1,arguments.length),_t("Reference.remove","onComplete",e,!0);const t=function(e){return $T("remove",e._path),qC(e,null)}(this._delegate);return e&&t.then((()=>e(null)),(t=>e(t))),t}transaction(e,t,n){yt("Reference.transaction",1,3,arguments.length),_t("Reference.transaction","transactionUpdate",e,!1),_t("Reference.transaction","onComplete",t,!0),function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!==typeof n)throw new Error(vt(e,t)+"must be a boolean.")}("Reference.transaction","applyLocally",n,!0);const r=Ek(this._delegate,e,{applyLocally:n}).then((e=>new kk(e.committed,new xk(this.database,e.snapshot))));return t&&r.then((e=>t(null,e.committed,e.snapshot)),(e=>t(e,!1,null))),r}setPriority(e,t){yt("Reference.setPriority",1,2,arguments.length),_t("Reference.setPriority","onComplete",t,!0);const n=function(e,t){e=It(e),$T("setPriority",e._path),zT("setPriority",t,!1);const n=new qe;return aC(e._repo,EI(e._path,".priority"),t,null,n.wrapCallback((()=>{}))),n.promise}(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}push(e,t){yt("Reference.push",0,2,arguments.length),_t("Reference.push","onComplete",t,!0);const n=function(e,t){e=It(e),$T("push",e._path),UT("push",t,e._path,!0);const n=tC(e._repo),r=CC(n),i=VC(e,r),s=VC(e,r);let o;return o=null!=t?qC(s,t).then((()=>s)):Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}(this._delegate,e),r=n.then((e=>new Pk(this.database,e)));t&&r.then((()=>t(null)),(e=>t(e)));const i=new Pk(this.database,n);return i.then=r.then.bind(r),i.catch=r.catch.bind(r,void 0),i}onDisconnect(){return $T("Reference.onDisconnect",this._delegate._path),new Ck(new PC(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class Ak{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:gk,forceLongPolling:yk}}useEmulator(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};vk(this._delegate,e,t,n)}ref(e){if(yt("database.ref",0,1,arguments.length),e instanceof Pk){const t=UC(this._delegate,e.toString());return new Pk(this,t)}{const t=FC(this._delegate,e);return new Pk(this,t)}}refFromURL(e){yt("database.refFromURL",1,1,arguments.length);const t=UC(this._delegate,e);return new Pk(this,t)}goOffline(){return yt("database.goOffline",0,0,arguments.length),function(e){(e=It(e))._checkNotDeleted("goOffline"),hC(e._repo)}(this._delegate)}goOnline(){return yt("database.goOnline",0,0,arguments.length),_k(this._delegate)}}Ak.ServerValue={TIMESTAMP:bk,increment:e=>function(e){return{".sv":{increment:e}}}(e)};var Rk=Object.freeze({__proto__:null,initStandalone:function(e){let{app:t,url:n,version:r,customAuthImpl:i,customAppCheckImpl:s,namespace:o,nodeAdmin:a=!1}=e;db(r);const l=new Ct("database-standalone"),u=new Tt("auth-internal",l);let c;return u.setComponent(new Et("auth-internal",(()=>i),"PRIVATE")),s&&(c=new Tt("app-check-internal",l),c.setComponent(new Et("app-check-internal",(()=>s),"PRIVATE"))),{instance:new Ak(fk(t,u,c,n,a),t),namespace:o}}});const Dk=Ak.ServerValue;!function(e){e.INTERNAL.registerComponent(new Et("database-compat",((e,t)=>{let{instanceIdentifier:n}=t;const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new Ak(i,r)}),"PUBLIC").setServiceProps({Reference:Pk,Query:Nk,Database:Ak,DataSnapshot:xk,enableLogging:wk,INTERNAL:Rk,ServerValue:Dk}).setMultipleInstances(!0)),e.registerVersion("@firebase/database-compat","1.0.8")}(dr);dr.initializeApp({apiKey:"AIzaSyCtmAj7m8Lg4oyOazOBfKSE4e8C82-uEes",authDomain:"opensecurityroom.firebaseapp.com",databaseURL:"https://opensecurityroom-default-rtdb.firebaseio.com",projectId:"opensecurityroom",storageBucket:"opensecurityroom.appspot.com",messagingSenderId:"100768688093",appId:"1:100768688093:web:39e42da6d5e35258acb834"});dr.firestore();const Ok=dr.auth(),Lk=dr.database();var Mk=n(579);const Fk=()=>{const[e,t]=(0,s.useState)(""),[n,r]=(0,s.useState)(null),[i,o]=(0,s.useState)([]),a=re();(0,s.useEffect)((()=>{const e=Ok.onAuthStateChanged((e=>{if(e){r(e.email);Lk.ref("rooms").orderByChild("creator").equalTo(e.uid).on("value",(e=>{const t=e.val();if(t){const e=Object.entries(t).map((e=>{let[t,n]=e;return{id:t,...n}}));o(e)}else o([])}))}else a("/")}));return()=>e()}),[a]);return(0,Mk.jsxs)("div",{children:[(0,Mk.jsxs)("h2",{children:["Bem-vindo, ",n]}),(0,Mk.jsx)("button",{onClick:()=>{Ok.signOut().then((()=>{a("/")})).catch((e=>{console.error("Erro ao deslogar:",e.message)}))},children:"Logout"}),(0,Mk.jsx)("h1",{children:"Criar uma Sala"}),(0,Mk.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"Nome da Sala"}),(0,Mk.jsx)("button",{onClick:()=>{const t=Ok.currentUser;if(t){const n=Lk.ref("rooms").push({name:e,createdAt:(new Date).toISOString(),creator:t.uid});a(`/room/${n.key}`,{state:{roomName:e}})}else console.error("Usu\xe1rio n\xe3o autenticado!")},children:"Criar Sala"}),(0,Mk.jsx)("h2",{children:"Suas Salas Criadas:"}),(0,Mk.jsx)("ul",{children:i.map((e=>(0,Mk.jsxs)("li",{children:[(0,Mk.jsx)("span",{children:e.name}),(0,Mk.jsx)("button",{onClick:()=>a(`/room/${e.id}`,{state:{roomName:e.name}}),children:"Entrar"}),(0,Mk.jsx)("button",{onClick:()=>{return t=e.id,void Lk.ref(`rooms/${t}`).remove().then((()=>{console.log("Sala exclu\xedda com sucesso.")})).catch((e=>{console.error("Erro ao excluir a sala:",e)}));var t},children:"Excluir"})]},e.id)))})]})};var Uk,Vk=Object.defineProperty,qk=Object.getOwnPropertySymbols,zk=Object.prototype.hasOwnProperty,jk=Object.prototype.propertyIsEnumerable,Bk=(e,t,n)=>t in e?Vk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,$k=(e,t)=>{for(var n in t||(t={}))zk.call(t,n)&&Bk(e,n,t[n]);if(qk)for(var n of qk(t))jk.call(t,n)&&Bk(e,n,t[n]);return e},Wk=(e,t)=>{var n={};for(var r in e)zk.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&qk)for(var r of qk(e))t.indexOf(r)<0&&jk.call(e,r)&&(n[r]=e[r]);return n};(e=>{const t=class t{constructor(e,n,r,s){if(this.version=e,this.errorCorrectionLevel=n,this.modules=[],this.isFunction=[],e<t.MIN_VERSION||e>t.MAX_VERSION)throw new RangeError("Version value out of range");if(s<-1||s>7)throw new RangeError("Mask value out of range");this.size=4*e+17;let o=[];for(let t=0;t<this.size;t++)o.push(!1);for(let t=0;t<this.size;t++)this.modules.push(o.slice()),this.isFunction.push(o.slice());this.drawFunctionPatterns();const a=this.addEccAndInterleave(r);if(this.drawCodewords(a),-1==s){let e=1e9;for(let t=0;t<8;t++){this.applyMask(t),this.drawFormatBits(t);const n=this.getPenaltyScore();n<e&&(s=t,e=n),this.applyMask(t)}}i(0<=s&&s<=7),this.mask=s,this.applyMask(s),this.drawFormatBits(s),this.isFunction=[]}static encodeText(n,r){const i=e.QrSegment.makeSegments(n);return t.encodeSegments(i,r)}static encodeBinary(n,r){const i=e.QrSegment.makeBytes(n);return t.encodeSegments([i],r)}static encodeSegments(e,r){let s,a,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:40,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,h=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(!(t.MIN_VERSION<=l&&l<=u&&u<=t.MAX_VERSION)||c<-1||c>7)throw new RangeError("Invalid value");for(s=l;;s++){const n=8*t.getNumDataCodewords(s,r),i=o.getTotalBits(e,s);if(i<=n){a=i;break}if(s>=u)throw new RangeError("Data too long")}for(const n of[t.Ecc.MEDIUM,t.Ecc.QUARTILE,t.Ecc.HIGH])h&&a<=8*t.getNumDataCodewords(s,n)&&(r=n);let d=[];for(const t of e){n(t.mode.modeBits,4,d),n(t.numChars,t.mode.numCharCountBits(s),d);for(const e of t.getData())d.push(e)}i(d.length==a);const f=8*t.getNumDataCodewords(s,r);i(d.length<=f),n(0,Math.min(4,f-d.length),d),n(0,(8-d.length%8)%8,d),i(d.length%8==0);for(let t=236;d.length<f;t^=253)n(t,8,d);let p=[];for(;8*p.length<d.length;)p.push(0);return d.forEach(((e,t)=>p[t>>>3]|=e<<7-(7&t))),new t(s,r,p,c)}getModule(e,t){return 0<=e&&e<this.size&&0<=t&&t<this.size&&this.modules[t][e]}getModules(){return this.modules}drawFunctionPatterns(){for(let n=0;n<this.size;n++)this.setFunctionModule(6,n,n%2==0),this.setFunctionModule(n,6,n%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const e=this.getAlignmentPatternPositions(),t=e.length;for(let n=0;n<t;n++)for(let r=0;r<t;r++)0==n&&0==r||0==n&&r==t-1||n==t-1&&0==r||this.drawAlignmentPattern(e[n],e[r]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){const t=this.errorCorrectionLevel.formatBits<<3|e;let n=t;for(let r=0;r<10;r++)n=n<<1^1335*(n>>>9);const s=21522^(t<<10|n);i(s>>>15==0);for(let i=0;i<=5;i++)this.setFunctionModule(8,i,r(s,i));this.setFunctionModule(8,7,r(s,6)),this.setFunctionModule(8,8,r(s,7)),this.setFunctionModule(7,8,r(s,8));for(let i=9;i<15;i++)this.setFunctionModule(14-i,8,r(s,i));for(let i=0;i<8;i++)this.setFunctionModule(this.size-1-i,8,r(s,i));for(let i=8;i<15;i++)this.setFunctionModule(8,this.size-15+i,r(s,i));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let n=0;n<12;n++)e=e<<1^7973*(e>>>11);const t=this.version<<12|e;i(t>>>18==0);for(let n=0;n<18;n++){const e=r(t,n),i=this.size-11+n%3,s=Math.floor(n/3);this.setFunctionModule(i,s,e),this.setFunctionModule(s,i,e)}}drawFinderPattern(e,t){for(let n=-4;n<=4;n++)for(let r=-4;r<=4;r++){const i=Math.max(Math.abs(r),Math.abs(n)),s=e+r,o=t+n;0<=s&&s<this.size&&0<=o&&o<this.size&&this.setFunctionModule(s,o,2!=i&&4!=i)}}drawAlignmentPattern(e,t){for(let n=-2;n<=2;n++)for(let r=-2;r<=2;r++)this.setFunctionModule(e+r,t+n,1!=Math.max(Math.abs(r),Math.abs(n)))}setFunctionModule(e,t,n){this.modules[t][e]=n,this.isFunction[t][e]=!0}addEccAndInterleave(e){const n=this.version,r=this.errorCorrectionLevel;if(e.length!=t.getNumDataCodewords(n,r))throw new RangeError("Invalid argument");const s=t.NUM_ERROR_CORRECTION_BLOCKS[r.ordinal][n],o=t.ECC_CODEWORDS_PER_BLOCK[r.ordinal][n],a=Math.floor(t.getNumRawDataModules(n)/8),l=s-a%s,u=Math.floor(a/s);let c=[];const h=t.reedSolomonComputeDivisor(o);for(let i=0,f=0;i<s;i++){let n=e.slice(f,f+u-o+(i<l?0:1));f+=n.length;const r=t.reedSolomonComputeRemainder(n,h);i<l&&n.push(0),c.push(n.concat(r))}let d=[];for(let t=0;t<c[0].length;t++)c.forEach(((e,n)=>{(t!=u-o||n>=l)&&d.push(e[t])}));return i(d.length==a),d}drawCodewords(e){if(e.length!=Math.floor(t.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let n=0;for(let t=this.size-1;t>=1;t-=2){6==t&&(t=5);for(let i=0;i<this.size;i++)for(let s=0;s<2;s++){const o=t-s,a=0==(t+1&2)?this.size-1-i:i;!this.isFunction[a][o]&&n<8*e.length&&(this.modules[a][o]=r(e[n>>>3],7-(7&n)),n++)}}i(n==8*e.length)}applyMask(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(let t=0;t<this.size;t++)for(let n=0;n<this.size;n++){let r;switch(e){case 0:r=(n+t)%2==0;break;case 1:r=t%2==0;break;case 2:r=n%3==0;break;case 3:r=(n+t)%3==0;break;case 4:r=(Math.floor(n/3)+Math.floor(t/2))%2==0;break;case 5:r=n*t%2+n*t%3==0;break;case 6:r=(n*t%2+n*t%3)%2==0;break;case 7:r=((n+t)%2+n*t%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[t][n]&&r&&(this.modules[t][n]=!this.modules[t][n])}}getPenaltyScore(){let e=0;for(let i=0;i<this.size;i++){let n=!1,r=0,s=[0,0,0,0,0,0,0];for(let o=0;o<this.size;o++)this.modules[i][o]==n?(r++,5==r?e+=t.PENALTY_N1:r>5&&e++):(this.finderPenaltyAddHistory(r,s),n||(e+=this.finderPenaltyCountPatterns(s)*t.PENALTY_N3),n=this.modules[i][o],r=1);e+=this.finderPenaltyTerminateAndCount(n,r,s)*t.PENALTY_N3}for(let i=0;i<this.size;i++){let n=!1,r=0,s=[0,0,0,0,0,0,0];for(let o=0;o<this.size;o++)this.modules[o][i]==n?(r++,5==r?e+=t.PENALTY_N1:r>5&&e++):(this.finderPenaltyAddHistory(r,s),n||(e+=this.finderPenaltyCountPatterns(s)*t.PENALTY_N3),n=this.modules[o][i],r=1);e+=this.finderPenaltyTerminateAndCount(n,r,s)*t.PENALTY_N3}for(let i=0;i<this.size-1;i++)for(let n=0;n<this.size-1;n++){const r=this.modules[i][n];r==this.modules[i][n+1]&&r==this.modules[i+1][n]&&r==this.modules[i+1][n+1]&&(e+=t.PENALTY_N2)}let n=0;for(const t of this.modules)n=t.reduce(((e,t)=>e+(t?1:0)),n);const r=this.size*this.size,s=Math.ceil(Math.abs(20*n-10*r)/r)-1;return i(0<=s&&s<=9),e+=s*t.PENALTY_N4,i(0<=e&&e<=2568888),e}getAlignmentPatternPositions(){if(1==this.version)return[];{const e=Math.floor(this.version/7)+2,t=32==this.version?26:2*Math.ceil((4*this.version+4)/(2*e-2));let n=[6];for(let r=this.size-7;n.length<e;r-=t)n.splice(1,0,r);return n}}static getNumRawDataModules(e){if(e<t.MIN_VERSION||e>t.MAX_VERSION)throw new RangeError("Version number out of range");let n=(16*e+128)*e+64;if(e>=2){const t=Math.floor(e/7)+2;n-=(25*t-10)*t-55,e>=7&&(n-=36)}return i(208<=n&&n<=29648),n}static getNumDataCodewords(e,n){return Math.floor(t.getNumRawDataModules(e)/8)-t.ECC_CODEWORDS_PER_BLOCK[n.ordinal][e]*t.NUM_ERROR_CORRECTION_BLOCKS[n.ordinal][e]}static reedSolomonComputeDivisor(e){if(e<1||e>255)throw new RangeError("Degree out of range");let n=[];for(let t=0;t<e-1;t++)n.push(0);n.push(1);let r=1;for(let i=0;i<e;i++){for(let e=0;e<n.length;e++)n[e]=t.reedSolomonMultiply(n[e],r),e+1<n.length&&(n[e]^=n[e+1]);r=t.reedSolomonMultiply(r,2)}return n}static reedSolomonComputeRemainder(e,n){let r=n.map((e=>0));for(const i of e){const e=i^r.shift();r.push(0),n.forEach(((n,i)=>r[i]^=t.reedSolomonMultiply(n,e)))}return r}static reedSolomonMultiply(e,t){if(e>>>8!=0||t>>>8!=0)throw new RangeError("Byte out of range");let n=0;for(let r=7;r>=0;r--)n=n<<1^285*(n>>>7),n^=(t>>>r&1)*e;return i(n>>>8==0),n}finderPenaltyCountPatterns(e){const t=e[1];i(t<=3*this.size);const n=t>0&&e[2]==t&&e[3]==3*t&&e[4]==t&&e[5]==t;return(n&&e[0]>=4*t&&e[6]>=t?1:0)+(n&&e[6]>=4*t&&e[0]>=t?1:0)}finderPenaltyTerminateAndCount(e,t,n){return e&&(this.finderPenaltyAddHistory(t,n),t=0),t+=this.size,this.finderPenaltyAddHistory(t,n),this.finderPenaltyCountPatterns(n)}finderPenaltyAddHistory(e,t){0==t[0]&&(e+=this.size),t.pop(),t.unshift(e)}};t.MIN_VERSION=1,t.MAX_VERSION=40,t.PENALTY_N1=3,t.PENALTY_N2=3,t.PENALTY_N3=40,t.PENALTY_N4=10,t.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],t.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]];function n(e,t,n){if(t<0||t>31||e>>>t!=0)throw new RangeError("Value out of range");for(let r=t-1;r>=0;r--)n.push(e>>>r&1)}function r(e,t){return 0!=(e>>>t&1)}function i(e){if(!e)throw new Error("Assertion error")}e.QrCode=t;const s=class e{constructor(e,t,n){if(this.mode=e,this.numChars=t,this.bitData=n,t<0)throw new RangeError("Invalid argument");this.bitData=n.slice()}static makeBytes(t){let r=[];for(const e of t)n(e,8,r);return new e(e.Mode.BYTE,t.length,r)}static makeNumeric(t){if(!e.isNumeric(t))throw new RangeError("String contains non-numeric characters");let r=[];for(let e=0;e<t.length;){const i=Math.min(t.length-e,3);n(parseInt(t.substring(e,e+i),10),3*i+1,r),e+=i}return new e(e.Mode.NUMERIC,t.length,r)}static makeAlphanumeric(t){if(!e.isAlphanumeric(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");let r,i=[];for(r=0;r+2<=t.length;r+=2){let s=45*e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(r));s+=e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(r+1)),n(s,11,i)}return r<t.length&&n(e.ALPHANUMERIC_CHARSET.indexOf(t.charAt(r)),6,i),new e(e.Mode.ALPHANUMERIC,t.length,i)}static makeSegments(t){return""==t?[]:e.isNumeric(t)?[e.makeNumeric(t)]:e.isAlphanumeric(t)?[e.makeAlphanumeric(t)]:[e.makeBytes(e.toUtf8ByteArray(t))]}static makeEci(t){let r=[];if(t<0)throw new RangeError("ECI assignment value out of range");if(t<128)n(t,8,r);else if(t<16384)n(2,2,r),n(t,14,r);else{if(!(t<1e6))throw new RangeError("ECI assignment value out of range");n(6,3,r),n(t,21,r)}return new e(e.Mode.ECI,0,r)}static isNumeric(t){return e.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return e.ALPHANUMERIC_REGEX.test(t)}getData(){return this.bitData.slice()}static getTotalBits(e,t){let n=0;for(const r of e){const e=r.mode.numCharCountBits(t);if(r.numChars>=1<<e)return 1/0;n+=4+e+r.bitData.length}return n}static toUtf8ByteArray(e){e=encodeURI(e);let t=[];for(let n=0;n<e.length;n++)"%"!=e.charAt(n)?t.push(e.charCodeAt(n)):(t.push(parseInt(e.substring(n+1,n+3),16)),n+=2);return t}};s.NUMERIC_REGEX=/^[0-9]*$/,s.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,s.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let o=s;e.QrSegment=s})(Uk||(Uk={})),(e=>{let t;(e=>{const t=class{constructor(e,t){this.ordinal=e,this.formatBits=t}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2);e.Ecc=t})(t=e.QrCode||(e.QrCode={}))})(Uk||(Uk={})),(e=>{let t;(e=>{const t=class{constructor(e,t){this.modeBits=e,this.numBitsCharCount=t}numCharCountBits(e){return this.numBitsCharCount[Math.floor((e+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]);e.Mode=t})(t=e.QrSegment||(e.QrSegment={}))})(Uk||(Uk={}));var Kk=Uk,Hk={L:Kk.QrCode.Ecc.LOW,M:Kk.QrCode.Ecc.MEDIUM,Q:Kk.QrCode.Ecc.QUARTILE,H:Kk.QrCode.Ecc.HIGH},Gk=128,Qk="L",Yk="#FFFFFF",Jk="#000000",Xk=!1,Zk=1;function ex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=[];return e.forEach((function(e,r){let i=null;e.forEach((function(s,o){if(!s&&null!==i)return n.push(`M${i+t} ${r+t}h${o-i}v1H${i+t}z`),void(i=null);if(o!==e.length-1)s&&null===i&&(i=o);else{if(!s)return;null===i?n.push(`M${o+t},${r+t} h1v1H${o+t}z`):n.push(`M${i+t},${r+t} h${o+1-i}v1H${i+t}z`)}}))})),n.join("")}function tx(e,t){return e.slice().map(((e,n)=>n<t.y||n>=t.y+t.h?e:e.map(((e,n)=>(n<t.x||n>=t.x+t.w)&&e))))}function nx(e){let{value:t,level:n,minVersion:r,includeMargin:i,marginSize:o,imageSettings:a,size:l}=e,u=s.useMemo((()=>{const e=Kk.QrSegment.makeSegments(t);return Kk.QrCode.encodeSegments(e,Hk[n],r)}),[t,n,r]);const{cells:c,margin:h,numCells:d,calculatedImageSettings:f}=s.useMemo((()=>{let e=u.getModules();const t=function(e,t){return null!=t?Math.max(Math.floor(t),0):e?4:0}(i,o),n=e.length+2*t,r=function(e,t,n,r){if(null==r)return null;const i=e.length+2*n,s=Math.floor(.1*t),o=i/t,a=(r.width||s)*o,l=(r.height||s)*o,u=null==r.x?e.length/2-a/2:r.x*o,c=null==r.y?e.length/2-l/2:r.y*o,h=null==r.opacity?1:r.opacity;let d=null;if(r.excavate){let e=Math.floor(u),t=Math.floor(c);d={x:e,y:t,w:Math.ceil(a+u-e),h:Math.ceil(l+c-t)}}return{x:u,y:c,h:l,w:a,excavation:d,opacity:h,crossOrigin:r.crossOrigin}}(e,l,t,a);return{cells:e,margin:t,numCells:n,calculatedImageSettings:r}}),[u,l,a,i,o]);return{qrcode:u,margin:h,cells:c,numCells:d,calculatedImageSettings:f}}var rx=function(){try{(new Path2D).addPath(new Path2D)}catch(cx){return!1}return!0}(),ix=s.forwardRef((function(e,t){const n=e,{value:r,size:i=Gk,level:o=Qk,bgColor:a=Yk,fgColor:l=Jk,includeMargin:u=Xk,minVersion:c=Zk,marginSize:h,imageSettings:d}=n,f=Wk(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","marginSize","imageSettings"]),{style:p}=f,m=Wk(f,["style"]),g=null==d?void 0:d.src,y=s.useRef(null),v=s.useRef(null),_=s.useCallback((e=>{y.current=e,"function"===typeof t?t(e):t&&(t.current=e)}),[t]),[w,b]=s.useState(!1),{margin:I,cells:E,numCells:S,calculatedImageSettings:T}=nx({value:r,level:o,minVersion:c,includeMargin:u,marginSize:h,imageSettings:d,size:i});s.useEffect((()=>{if(null!=y.current){const e=y.current,t=e.getContext("2d");if(!t)return;let n=E;const r=v.current,s=null!=T&&null!==r&&r.complete&&0!==r.naturalHeight&&0!==r.naturalWidth;s&&null!=T.excavation&&(n=tx(E,T.excavation));const o=window.devicePixelRatio||1;e.height=e.width=i*o;const u=i/S*o;t.scale(u,u),t.fillStyle=a,t.fillRect(0,0,S,S),t.fillStyle=l,rx?t.fill(new Path2D(ex(n,I))):E.forEach((function(e,n){e.forEach((function(e,r){e&&t.fillRect(r+I,n+I,1,1)}))})),T&&(t.globalAlpha=T.opacity),s&&t.drawImage(r,T.x+I,T.y+I,T.w,T.h)}})),s.useEffect((()=>{b(!1)}),[g]);const C=$k({height:i,width:i},p);let k=null;return null!=g&&(k=s.createElement("img",{src:g,key:g,style:{display:"none"},onLoad:()=>{b(!0)},ref:v,crossOrigin:null==T?void 0:T.crossOrigin})),s.createElement(s.Fragment,null,s.createElement("canvas",$k({style:C,height:i,width:i,ref:_,role:"img"},m)),k)}));ix.displayName="QRCodeCanvas",s.forwardRef((function(e,t){const n=e,{value:r,size:i=Gk,level:o=Qk,bgColor:a=Yk,fgColor:l=Jk,includeMargin:u=Xk,minVersion:c=Zk,title:h,marginSize:d,imageSettings:f}=n,p=Wk(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","title","marginSize","imageSettings"]),{margin:m,cells:g,numCells:y,calculatedImageSettings:v}=nx({value:r,level:o,minVersion:c,includeMargin:u,marginSize:d,imageSettings:f,size:i});let _=g,w=null;null!=f&&null!=v&&(null!=v.excavation&&(_=tx(g,v.excavation)),w=s.createElement("image",{href:f.src,height:v.h,width:v.w,x:v.x+m,y:v.y+m,preserveAspectRatio:"none",opacity:v.opacity,crossOrigin:v.crossOrigin}));const b=ex(_,m);return s.createElement("svg",$k({height:i,width:i,viewBox:`0 0 ${y} ${y}`,ref:t,role:"img"},p),!!h&&s.createElement("title",null,h),s.createElement("path",{fill:a,d:`M0,0 h${y}v${y}H0z`,shapeRendering:"crispEdges"}),s.createElement("path",{fill:l,d:b,shapeRendering:"crispEdges"}),w)})).displayName="QRCodeSVG";const sx=()=>{var e;const{roomId:t}=function(){let{matches:e}=s.useContext(X),t=e[e.length-1];return t?t.params:{}}(),n=(null===(e=te().state)||void 0===e?void 0:e.roomName)||"Sala",[r,i]=(0,s.useState)(localStorage.getItem("userName")||""),[o,a]=(0,s.useState)(""),[l,u]=(0,s.useState)([]),[c,h]=(0,s.useState)(!!localStorage.getItem("hasJoined")),[d,f]=(0,s.useState)(!1),p=re(),m=`${window.location.origin}/room/${t}`;(0,s.useEffect)((()=>{const e=Ok.currentUser;if(e){Lk.ref(`rooms/${t}`).once("value",(t=>{t.exists()&&t.val().creator===e.uid&&f(!0)}))}}),[t]),(0,s.useEffect)((()=>{const e=Lk.ref(`rooms/${t}/messages`);return e.on("value",(e=>{const t=e.val();if(t){const e=Object.entries(t).map((e=>{let[t,n]=e;return{id:t,...n}}));u(e)}})),()=>{e.off()}}),[t]);return c?(0,Mk.jsxs)("div",{children:[(0,Mk.jsxs)("h1",{children:[n," - Chat"]}),(0,Mk.jsx)("div",{style:{height:"300px",overflowY:"scroll",border:"1px solid #ccc",marginBottom:"10px"},children:l.map((e=>(0,Mk.jsxs)("div",{style:{padding:"5px",borderBottom:"1px solid #eee"},children:[(0,Mk.jsxs)("strong",{children:[e.user,":"]})," ",e.text]},e.id)))}),(0,Mk.jsx)("input",{type:"text",value:o,onChange:e=>a(e.target.value),placeholder:"Escreva sua mensagem"}),(0,Mk.jsx)("button",{onClick:()=>{if(o.trim()){Lk.ref(`rooms/${t}/messages`).push().set({text:o,user:r,timestamp:(new Date).toISOString()}),a("")}},disabled:!o.trim(),children:"Enviar"}),d?(0,Mk.jsxs)("div",{children:[(0,Mk.jsx)("button",{onClick:()=>{localStorage.removeItem("hasJoined"),p("/create-room")},children:"Sair"}),(0,Mk.jsx)("button",{onClick:()=>{Lk.ref(`rooms/${t}`).remove().then((()=>{console.log("Sala exclu\xedda com sucesso"),localStorage.removeItem("hasJoined"),localStorage.removeItem("userName"),p("/create-room")})).catch((e=>{console.error("Erro ao excluir a sala:",e)}))},children:"Excluir Sala"}),(0,Mk.jsxs)("div",{children:[(0,Mk.jsx)("h3",{children:"Compartilhar link do chat:"}),(0,Mk.jsxs)("p",{children:["Link: ",(0,Mk.jsx)("a",{href:m,children:m})]}),(0,Mk.jsx)(ix,{value:m,size:128})," "]})]}):(0,Mk.jsx)("p",{children:"Bem-vindo(a) ao chat! Apenas o criador pode sair ou excluir a sala."})]}):(0,Mk.jsxs)("div",{children:[(0,Mk.jsx)("h1",{children:n}),(0,Mk.jsx)("p",{children:"Por favor, insira seu nome para entrar no chat:"}),(0,Mk.jsx)("input",{type:"text",value:r,onChange:e=>i(e.target.value),placeholder:"Digite seu nome"}),(0,Mk.jsx)("button",{onClick:()=>{h(!0),localStorage.setItem("hasJoined","true"),localStorage.setItem("userName",r)},disabled:!r.trim(),children:"Entrar no chat"})]})},ox=()=>{const[e,t]=(0,s.useState)(""),[n,r]=(0,s.useState)(""),[i,o]=(0,s.useState)(!0),[a,l]=(0,s.useState)(""),u=re();return(0,Mk.jsxs)("div",{children:[(0,Mk.jsx)("h1",{children:i?"Login":"Registrar"}),(0,Mk.jsx)("input",{type:"email",value:e,onChange:e=>t(e.target.value),placeholder:"Email"}),(0,Mk.jsx)("input",{type:"password",value:n,onChange:e=>r(e.target.value),placeholder:"Senha"}),i?(0,Mk.jsx)("button",{onClick:()=>{l(""),Ok.signInWithEmailAndPassword(e,n).then((e=>{console.log("Usu\xe1rio logado:",e.user),u("/")})).catch((e=>{"auth/wrong-password"===e.code?l("Senha incorreta. Tente novamente."):"auth/user-not-found"===e.code?l("E-mail n\xe3o encontrado. Verifique se o e-mail est\xe1 correto."):l("Erro ao fazer login. Verifique as credenciais e tente novamente.")}))},children:"Login"}):(0,Mk.jsx)("button",{onClick:()=>{l(""),Ok.createUserWithEmailAndPassword(e,n).then((e=>{console.log("Usu\xe1rio registrado:",e.user),u("/")})).catch((e=>{"auth/email-already-in-use"===e.code?l("Esse e-mail j\xe1 est\xe1 em uso. Tente outro."):"auth/invalid-email"===e.code?l("E-mail inv\xe1lido."):l("Erro ao registrar. Verifique as informa\xe7\xf5es e tente novamente.")}))},children:"Registrar"}),(0,Mk.jsxs)("p",{children:[i?"N\xe3o tem uma conta?":"J\xe1 tem uma conta?"," ",(0,Mk.jsx)("span",{onClick:()=>o(!i),children:i?"Registrar":"Login"})]}),a&&(0,Mk.jsx)("p",{style:{color:"red"},children:a})]})},ax=()=>(0,Mk.jsxs)("div",{children:[(0,Mk.jsx)("h1",{children:"P\xe1gina n\xe3o encontrada!"}),(0,Mk.jsx)("p",{children:"A p\xe1gina que voc\xea est\xe1 procurando n\xe3o existe."})]});const lx=function(){const[e,t]=(0,s.useState)(null),[n,r]=(0,s.useState)(!0);return(0,s.useEffect)((()=>{const e=Ok.onAuthStateChanged((e=>{t(e),r(!1)}));return()=>e()}),[]),n?(0,Mk.jsx)("div",{children:"Carregando..."}):(0,Mk.jsxs)(Ie,{basename:"/opensecurityroom",children:["  ",(0,Mk.jsxs)(_e,{children:[(0,Mk.jsx)(ye,{path:"/login",element:(0,Mk.jsx)(ox,{})}),"  ",(0,Mk.jsx)(ye,{path:"/",element:e?(0,Mk.jsx)(Fk,{}):(0,Mk.jsx)(ge,{to:"/login"})}),(0,Mk.jsx)(ye,{path:"/room/:roomId",element:e?(0,Mk.jsx)(sx,{}):(0,Mk.jsx)(ge,{to:"/login"})}),(0,Mk.jsx)(ye,{path:"*",element:(0,Mk.jsx)(ax,{})}),"  "]})]})},ux=document.getElementById("root");a.createRoot(ux).render((0,Mk.jsx)(s.StrictMode,{children:(0,Mk.jsx)(lx,{})}))})();
//# sourceMappingURL=main.c57c2731.js.map